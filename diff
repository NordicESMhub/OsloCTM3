Index: L60T42newFastJX.inp
===================================================================
--- L60T42newFastJX.inp	(.../ctm3f90)	(revision 243)
+++ L60T42newFastJX.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,259 +0,0 @@
- === CTM p-code 5.5 with Oslo chemistry with EC met fields ===
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
- 2005  IYEAR = reference year to which NDAI/NDAYE are offset
-    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
-  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
-    T  LFIXMET = annually recycle met field (do not allow leap year)
-    F  0 1: Clear sky J's
-    F  0 2: Averaged cloud cover
-    F  0 3: cloud-fract**3/2, then average cloud cover
-    F  0 4: Average direct solar beam over all ICA's, invert to get clouds
-    F  1 5: Random select NRANDO ICAs from all(Independent Column Atmos.)
-    F  0 6: Use all (up to 4) quadrature cloud cover QCA's (mid-pts of bin)
-    T  0 7: Use all (up to 4) QCA's (average clouds within each Q-bin)
-    F  0 8: Calcluate J's for ALL ICA's (up to 20,000 per cell!)
-   66  RANSEED
-    8    3    1  NRMETD=#met fields/day, NROPSM=#op split, NRCH=#chem sub-steps
-    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
-    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
-0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-/projects/geo/IFSL60/cy36_                               met field path1
-2000/T42_data/                                           met field path2
-EC001T42                                           met data fname
-  128   64   60  IMX x JMX x LMX = Longit x Latit x Eta-level of metfield grid
-  128   64   60  IM  x JM  x LM  = Longit x Latit x Eta-level of CTM run
-    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
-  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
-    L  LMMAP      eta-A            eta-B
-    1    1      0.000000000000   1.000000000000
-    2    2      0.000000000000   0.997630120000
-    3    3      7.367743000000   0.994019450000
-    4    4     65.889244000000   0.988270100000
-    5    5    210.393890000000   0.979662720000
-    6    6    467.333588000000   0.967645230000
-    7    7    855.361755000000   0.951821510000
-    8    8   1385.912598000000   0.931940320000
-    9    9   2063.779785000000   0.907883880000
-   10   10   2887.696533000000   0.879656910000
-   11   11   3850.913330000000   0.847374920000
-   12   12   4941.778320000000   0.811253430000
-   13   13   6144.314941000000   0.771596610000
-   14   14   7438.803223000000   0.728785810000
-   15   15   8802.356444999999   0.683268610000
-   16   16  10209.500977000000   0.635547460000
-   17   17  11632.758789000000   0.586168410000
-   18   18  13043.218750000000   0.535709920000
-   19   19  14411.124023000000   0.484771580000
-   20   20  15706.447265999999   0.433962940000
-   21   21  16899.468750000000   0.383892150000
-   22   22  17961.357422000001   0.335154890000
-   23   23  18864.750000000000   0.288322960000
-   24   24  19584.330077999999   0.243933140000
-   25   25  20097.402343999998   0.202475940000
-   26   26  20384.480468999998   0.164384320000
-   27   27  20429.863281000002   0.130022510000
-   28   28  20222.205077999999   0.099674690000
-   29   29  19755.109375000000   0.073533830000
-   30   30  19027.695313000000   0.051690410000
-   31   31  18045.183593999998   0.034121160000
-   32   32  16819.474609000001   0.020677880000
-   33   33  15379.805664000000   0.011142910000
-   34   34  13775.325194999999   0.005081120000
-   35   35  12077.446289000000   0.001815160000
-   36   36  10376.126953000001   0.000461390000
-   37   37   8765.053711000000   0.000075820000
-   38   38   7306.631348000000   0.000000000000
-   39   39   6018.019531000000   0.000000000000
-   40   40   4906.708496000000   0.000000000000
-   41   41   3960.291504000000   0.000000000000
-   42   42   3196.421631000000   0.000000000000
-   43   43   2579.888672000000   0.000000000000
-   44   44   2082.273926000000   0.000000000000
-   45   45   1680.640259000000   0.000000000000
-   46   46   1356.474609000000   0.000000000000
-   47   47   1094.834717000000   0.000000000000
-   48   48    883.660522000000   0.000000000000
-   49   49    713.218079000000   0.000000000000
-   50   50    575.651001000000   0.000000000000
-   51   51    464.618134000000   0.000000000000
-   52   52    373.971924000000   0.000000000000
-   53   53    298.495789000000   0.000000000000
-   54   54    234.779053000000   0.000000000000
-   55   55    180.584351000000   0.000000000000
-   56   56    134.483307000000   0.000000000000
-   57   57     95.636963000000   0.000000000000
-   58   58     63.647804000000   0.000000000000
-   59   59     38.425343000000   0.000000000000
-   60   60     20.000000000000   0.000000000000
-   61   61      2.000000000000   0.000000000000
-PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
-    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
-    0  NDPX dry deposition scheme, now only simple version = 0
-    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
--------file names for further data-------------------------------------
-'tables/P_meanT42.dat'          FILE annual mean pressure field, opened in INPUT
-    T  LISLSCP2 = switch for ISLSCP2 data (if true, use ISLSCP2, otherwise ISLSCP1)
-'Indata_CTM3/ISLSCP2/MODIS/modis_landcover_1deg/modis_landcover_1d_cXX.asc'       land frac and type
-'Indata_CTM3/ISLSCP2/FASIR/fasir_rough_1d_1982-1998/fasir_rough413_1d_YYYYMM.asc' roughness Zo
-'Indata_CTM3/ISLSCP2/FASIR/fasir_glai_1d_1982-1998/fasir_glai413_1d_YYYYMM.asc'   LAI
-*** ISLSCP 1 data ***
-'tables/landfr.dat'             FILE land fraction input file, opened in SURFSET
-'tables/LS_islscp88x.dat'       FILE land surface data (Zo, LAI, veg type) 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
---- tracer specific section ---
- T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
---- species information --- read tracer information from the following file
-'tables/chch_oc_nitrate.d'                  Tracer list
---- General multi-species wet scavenging data set:  call WETSET_CTM3
-'tables/scavenging_wet.inp'            WET deposition data set
---- General multi-species dry scavenging data set:  call DRYSET_CTM3
-'tables/scavenging_dry.inp'            DRY deposition data set
---- Emission list ---
-'tables/Ltracer_emis_eclipse_V5_2010_meganMACC.inp'      'edgar4_megan_noch4_2000.inp'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-===== CONT = write restart (Continuation) file (unformatted)
-     123456789.123456789.123456789.1              JDO_C
-JAN _1000000000000000000000000000000  001 - 031
-FEB _00000000000000000000000000000    032 - 060
-MAR _0000000000000000000000000000000  061 - 091
-APR _000000000000000000000000000000   092 - 121
-MAY _0000000000000000000000000000000  122 - 152
-JUN _000000000000000000000000000000   153 - 182
-JUL _0000000000000000000000000000000  183 - 213
-AUG _0000000000000000000000000000000  214 - 244
-SEP _000000000000000000000000000000   245 - 274
-OCT _0000000000000000000000000000000  275 - 305
-NOV _000000000000000000000000000000   306 - 335
-DEC _0000000000000000000000000000000  336 - 366
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-===== BUDGET tendencies calendar (unf + some form output)
-     123456789.123456789.123456789.1              JDO_T
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-    8 # CATEGORIES for tendency budgets
-    1 = SOURCE          titles for tendencies, see pmain.f
-    2 = BNDLYR
-    3 = DRYDEP
-    4 = UV_ADV
-    5 = W_ADV_
-    6 = LSSCAV
-    7 = CHEM_1
-    8 = C_SCAV
-    9 = >SUMS<
-   10 = INST-M
-Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
-1-D tend bdgts:   F TTFTFFFFFF TFTFTFFFTF FFFFFFFFFT TTTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-2-D tend bdgts:   F TTFTFFFFFF TFTFTFFFTF FFFFFFFFFF FFTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
-box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
-box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
-box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
-box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
-box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
-box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
-box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
-box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
-box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
-box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
-box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
-box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
-     123456789.123456789.123456789.1             JDO_A
-JAN _2000000000000000000000000000000  001 - 031
-FEB _20000000000000000000000000000    032 - 060
-MAR _2000000000000000000000000000000  061 - 091
-APR _200000000000000000000000000000   092 - 121
-MAY _2000000000000000000000000000000  122 - 152
-JUN _200000000000000000000000000000   153 - 182
-JUL _2000000000000000000000000000000  183 - 213
-AUG _2000000000000000000000000000000  214 - 244
-SEP _200000000000000000000000000000   245 - 274
-OCT _2000000000000000000000000000000  275 - 305
-NOV _200000000000000000000000000000   306 - 335
-DEC _2000000000000000000000000000000  336 - 366
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-===== STE-flux output                            JDO_X
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
-1-D avg profiles:   TFTFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF TFTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-   30 stations L(N)=TFTFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF TFTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-statn  1  Alert          82.45   -1.20   LAT/LNG
-statn  2  Pt. Barrow     71.32 -156.61
-statn  3  Rorvik         57.00   12.00
-statn  4  Mace Head      53.32   -9.88
-statn  5  Hohenpssnb     47.48   11.01
-statn  6  Payerne        46.82    6.95
-statn  7  Harvard Fo     43.00  -79.00
-statn  8  Niwot Ridg     40.04 -105.58
-statn  9  Azores         38.75   27.08
-statn 10  Wallops Is     37.90  -75.50
-statn 11  Bermuda        32.00  -64.00
-statn 12  Mauna Loa      19.54 -155.58
-statn 13  Cp. Kumaka     19.54 -155.58
-statn 14  Barbados       13.17  -59.43
-statn 15  Natal          -5.92  -35.17
-statn 16  Ascension      -7.98  -14.42
-statn 17  Amazon        -10.00  -50.00
-statn 18  Am. Samoa     -14.23  170.56
-statn 19  Cuiaba        -15.60  -56.10
-statn 20  Cape Grim     -40.41  144.69
-statn 21  Neumayer      -70.00   -8.00
-statn 22  South Pole    -90.00     .00
-statn 23  Taibei         25.03  121.52
-statn 24  Tokyo          35.68  139.77
-statn 25  Guam           13.22  145.33
-statn 26  Shemya         52.92  174.06
-statn 27  Mauna Loa      19.53 -155.58
-statn 28  Anchorage      61.17 -150.02
-statn 29  San Frans      37.62 -122.38
-statn 30  Quito           0.22  -78.53
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-    0 stations for local time diag. LT may be adjusted to fit at least one pnt
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-    0     # of tracer global local time diag. LT may be adjusted
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-=========3-D unf inst.(select AIR & TRACER m/m) from start to K3DMAX, then stops
-K3DMAX      900   F FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Index: L60T42.inp
===================================================================
--- L60T42.inp	(.../ctm3f90)	(revision 243)
+++ L60T42.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,251 +0,0 @@
-=== Oslo CTM3 v2015.01 w/Oslo chemistry and EC met fields ===
---------------------------------------------------------------------------------
- 2005  IYEAR = reference year to which NDAI/NDAYE are offset
-    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
-  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
---------------------------------------------------------------------------------
-    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
-    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
-    T  LCLDRANA = Random selected from all cloud cover ICAs                    
-    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
-   66  RANSEED
-    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
-    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
-    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
-0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
-----Meteorological data: File name will be built from following info------------
-ECMWF_IFS        met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
-   36    1       met data cycle & revision number
-/work/projects/cicero/ctm_input/metdataIFSL60/                    met data root
-    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
-    T  LFIXMET = annually recycle met field (do not allow leap year)           
-    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
-  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
-----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
-    L  LMMAP      eta-A            eta-B
-    1    1      0.000000000000   1.000000000000
-    2    2      0.000000000000   0.997630120000
-    3    3      7.367743000000   0.994019450000
-    4    4     65.889244000000   0.988270100000
-    5    5    210.393890000000   0.979662720000
-    6    6    467.333588000000   0.967645230000
-    7    7    855.361755000000   0.951821510000
-    8    8   1385.912598000000   0.931940320000
-    9    9   2063.779785000000   0.907883880000
-   10   10   2887.696533000000   0.879656910000
-   11   11   3850.913330000000   0.847374920000
-   12   12   4941.778320000000   0.811253430000
-   13   13   6144.314941000000   0.771596610000
-   14   14   7438.803223000000   0.728785810000
-   15   15   8802.356444999999   0.683268610000
-   16   16  10209.500977000000   0.635547460000
-   17   17  11632.758789000000   0.586168410000
-   18   18  13043.218750000000   0.535709920000
-   19   19  14411.124023000000   0.484771580000
-   20   20  15706.447265999999   0.433962940000
-   21   21  16899.468750000000   0.383892150000
-   22   22  17961.357422000001   0.335154890000
-   23   23  18864.750000000000   0.288322960000
-   24   24  19584.330077999999   0.243933140000
-   25   25  20097.402343999998   0.202475940000
-   26   26  20384.480468999998   0.164384320000
-   27   27  20429.863281000002   0.130022510000
-   28   28  20222.205077999999   0.099674690000
-   29   29  19755.109375000000   0.073533830000
-   30   30  19027.695313000000   0.051690410000
-   31   31  18045.183593999998   0.034121160000
-   32   32  16819.474609000001   0.020677880000
-   33   33  15379.805664000000   0.011142910000
-   34   34  13775.325194999999   0.005081120000
-   35   35  12077.446289000000   0.001815160000
-   36   36  10376.126953000001   0.000461390000
-   37   37   8765.053711000000   0.000075820000
-   38   38   7306.631348000000   0.000000000000
-   39   39   6018.019531000000   0.000000000000
-   40   40   4906.708496000000   0.000000000000
-   41   41   3960.291504000000   0.000000000000
-   42   42   3196.421631000000   0.000000000000
-   43   43   2579.888672000000   0.000000000000
-   44   44   2082.273926000000   0.000000000000
-   45   45   1680.640259000000   0.000000000000
-   46   46   1356.474609000000   0.000000000000
-   47   47   1094.834717000000   0.000000000000
-   48   48    883.660522000000   0.000000000000
-   49   49    713.218079000000   0.000000000000
-   50   50    575.651001000000   0.000000000000
-   51   51    464.618134000000   0.000000000000
-   52   52    373.971924000000   0.000000000000
-   53   53    298.495789000000   0.000000000000
-   54   54    234.779053000000   0.000000000000
-   55   55    180.584351000000   0.000000000000
-   56   56    134.483307000000   0.000000000000
-   57   57     95.636963000000   0.000000000000
-   58   58     63.647804000000   0.000000000000
-   59   59     38.425343000000   0.000000000000
-   60   60     20.000000000000   0.000000000000
-   61   61      2.000000000000   0.000000000000
-PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
-    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
-    0  NDPX dry deposition scheme, now only simple version = 0
-    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
-----file names for further data-------------------------------------------------
-'tables/P_meanT42.dat'          FILE annual mean pressure field, opened in INPUT
-    T  LISLSCP2 = switch for ISLSCP2 data (if true, use ISLSCP2, otherwise ISLSCP1)
-'Indata_CTM3/ISLSCP2/MODIS/modis_landcover_1deg/modis_landcover_1d_cXX.asc'       land frac and type
-'Indata_CTM3/ISLSCP2/FASIR/fasir_rough_1d_1982-1998/fasir_rough413_1d_YYYYMM.asc' roughness Zo
-'Indata_CTM3/ISLSCP2/FASIR/fasir_glai_1d_1982-1998/fasir_glai413_1d_YYYYMM.asc'   LAI
-*** ISLSCP 1 data ***
-'tables/landfr.dat'             FILE land fraction input file, opened in SURFSET
-'tables/LS_islscp88x.dat'       FILE land surface data (Zo, LAI, veg type) 
---------------------------------------------------------------------------------
---- tracer specific section ---
- T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
---- species information / tracer list --- read from the following file
-'tables/tracer_list_nitrate.d'
---- General multi-species wet scavenging data set:  call WETSET_CTM3
-'tables/scavenging_wet.inp'            WET deposition data set
---- General multi-species dry scavenging data set:  call DRYSET_CTM3
-'tables/scavenging_dry.inp'            DRY deposition data set
---- Emission list ---
-'tables/Ltracer_emis_eclipse_V5_2010_meganMACC.inp'      'edgar4_megan_noch4_2000.inp'
---------------------------------------------------------------------------------
-===== CONT = write restart (Continuation) file (unformatted)
-     123456789.123456789.123456789.1              JDO_C
-JAN _1000000000000000000000000000000  001 - 031
-FEB _00000000000000000000000000000    032 - 060
-MAR _0000000000000000000000000000000  061 - 091
-APR _000000000000000000000000000000   092 - 121
-MAY _0000000000000000000000000000000  122 - 152
-JUN _000000000000000000000000000000   153 - 182
-JUL _0000000000000000000000000000000  183 - 213
-AUG _0000000000000000000000000000000  214 - 244
-SEP _000000000000000000000000000000   245 - 274
-OCT _0000000000000000000000000000000  275 - 305
-NOV _000000000000000000000000000000   306 - 335
-DEC _0000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== BUDGET tendencies calendar (unf + some form output)
-     123456789.123456789.123456789.1              JDO_T
-JAN _1110000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-    8 # CATEGORIES for tendency budgets
-    1 = SOURCE
-    2 = BNDLYR
-    3 = DRYDEP
-    4 = UV_ADV
-    5 = W_ADV_
-    6 = LSSCAV
-    7 = CHEMIS
-    8 = CNSCAV
-Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
-1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
-box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
-box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
-box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
-box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
-box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
-box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
-box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
-box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
-box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
-box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
-box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
-box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
---------------------------------------------------------------------------------
-===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
-     123456789.123456789.123456789.1             JDO_A
-JAN _2000000000000000000000000000000  001 - 031
-FEB _20000000000000000000000000000    032 - 060
-MAR _2000000000000000000000000000000  061 - 091
-APR _200000000000000000000000000000   092 - 121
-MAY _2000000000000000000000000000000  122 - 152
-JUN _200000000000000000000000000000   153 - 182
-JUL _2000000000000000000000000000000  183 - 213
-AUG _2000000000000000000000000000000  214 - 244
-SEP _200000000000000000000000000000   245 - 274
-OCT _2000000000000000000000000000000  275 - 305
-NOV _200000000000000000000000000000   306 - 335
-DEC _2000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== STE-flux output                            JDO_X
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
-1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
---------------------------------------------------------------------------------
-==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-statn  1  Alert          82.45   -1.20   LAT/LNG
-statn  2  Pt. Barrow     71.32 -156.61
-statn  3  Rorvik         57.00   12.00
-statn  4  Mace Head      53.32   -9.88
-statn  5  Hohenpssnb     47.48   11.01
-statn  6  Payerne        46.82    6.95
-statn  7  Harvard Fo     43.00  -79.00
-statn  8  Niwot Ridg     40.04 -105.58
-statn  9  Azores         38.75   27.08
-statn 10  Wallops Is     37.90  -75.50
-statn 11  Bermuda        32.00  -64.00
-statn 12  Mauna Loa      19.54 -155.58
-statn 13  Cp. Kumaka     19.54 -155.58
-statn 14  Barbados       13.17  -59.43
-statn 15  Natal          -5.92  -35.17
-statn 16  Ascension      -7.98  -14.42
-statn 17  Amazon        -10.00  -50.00
-statn 18  Am. Samoa     -14.23  170.56
-statn 19  Cuiaba        -15.60  -56.10
-statn 20  Cape Grim     -40.41  144.69
-statn 21  Neumayer      -70.00   -8.00
-statn 22  South Pole    -90.00     .00
-statn 23  Taibei         25.03  121.52
-statn 24  Tokyo          35.68  139.77
-statn 25  Guam           13.22  145.33
-statn 26  Shemya         52.92  174.06
-statn 27  Mauna Loa      19.53 -155.58
-statn 28  Anchorage      61.17 -150.02
-statn 29  San Frans      37.62 -122.38
-statn 30  Quito           0.22  -78.53
--------Stations local time diags------------------------------------------------
-    0 stations for local time diag. LT may be adjusted to fit at least one pnt
--------Tracers for local time diags at stations---------------------------------
-    0     # of tracer global local time diag. LT may be adjusted
--------3D unf inst.(select AIR & TRACER m/m) from start to K3DMAX, then stops---
-K3DMAX      900   F FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
---------------------------------------------------------------------------------
Index: L60CTM_bcoc.inp
===================================================================
--- L60CTM_bcoc.inp	(.../ctm3f90)	(revision 243)
+++ L60CTM_bcoc.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,251 +0,0 @@
-=== Oslo CTM3 v2015.01 w/Oslo chemistry and EC met fields ===
---------------------------------------------------------------------------------
- 1995  IYEAR = reference year to which NDAI/NDAYE are offset
-    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
-  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
---------------------------------------------------------------------------------
-    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
-    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
-    T  LCLDRANA = Random selected from all cloud cover ICAs                    
-    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
-   66  RANSEED
-    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
-    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
-    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
-0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
-----Meteorological data---------------------------------------------------------
-ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
-   38    1       met data cycle & revision number
-/work/projects/cicero/ctm_input/metdataOpenIFS/                   met data root
-    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
-    T  LFIXMET = annually recycle met field (do not allow leap year)           
-    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
-  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
-----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
-    L  LMMAP      eta-A            eta-B
-    1    1      0.000000000000   1.000000000000
-    2    2      0.000000000000   0.997630120000
-    3    3      7.367743000000   0.994019450000
-    4    4     65.889244000000   0.988270100000
-    5    5    210.393890000000   0.979662720000
-    6    6    467.333588000000   0.967645230000
-    7    7    855.361755000000   0.951821510000
-    8    8   1385.912598000000   0.931940320000
-    9    9   2063.779785000000   0.907883880000
-   10   10   2887.696533000000   0.879656910000
-   11   11   3850.913330000000   0.847374920000
-   12   12   4941.778320000000   0.811253430000
-   13   13   6144.314941000000   0.771596610000
-   14   14   7438.803223000000   0.728785810000
-   15   15   8802.356444999999   0.683268610000
-   16   16  10209.500977000000   0.635547460000
-   17   17  11632.758789000000   0.586168410000
-   18   18  13043.218750000000   0.535709920000
-   19   19  14411.124023000000   0.484771580000
-   20   20  15706.447265999999   0.433962940000
-   21   21  16899.468750000000   0.383892150000
-   22   22  17961.357422000001   0.335154890000
-   23   23  18864.750000000000   0.288322960000
-   24   24  19584.330077999999   0.243933140000
-   25   25  20097.402343999998   0.202475940000
-   26   26  20384.480468999998   0.164384320000
-   27   27  20429.863281000002   0.130022510000
-   28   28  20222.205077999999   0.099674690000
-   29   29  19755.109375000000   0.073533830000
-   30   30  19027.695313000000   0.051690410000
-   31   31  18045.183593999998   0.034121160000
-   32   32  16819.474609000001   0.020677880000
-   33   33  15379.805664000000   0.011142910000
-   34   34  13775.325194999999   0.005081120000
-   35   35  12077.446289000000   0.001815160000
-   36   36  10376.126953000001   0.000461390000
-   37   37   8765.053711000000   0.000075820000
-   38   38   7306.631348000000   0.000000000000
-   39   39   6018.019531000000   0.000000000000
-   40   40   4906.708496000000   0.000000000000
-   41   41   3960.291504000000   0.000000000000
-   42   42   3196.421631000000   0.000000000000
-   43   43   2579.888672000000   0.000000000000
-   44   44   2082.273926000000   0.000000000000
-   45   45   1680.640259000000   0.000000000000
-   46   46   1356.474609000000   0.000000000000
-   47   47   1094.834717000000   0.000000000000
-   48   48    883.660522000000   0.000000000000
-   49   49    713.218079000000   0.000000000000
-   50   50    575.651001000000   0.000000000000
-   51   51    464.618134000000   0.000000000000
-   52   52    373.971924000000   0.000000000000
-   53   53    298.495789000000   0.000000000000
-   54   54    234.779053000000   0.000000000000
-   55   55    180.584351000000   0.000000000000
-   56   56    134.483307000000   0.000000000000
-   57   57     95.636963000000   0.000000000000
-   58   58     63.647804000000   0.000000000000
-   59   59     38.425343000000   0.000000000000
-   60   60     20.000000000000   0.000000000000
-   61   61      2.000000000000   0.000000000000
-PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
-    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
-    0  NDPX dry deposition scheme, now only simple version = 0
-    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
-----file names for further data-------------------------------------------------
-'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
-    T  LISLSCP2 = switch for ISLSCP2 data (if true, use ISLSCP2, otherwise ISLSCP1)
-'Indata_CTM3/ISLSCP2/MODIS/modis_landcover_1deg/modis_landcover_1d_cXX.asc'       land frac and type
-'Indata_CTM3/ISLSCP2/FASIR/fasir_rough_1d_1982-1998/fasir_rough413_1d_YYYYMM.asc' roughness Zo
-'Indata_CTM3/ISLSCP2/FASIR/fasir_glai_1d_1982-1998/fasir_glai413_1d_YYYYMM.asc'   LAI
-*** ISLSCP 1 data ***
-'tables/landfr.dat'             FILE land fraction input file, opened in SURFSET
-'tables/LS_islscp88x.dat'       FILE land surface data (Zo, LAI, veg type) 
---------------------------------------------------------------------------------
---- tracer specific section ---
- F  0    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
---- species information / tracer list --- read from the following file
-'tables/tracer_list_bcoc.d'
---- General multi-species wet scavenging data set:  call WETSET_CTM3
-'tables/scavenging_wet.inp'            WET deposition data set
---- General multi-species dry scavenging data set:  call DRYSET_CTM3
-'tables/scavenging_dry.inp'            DRY deposition data set
---- Emission list ---
-'tables/Ltracer_emis_eclipse_V5_2010_meganMACC.inp'      'edgar4_megan_noch4_2000.inp'
---------------------------------------------------------------------------------
-===== CONT = write restart (Continuation) file (unformatted)
-     123456789.123456789.123456789.1              JDO_C
-JAN _1000000000000000000000000000000  001 - 031
-FEB _00000000000000000000000000000    032 - 060
-MAR _0000000000000000000000000000000  061 - 091
-APR _000000000000000000000000000000   092 - 121
-MAY _0000000000000000000000000000000  122 - 152
-JUN _000000000000000000000000000000   153 - 182
-JUL _0000000000000000000000000000000  183 - 213
-AUG _0000000000000000000000000000000  214 - 244
-SEP _000000000000000000000000000000   245 - 274
-OCT _0000000000000000000000000000000  275 - 305
-NOV _000000000000000000000000000000   306 - 335
-DEC _0000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== BUDGET tendencies calendar (unf + some form output)
-     123456789.123456789.123456789.1              JDO_T
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-    8 # CATEGORIES for tendency budgets
-    1 = SOURCE
-    2 = BNDLYR
-    3 = DRYDEP
-    4 = UV_ADV
-    5 = W_ADV_
-    6 = LSSCAV
-    7 = CHEMIS
-    8 = CNSCAV
-Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
-1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
-box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
-box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
-box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
-box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
-box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
-box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
-box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
-box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
-box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
-box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
-box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
-box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
---------------------------------------------------------------------------------
-===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
-     123456789.123456789.123456789.1             JDO_A
-JAN _2000000000000000000000000000000  001 - 031
-FEB _20000000000000000000000000000    032 - 060
-MAR _2000000000000000000000000000000  061 - 091
-APR _200000000000000000000000000000   092 - 121
-MAY _2000000000000000000000000000000  122 - 152
-JUN _200000000000000000000000000000   153 - 182
-JUL _2000000000000000000000000000000  183 - 213
-AUG _2000000000000000000000000000000  214 - 244
-SEP _200000000000000000000000000000   245 - 274
-OCT _2000000000000000000000000000000  275 - 305
-NOV _200000000000000000000000000000   306 - 335
-DEC _2000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== STE-flux output                            JDO_X
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
-1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
---------------------------------------------------------------------------------
-==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-statn  1  Alert          82.45   -1.20   LAT/LNG
-statn  2  Pt. Barrow     71.32 -156.61
-statn  3  Rorvik         57.00   12.00
-statn  4  Mace Head      53.32   -9.88
-statn  5  Hohenpssnb     47.48   11.01
-statn  6  Payerne        46.82    6.95
-statn  7  Harvard Fo     43.00  -79.00
-statn  8  Niwot Ridg     40.04 -105.58
-statn  9  Azores         38.75   27.08
-statn 10  Wallops Is     37.90  -75.50
-statn 11  Bermuda        32.00  -64.00
-statn 12  Mauna Loa      19.54 -155.58
-statn 13  Cp. Kumaka     19.54 -155.58
-statn 14  Barbados       13.17  -59.43
-statn 15  Natal          -5.92  -35.17
-statn 16  Ascension      -7.98  -14.42
-statn 17  Amazon        -10.00  -50.00
-statn 18  Am. Samoa     -14.23  170.56
-statn 19  Cuiaba        -15.60  -56.10
-statn 20  Cape Grim     -40.41  144.69
-statn 21  Neumayer      -70.00   -8.00
-statn 22  South Pole    -90.00     .00
-statn 23  Taibei         25.03  121.52
-statn 24  Tokyo          35.68  139.77
-statn 25  Guam           13.22  145.33
-statn 26  Shemya         52.92  174.06
-statn 27  Mauna Loa      19.53 -155.58
-statn 28  Anchorage      61.17 -150.02
-statn 29  San Frans      37.62 -122.38
-statn 30  Quito           0.22  -78.53
--------Stations local time diags------------------------------------------------
-    0 stations for local time diag. LT may be adjusted to fit at least one pnt
--------Tracers for local time diags at stations---------------------------------
-    0     # of tracer global local time diag. LT may be adjusted
--------3D unf inst.(select AIR & TRACER m/m) from start to K3DMAX, then stops---
-K3DMAX      900   F FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
---------------------------------------------------------------------------------
Index: metdata_noresm.f90
===================================================================
--- metdata_noresm.f90	(.../ctm3f90)	(revision 243)
+++ metdata_noresm.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,2149 +0,0 @@
-!//=========================================================================
-!// Oslo CTM3
-!//=========================================================================
-!// Based on UCI CTM core p-7.1 (1/2013).
-!//
-!// Ole Amund Sovde, November 2015
-!//=========================================================================
-!// Routine for reading meteorological data from norESM, from nedCDF files.
-!//=========================================================================
-module metdata_noresm
-  !//-----------------------------------------------------------------------
-  !// MODULE: metdata_noresm
-  !// DESCRIPTION: Routine for reading meteorological data from norESM,
-  !//              stored on nedCDF format.
-  !//
-  !// Contains
-  !//   subroutine update_metdata
-  !//   subroutine fluxfilter2
-  !//   subroutine data2mpblocks
-  !//   subroutine gotData
-  !//   subroutine skipData
-  !//-----------------------------------------------------------------------
-  use cmn_size, only: LPAR
-  !//-----------------------------------------------------------------------
-  implicit none
-  !//-----------------------------------------------------------------------
-  integer :: LMAP(LPAR+1)
-  !// ----------------------------------------------------------------------
-  character(len=*), parameter, private :: f90file = 'metdata_noresm.f90'
-  !//-----------------------------------------------------------------------
-  save
-  private
-  public update_metdata
-  !//-----------------------------------------------------------------------
-
-contains
-
-  !//-----------------------------------------------------------------------
-  subroutine update_metdata(ILOOP, DTMET, NMET)
-    !//---------------------------------------------------------------------
-    !// Read input data. This version reads netCDF4 files, where data for
-    !// each day is divided into three files: one for spectral 
-    !// data, one for 3-d gridpoint data and one for 2-d gridpoint data.
-    !//
-    !// Spectral transformation is done in this routine, and summation of
-    !// physical fields from native to model resolution.
-    !//
-    !// This routine assumes meteorology is to be updated each NMET. E.g.
-    !// ERA-40 had 6-hour fields, and was tweaked to be read every other
-    !// NMET, but with the double time step. This has been removed for now.
-    !//
-    !// Ole Amund Sovde, April 2015
-    !//---------------------------------------------------------------------
-    use cmn_precision, only: r8, r4
-    use cmn_size, only: IPARW, JPARW, LPARW, LWEPARW, &
-         IPAR, JPAR, IDGRD, JDGRD, &
-         LPAR, LWEPAR, LWDPAR, &
-         FFTPTS, NRFFT, NRNM, NMMAX, NTRUNW, LOSLOCHEM, NRMETD, LDUST
-    use cmn_ctm, only: JYEAR, JMON, JDAY, JDATE, GMTAU, &
-         LMMAP, XLMMAP, TMON, TMET, &
-         ALP, ALPV, TRIG, IFAX, LDEG, ZDEGI, ZDEGJ, IMAP, JMAP, &
-         XYZA, XYZB, IMEPZ, DD, SS, ETAAW, ETABW, ETAA, ETAB, &
-         WGLYE, WGLYG, YDGRD, AREAXYW, AREAXY, PLAND
-    use cmn_met, only: P, U, V, T, Q, CWETN, CWETE, CWETD, CENTU, CENTD, &
-         PRECCNV, PRECLS, ZOFLE, &
-          CLDFR, CLDLWC, CLDIWC, &
-         SLH, SHF, SMF, SFT, SFQ, SFU, SFV, BLH, SA, &
-         PVU, UMS, VMS, CI, SD, SMLT, ES, SNFL, PhotActRad, MSLP, USTR, &
-         PMEAN, PMEANW, MYEAR, &
-         metTYPE, MPATH1, MPATH2, MFILE3
-    use cmn_parameters, only: M_AIR, R_UNIV, R_AIR, R_H2O, A0, CPI
-    use cloudjx, only: SWSTORE, CLDSTORE, TYPSTORE, RAN4, IRAN0, &
-                       LCLDAVG, LCLDQMD, LCLDQMN, LCLDRANA, LCLDRANQ
-    use regridding, only: TRUNG4, TRUNG8
-    use utilities, only: ctmExitC, CFRMIN,CIWMIN
-    use ncutils, only: get_netcdf_var_2d, get_netcdf_var_3d, &
-         readnc_3d_from4d, readnc_2d_from3d
-    use dust_oslo, only: dust_set_ssrd, dust_set_strd, dust_set_SWVL1
-    use physics_oslo, only: get_pvu, ijlw2lij
-    !//---------------------------------------------------------------------
-    implicit none
-    !//---------------------------------------------------------------------
-    !// Input
-    integer, intent(in) :: ILOOP, & ! <=0, init, > 0 ordinary run
-                           NMET     ! the meteorological timestep
-    real(r8), intent(in) :: DTMET     ! meteorological time step [s]
-    !//---------------------------------------------------------------------
-    logical, parameter :: VERBOSE = .false.
-    real(r8), parameter :: EPS = 0.01_r8 ! minimum cloud fraction
-    !// Limits for convective fluxes
-    real(r8), parameter :: mincwetelim =  3.8e-4_r8
-    real(r8), parameter :: maxcwetdlim = -2.0e-5_r8
-    real(r8), parameter :: mincdetulim =  1.e-4_r8
-    real(r8), parameter :: mincdetdlim =  1.e-6_r8
-
-    !// Local parameters
-    real(r8) :: &
-         VEDGE, BAND, DETA, DETB, DELP, &
-         ZCOS, ZDT, SFTD, LV, ESAT, SDEN, &
-         PT, PB, &
-         DELZ, LWC, IWC, TFACT, QMIN, &
-         DMASS, ZAREA, PSRF, &
-         POFLE(LPAR+1)
-
-    !// Indices
-    integer :: I,J,II,JJ,L,LL
-    integer :: NF, NrOf3Dfields, NrOf2Dfields, ioerr, silent
-
-    !// To be read from file
-    integer :: FLD_ID
-    logical :: fex
-
-    logical :: LPVU !// Need to calculate PVU?
-    real(r8) :: fU, fV
-
-    !// Filename for metdata
-    character(len=160) :: FNAME1, FNAME2, FNAME3, FNAME4
-    character(len=2) :: CMON, CDATE
-    character(len=4) :: CYEAR
-
-    integer, parameter :: JPARWNE1 = JPARW+2
-    integer, parameter :: JPARNE1 = JPAR+2
-
-    !//---------------------------------------------------------------------
-    !// Allocatable arrays - double precision
-    real(r8), dimension(:), allocatable :: &
-          UTMP(:)
-    real(r8), dimension(:,:), allocatable :: &
-         VTMP, inXY, inXY_b, &
-         PW, EWSS, NSSS, LSPREC, CNVPREC, W2D, R8XY
-    real(r8), dimension(:,:,:), allocatable :: &
-         TW, QW, CLDFRW, CLDIWCW, CLDLWCW, &
-         ZOFLEW, W3Da, W3Db, R8XYZ, &
-         inXYZ, inXYm1Z, inXYZp1, W3Das
-    !// --------------------------------------------------------------------
-    character(len=*), parameter :: subr = 'update_metdata'
-    !//---------------------------------------------------------------------
-         
-    !// Allocate 3D arrays - native resolution
-    allocate( VTMP(IPARW,JPARW), UTMP(IPARW), &
-              W3Da(IPARW,JPARW,LPARW), W3Db(IPARW,JPARW,LPARW), &
-              W3Das(IPARW,JPARW-1,LPARW), &
-              CLDFRW(IPARW,JPARW,LWEPAR), &
-              CLDIWCW(IPARW,JPARW,LWEPAR), CLDLWCW(IPARW,JPARW,LWEPAR) )
-
-    !// Allocate 3D arrays - native horizontal resolution
-    allocate( ZOFLEW(LPAR+1,IPARW,JPARW), QW(IPARW,JPARW,LPAR), &
-              TW(IPARW,JPARW,LPAR) )
-
-    allocate ( inXYZ(IPARW,JPARWNE1,LPARW), inXYm1Z(IPARW,JPARWNE1-1,LPARW) )
-    allocate ( inXYZp1(IPARW,JPARWNE1,LPARW+1) )
-    allocate ( inXY(IPARW,JPARWNE1), inXY_b(IPARW,JPARWNE1) )
-
-
-    !// Allocate 3D arrays - window resolution (IPAR/JPAR)
-    allocate( R8XYZ(IPAR,JPAR,LPARW) )
-
-    !// Allocate 2D arrays - native resolution
-    allocate( PW(IPARW,JPARW), W2D(IPARW,JPARW) )
-
-    !// Allocate 2D arrays - window resolution (IPAR/JPAR)
-    allocate( LSPREC(IPAR,JPAR),CNVPREC(IPAR,JPAR), &
-              EWSS(IPAR,JPAR), NSSS(IPAR,JPAR), R8XY(IPAR,JPAR) )
-    !//---------------------------------------------------------------------
-
-    !// Initialize
-    !// Time step for meteorological data is DTMET
-    ZDT    = 1._r8 / DTMET
-
-    !// Define minimum humidity QMIN in kg/kg
-    QMIN = 3.e-6_r8 * 18._r8 / M_AIR
-
-!//UPDATE
-    !// locate the position of random number sequence based on year/day/hour
-    IRAN0 = 1 + 3*(JYEAR - 2000) + 7*JDAY + 11*nint(GMTAU)
-
-    if (VERBOSE) then
-       silent=1
-    else
-       silent = 0
-    end if
-    !// File name for this DAY/NMET
-    write(CDATE(1:2),'(i2.2)') JDATE                  ! Date
-    write(CMON(1:2),'(i2.2)') JMON                    ! Month
-    write(MPATH2(1:4),'(i4.4)') MYEAR                 ! Year
-    if (trim(MFILE3) .eq. 'EVA_OCN_REF') then
-       write(CYEAR(1:4),'(i4.4)') MYEAR - 1999 + 70      ! Year 71-80
-    else
-       write(CYEAR(1:4),'(i4.4)') MYEAR - 1999 + 90      ! Year 91-100
-    end if
-    if (metTYPE(1:6) .eq. 'norESM') then
-       !// norESM netcdf file
-       FNAME1 = trim(MPATH1)//trim(MFILE3)// &
-            '_MET.cam.h1.'//CYEAR//'-'//CMON//'-'//CDATE//'-10800nc4.nc'
-       FNAME2 = trim(MPATH1)//trim(MFILE3)// &
-            '_MET.cam.h2.'//CYEAR//'-'//CMON//'-'//CDATE//'-10800nc4.nc'
-       FNAME3 = trim(MPATH1)//trim(MFILE3)// &
-            '_MET.cam.h3.'//CYEAR//'-'//CMON//'-'//CDATE//'-10800nc4.nc'
-
-       !FNAME1 = trim(MPATH1)//trim(MPATH2)//trim(MFILE3)// &
-       !     '.cam.h1.'//CYEAR//'-'//CMON//'-'//CDATE//'-10800nc4.nc'
-       !FNAME2 = trim(MPATH1)//trim(MPATH2)//trim(MFILE3)// &
-       !     '.cam.h2.'//CYEAR//'-'//CMON//'-'//CDATE//'-10800nc4.nc'
-       !FNAME3 = trim(MPATH1)//trim(MPATH2)//trim(MFILE3)// &
-       !     '.cam.h3.'//CYEAR//'-'//CMON//'-'//CDATE//'-10800nc4.nc'
-       ! This file is not available
-       !FNAME4 = trim(MPATH1)//trim(MPATH2)//trim(MFILE3)// &
-       !     '.clm2.h1.'//CYEAR//'-'//CMON//'-'//CDATE//'-10800_nc4.nc'
-    else
-       write(6,'(a)') f90file//':'//subr// &
-            ': Not set up for metTYPE: '//trim(metTYPE)
-       stop
-    end if
-
-    !// Check if files exist
-    inquire(FILE=trim(FNAME1), exist=fex)
-    if (.not. fex) then
-       write(6,'(a)') f90file//':'//subr// &
-            ': No such file: '//trim(FNAME1)
-       stop
-    end if
-
-
-
-    !//---------------------------------------------------------------------
-    !// Initial step - setup P, T and Q
-    !//---------------------------------------------------------------------
-    if (ILOOP .le. 0) then
-
-       !// Set up level weightings if vertical resolution degraded
-       do LL = LPARW+1, 1, -1
-          L   = LMMAP(LL)
-          LMAP(L) = LL
-       end do
-
-       write(6,'(a)') 'Initializing meteorological data'
-
-
-       !// Pressure field --------------------------------------------------
-       !// -----------------------------------------------------------------
-       call readnc_2d_from3d(FNAME1, 'lon',IPARW,'lat',JPARWNE1,&
-            'time',1,'PS',inXY,silent=silent)
-       !// Pa -> hPa
-       inXY(:,:) = inXY(:,:) * 1.d-2
-  
-       !// Combine polar pie pieces
-       call combinePPP(inXY,PW,JPARWNE1,JPARW)
-
-       !// Put PW into P, degrading or not
-       call TRUNG8(PW, P, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-            JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-
-       if (verbose) call gotData(FLD_ID,'SFC','Surface pressure (P)')
-
-
-       !// Temperature -----------------------------------------------------
-       !// -----------------------------------------------------------------
-       call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-            'lev',LPARW,'time',1,'T',inXYZ,silent=silent)
-       !// Turn field upside down
-       do L = 1, LPARW
-          LL = LPARW + 1 - L
-          !// Combine polar pie pieces
-          call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-       end do
-
-       !// Collapse layers
-       TW(:,:,:) = 0._r8
-       do L = 1, LPAR
-         do LL = LMAP(L), LMAP(L+1) - 1
-           do J = 1, JPARW
-             do I = 1, IPARW
-               TW(I,J,L) = TW(I,J,L) + W3Da(I,J,LL) * XLMMAP(LL)
-             end do
-           end do
-         end do
-       end do
-       !// Put TW into T, degrading or not
-       call TRUNG8(TW, T, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-            JDGRD, IPARW, JPARW, IPAR, JPAR, LPAR, 1)
-
-       !// Test to check temperature field
-       if (minval(W3Da(:,:,1)) .le. 0._r8) then
-          write(6,'(a)')  f90file//':'//subr// &
-               ': Surface temperature is <= 0?'
-          write(6,'(a,f9.3)') '  MIN sfc T: ',minval(W3Da(:,:,1))
-          stop
-       end if
-
-       if (verbose) call gotData(FLD_ID,'3di','Temperature (T)')
-
-
-       !// Water vapour ----------------------------------------------------
-       !// -----------------------------------------------------------------
-       call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-            'lev',LPARW,'time',1,'Q',inXYZ,silent=silent)
-       !// Turn field upside down
-       do L = 1, LPARW
-          LL = LPARW + 1 - L
-          !// Combine polar pie pieces
-          call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-       end do
-
-       !// Collapse layers
-       QW(:,:,:) = 0._r8
-       do L = 1,LPAR
-         do LL = LMAP(L),LMAP(L+1)-1
-           do J = 1,JPARW
-             do I = 1,IPARW
-               QW(I,J,L) = QW(I,J,L) + W3Da(I,J,LL) * XLMMAP(LL)
-             end do
-           end do
-         end do
-       end do
-       !// There may be some entries of small negative numbers
-       if (minval(QW) .lt. 0._r8) then
-          print*,'update_metdata: min QW:',minval(QW),', setting to',QMIN
-          do L = 1, LPAR
-            do J = 1, JPARW
-              do I = 1, IPARW
-                if (QW(I,J,L) .lt. 0._r8) QW(I,J,L) = QMIN
-              end do
-            end do
-          end do
-       end if
-
-       !// Put QW into Q, degrading or not
-       call TRUNG8(QW, Q, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-            JDGRD, IPARW, JPARW, IPAR, JPAR, LPAR,1)
-
-       if (verbose) call gotData(FLD_ID,'3di','Specific humidity (Q)')
-
-       !// Polar cap filtering
-       call EPZ_TQ(T, Q, XYZA, XYZB, P, IMEPZ,IPAR,JPAR,LPAR,IPAR,JPAR,LPAR)
-       call EPZ_P(P, IMEPZ, IPAR,JPAR, IPAR, JPAR)
-
-       !// Initialization is done - these steps are for all time steps
-       return
-    end if !// if (ILOOP .le. 0) then
-
-
-    !//---------------------------------------------------------------------
-    !// All time steps - update all meteorological fields
-    !//---------------------------------------------------------------------
-    if (verbose) then
-       write(6,'(a,i5)') f90file//':'//subr// &
-            ': Reading new metdata JDAY: '//TMET//', NMET:',NMET
-    end if
-
-    !// Clear arrays
-    U(:,:,:) = 0._r8
-    V(:,:,:) = 0._r8
-    T(:,:,:) = 0._r8
-    Q(:,:,:) = 0._r8
-    CWETN(:,:,:) = 0._r8
-    CWETE(:,:,:) = 0._r8
-    CWETD(:,:,:) = 0._r8
-    CENTU(:,:,:) = 0._r8
-    CENTD(:,:,:) = 0._r8
-    PRECCNV(:,:,:) = 0._r8
-    PRECLS(:,:,:) = 0._r8
-    CLDFR(:,:,:) = 0._r8
-    CLDLWC(:,:,:) = 0._r8
-    CLDIWC(:,:,:) = 0._r8
-    !// No need to clear 2D arrays; they are fully updated below
-    SLH(:,:) = 0._r8
-    SHF(:,:) = 0._r8
-    SMF(:,:) = 0._r8
-    SFT(:,:) = 0._r8
-    SFQ(:,:) = 0._r8
-    SFU(:,:) = 0._r8
-    SFV(:,:) = 0._r8
-    BLH(:,:) = 0._r8
-    MSLP(:,:) = 0._r8
-    SA(:,:) = 0._r8
-
-
-
-    !//---------------------------------------------------------------------
-    !// 3D GRIDDED DATA - INSTANTANEOUS
-    !//---------------------------------------------------------------------
-
-    !// Pressure field -----------------------------------------------------
-    !// --------------------------------------------------------------------
-    call readnc_2d_from3d(FNAME1, 'lon',IPARW,'lat',JPARWNE1,&
-         'time',NMET,'PS',inXY,silent=silent)
-    !// Pa -> hPa
-    inXY(:,:) = inXY(:,:) * 1.d-2
-  
-    !// Combine polar pie pieces
-    call combinePPP(inXY,PW,JPARWNE1,JPARW)
-
-    !// Put PW into P, degrading or not
-    call TRUNG8(PW, P, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-
-    if (verbose) call gotData(FLD_ID,'SFC','Surface pressure (P)')
-
-
-    !// Temperature --------------------------------------------------------
-    !// --------------------------------------------------------------------
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',NMET,'T',inXYZ,silent=silent)
-    !// Turn field upside down
-    do L = 1, LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    !// Collapse layers
-    TW(:,:,:) = 0._r8
-    do L = 1, LPAR
-      do LL = LMAP(L), LMAP(L+1) - 1
-        do J = 1, JPARW
-          do I = 1, IPARW
-            TW(I,J,L) = TW(I,J,L) + W3Da(I,J,LL) * XLMMAP(LL)
-          end do
-        end do
-      end do
-    end do
-    !// Put TW into T, degrading or not
-    call TRUNG8(TW, T, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, LPAR, 1)
-
-    if (verbose) call gotData(FLD_ID,'3di','Temperature (T)')
-
-
-    !// Zonal wind (U) -----------------------------------------------------
-    !// --------------------------------------------------------------------
-    !// m/s -> kg/s
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',NMET,'U',inXYZ,silent=silent)
-    !// Turn field upside down
-    do L = 1, LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'slat',JPARWNE1-1, &
-         'lev',LPARW,'time',NMET,'US',inXYm1Z,silent=silent)
-    !// Turn field upside down
-    do L = 1, LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYm1Z(:,:,L),W3Das(:,:,LL),JPARWNE1-1,JPARW-1)
-    end do
-
-
-
-
-    !// 1. What to do with winds
-    !//    U needs to be shifted: U(I) is to be eastward flux into
-    !//    box I, i.e. at the western edge of the box.
-    !//      At poles, the grid point shifts halfway towards meridional
-    !//      staggered location.
-    !//    V: In CTM3, V(J) is wind (converted to flux) into grid box J.
-    !//       It is by default set to zero at the poles, even though
-    !//       NorESM has V at polar cap.
-    !//       NorESM-V thus has to be shifted polewards to the
-    !//       V-staggered positions:
-    !//       V(1) = 0.d0 ! if possible: inV(1) !// wind into pie piece
-    !//       do J=2,JPAR
-    !//          V(J) = 0.5d0 * (inV(J-1) + inV(J))
-    !//       end do
-    !// 2. What to do with grid center polar cap values for other
-    !//    species?
-    !//    I will use the polar pie pieces as though they are given
-    !//    in their new centers.
-
-    !// Change grid centers from  polar cap to pie piece centers
-    !// Use mean of polar cap wind and staggered grid wind.
-    do L = 1, LPARW
-       do I = 1, IPARW
-          W3Da(I,1,L) = 0.5_r8 * (W3Da(I,1,L) + W3Das(I,1,L))
-          W3Da(I,JPARW,L) = 0.5_r8 * (W3Da(I,JPARW,L) + W3Das(I,JPARW-1,L))
-       end do
-    end do
-
-
-    !// Save grid center m/s
-    W3Db(:,:,:) = W3Da(:,:,:)
-
-    !// CTM3 needs U-wind on edges (INTO box from west); converted here:
-    do L = 1, LPARW
-       do J = 1, JPARW
-          do I = 1, IPARW
-             UTMP(I) = W3Da(I,J,L)
-          end do
-          do I = 2, IPARW
-             W3Da(I,J,L) = 0.5_r8 * (UTMP(I-1) + UTMP(I))
-          end do
-          W3Da(1,J,L) = 0.5_r8 * (UTMP(IPARW) + UTMP(1))
-       end do
-    end do
-
-
-    !// Convert U to flux out of grid box (to the east) [kg/s]
-    do L = 1, LPARW
-       DETA = ETAAW(L) - ETAAW(L+1)
-       DETB = ETABW(L) - ETABW(L+1)
-       do J = 1, JPARW
-          BAND = A0 * (WGLYE(J+1) - WGLYE(J))
-          !// Have U at edges (unit conversion needs pressure on edge)
-          do I = 2, IPARW
-             DELP = DETA + DETB * (PW(I-1,J) + PW(I,J)) * 0.5_r8
-             W3Da(I,J,L) = W3Da(I,J,L) * DELP * BAND
-          end do
-          DELP = DETA + DETB * (PW(1,J) + PW(IPARW,J)) * 0.5_r8
-          W3Da(1,J,L) = W3Da(1,J,L) * DELP * BAND
-       end do
-    end do
-
-    if (ldeg) then
-       do L = 1, LPAR
-         do LL = LMAP(L),LMAP(L+1)-1
-           do I = 1, IPAR
-             II = IMAP(1,I)
-             do J = 1, JPAR
-               do JJ = 1, JDGRD
-                 U(I,J,L) = U(I,J,L) + W3Da(II,JMAP(JJ,J),LL)
-               end do
-             end do
-           end do
-         end do
-       end do
-    else
-       do L = 1, LPAR
-         do LL = LMAP(L),LMAP(L+1)-1
-           do J = 1, JPAR
-             do I = 1, IPAR
-               U(I,J,L) = U(I,J,L) + W3Da(I,J,LL)
-             end do
-           end do
-         end do
-       end do
-    end if
-
-    if (verbose) call gotData(FLD_ID,'3di','Zonal wind (U)')
-
-    !// Save UMS -----------------------------------------------------------
-    !//---------------------------------------------------------------------
-    !// Degrade vertically and horizontally, put into (LPAR,IPAR,JPAR)
-    call ijlw2lij(W3Db, LMAP, XLMMAP, IPAR, JPAR, LPAR, IPARW, &
-         JPARW, LPARW, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, JDGRD, UMS)
-    if (verbose) then
-       write(*,'(a,2es12.3)') &
-            '   Min/max UMS  ', minval(UMS),maxval(UMS)
-    end if
-
-    !// Meridional wind (V) ------------------------------------------------
-    !// --------------------------------------------------------------------
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',NMET,'V',inXYZ,silent=silent)
-    !// Turn field upside down
-    do L = 1, LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Db(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    !// First prepare V-wind; this is center values when
-    !// read from NorESM data. In VMSW we save the polar pie
-    !// piece centers, just as for U.
-    !// These centers are 1/3 distance from polar cap and 2/3 from
-    !// the next grid box center, so I use these as weightings.
-    W3Da(:,:,:) = W3Db(:,:,:)
-    do L = 1, LPARW
-       do I = 1, IPARW
-          W3Da(I,1,L) = 1._r8/3._r8 * W3Da(I,2,L) &
-                        + 2._r8/3._r8 * W3Da(I,1,L)
-          W3Da(I,JPARW,L) = 1._r8/3._r8 * W3Da(I,JPARW-1,L) &
-                        + 2._r8/3._r8 * W3Da(I,JPAR,L)
-       end do
-    end do
-
-    !// But CTM3 needs V-wind on edges, so we convert to this.
-    !// V is to be flux INTO the box, so V(I,2,L) is out of polar pie
-    !// piece and into J=2. CTM3 disregards V at polar cap, even though
-    !// there are wind data at the polar cap in NorESM.
-    !// I have no work-around at the moment.
-    do L = 1, LPARW
-       do I = 1, IPARW
-          do J = 1, JPARW
-             VTMP(J,1) = W3Db(I,J,L)
-          end do
-          !// South Pole polar cap; will not be used
-          W3Db(I,1,L) = 0.d0
-          do J = 2, JPARW
-             W3Db(I,J,L) = 0.5_r8 * (VTMP(J-1,1) + VTMP(J,1))
-          end do
-          !// At North Pole (V(JPARW+1), we will override with zero,
-          !// so array does not cover this value.
-       end do
-    end do
-
-
-    !// scale from V=v*cos() to v (remember V is on edge already)
-    do L = 1, LPARW
-       DETA = ETAAW(L) - ETAAW(L+1)
-       DETB = ETABW(L) - ETABW(L+1)
-
-       VTMP(:,:) = 0._r8 !// Needed for getting VMSW
-       !// W3Db does not start at SP, but at the J=2. It means
-       !// W3Db is flux out of box J, not into J.
-       !// Given all edge points, the number of boxes should be
-       !// JPARW+1, covering 1:JPARW+1. But both the poles should
-       !// have zero wind, so we only need JPARW-1 boxes.
-
-       do J = 2, JPARW
-          VEDGE  = 2._r8 * CPI * A0 * COS(WGLYE(J)) / real(IPARW, r8)
-          do I = 1, IPARW
-             DELP = DETA + DETB * (PW(I,J-1) + PW(I,J)) * 0.5_r8
-             W3Db(I,J,L) = W3Db(I,J,L) * VEDGE * DELP
-          end do
-       end do
-    end do
-
-    if (ldeg) then
-       do L = 1, LPAR
-         do LL = LMAP(L),LMAP(L+1)-1
-           do J = 1, JPAR
-             JJ = JMAP(1,J)
-             do I = 1, IPAR
-               do II = 1, IDGRD
-                 V(I,J,L) = V(I,J,L) + W3Db(IMAP(II,I),JJ,LL)
-               end do
-             end do
-           end do
-         end do
-       end do
-    else
-       do L = 1, LPAR
-         do LL = LMAP(L),LMAP(L+1)-1
-           do J = 1, JPAR
-             do I = 1, IPAR
-               V(I,J,L) = V(I,J,L) + W3Db(I,J,LL)
-             end do
-           end do
-         end do
-       end do
-    end if
-
-    if (verbose) call gotData(FLD_ID,'3di','Meridional wind (V)')
-
-
-    !// Save VMS -----------------------------------------------------------
-    !//---------------------------------------------------------------------
-    !// Degrade vertically and horizontally, put into (LPAR,IPAR,JPAR)
-    call ijlw2lij(W3Da, LMAP, XLMMAP, IPAR, JPAR, LPAR, IPARW, &
-         JPARW, LPARW, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, JDGRD, VMS)
-
-    if (verbose) then
-       write(*,'(a,2es12.3)') &
-            '   Min/max VMS  ', minval(VMS),maxval(VMS)
-    end if
-
-
-
-    !//---------------------------------------------------------------------
-    !// 3-d GRID POINT DATA
-    !//---------------------------------------------------------------------
-
-
-    !// Water vapour -------------------------------------------------------
-    !// --------------------------------------------------------------------
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',1,'Q',inXYZ,silent=silent)
-    !// Turn field upside down
-    do L = 1, LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-    !// Collapse layers
-    QW(:,:,:) = 0._r8
-    do L = 1, LPAR
-      do LL = LMAP(L), LMAP(L+1)-1
-        do J = 1, JPARW
-          do I = 1, IPARW
-            QW(I,J,L) = QW(I,J,L) + W3Da(I,J,LL) * XLMMAP(LL)
-          end do
-        end do
-      end do
-    end do
-    if (minval(QW) .lt. 0._r8) then
-       print*,'update_metdata: min QW:',minval(QW),', setting to',QMIN
-       do L = 1, LPAR
-         do J = 1, JPARW
-           do I = 1, IPARW
-             if (QW(I,J,L) .lt. 0._r8) QW(I,J,L) = QMIN
-           end do
-         end do
-       end do
-    end if
-
-    !// Put QW into Q, degrading or not
-    call TRUNG8(QW, Q, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, LPAR, 1)
-
-    if (verbose) call gotData(FLD_ID,'3di','Specific humidity (Q)')
-
-
-    !// Altitudes - calculated ---------------------------------------------
-    !// --------------------------------------------------------------------
-    !// R = 287.*(1-Q) + 461.5*Q -- assume 0.5% bl w.v.==> R = 288.
-    !// delta-z (m) = dln(P) * R * T / g   where R/g = 288/9.81 = 29.36
-    !// CTM3: We use Q directly instead of assuming 0.5%;
-    !// Using Rd=287 and Tv=T*(1 + 0.6*q); 287/9.80665=29.26586
-    do J = 1, JPAR
-      do I = 1, IPAR
-        PSRF  = P(I,J)
-        !// Surface pressure; must be set for DELZ to be calculated
-        POFLE(1)  = PSRF
-        !// Height of box bottom, above sea level (acts as topography)
-        ZOFLE(1,I,J)  = 16.e3_r8 * log10(1013.25_r8 / PMEAN(I,J))
-        if (ZOFLE(1,I,J) .ne. ZOFLE(1,I,J)) then
-           write(6,'(a,i3,2i5,2es12.2)')  f90file//':'//subr// &
-                ': ZOFLE a',1,i,j,PMEAN(I,J),PMEANW(I,J)
-           write(6,*) pmean(:,j)
-           stop
-        end if
-        do L = 2, LPAR + 1
-          !// Pressure of box bottom
-          POFLE(L)  = ETAA(L) + ETAB(L) * PSRF
-          !DELZ  = -29.36_r8 * T(I,J,L-1) * log(POFLE(L)/POFLE(L-1))
-          !// Thickness of layer (L-1) (remember ZOFLE starts at topography)
-          DELZ = -29.26586_r8 * T(I,J,L-1) * (1._r8 + 0.6_r8 * Q(I,J,L-1)) &
-                             * log(POFLE(L)/POFLE(L-1))
-          !// Add DELZ of (L-1) to get box bottom height of L
-          ZOFLE(L,I,J) = ZOFLE(L-1,I,J) + DELZ
-          if (ZOFLE(L,I,J) .ne. ZOFLE(L,I,J)) then
-             write(6,'(a,i3,2i5,4es12.2)')  f90file//':'//subr// &
-                  ': ZOFLE b',l,i,j,delz,q(i,j,l-1),&
-                  T(I,J,L-1),psrf
-             stop
-          end if
-        end do
-      end do
-    end do
-
-    !// Also set up ZOFLEW for metdata grid
-    do J = 1, JPARW
-      do I = 1, IPARW
-        PSRF  = PW(I,J)
-        POFLE(1)  = PSRF
-        ZOFLEW(1,I,J)  = 16e3_r8 * log10(1013.25_r8 / PMEANW(I,J))
-        do L = 2, LPAR + 1
-          POFLE(L)  = ETAA(L) + ETAB(L)*PSRF
-          !DELZ  = -29.36_r8 * TW(I,J,L-1) * log(POFLE(L)/POFLE(L-1))
-          !// Thickness of layer below
-          DELZ = -29.26586_r8 * TW(I,J,L-1)*(1._r8 + 0.6_r8*QW(I,J,L-1)) &
-                             * log(POFLE(L)/POFLE(L-1))
-          ZOFLEW(L,I,J) = ZOFLEW(L-1,I,J) + DELZ
-        end do
-      end do
-    end do
-
-
-    !// Potantial vorticity ------------------------------------------------
-    !// --------------------------------------------------------------------
-    !// Not available yet
-    !// Convert to PVU
-    !// W3Da(:,:,:) = W3Da(:,:,:) * 1.e6_r8
-    W3Da(:,:,:) = 0._r8
-    if (maxval(W3Da) .eq. 0._r8) then
-       !// PV was not on available.
-       !// Generate PV on model resolution and convert to PVU
-       call get_pvu()
-    else
-       !// Transform into PVU-array
-       call ijlw2lij(W3Da, LMAP, XLMMAP, IPAR, JPAR, LPAR, IPARW, &
-            JPARW, LPARW, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, JDGRD, PVU)
-    end if
-
-
-    !// Cloud Liquid Water Content [Kg/Kg] - midpoint value ----------------
-    !// --------------------------------------------------------------------
-    !// Cloud routine needs CLDLWCW in any case, so we calculate
-    !// that first. Could repeat with R8XYZ, but rather do
-    !// degradation of CLDLWCW.
-    call readnc_3d_from4d(FNAME2, 'lon',IPARW,'lat',JPARWNE1, &
-            'lev',LPARW,'time',NMET,'CLDLIQ',inXYZ,silent=silent)
-    !// Turn field upside down
-    do L = 1,LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    CLDLWCW(:,:,:)  = 0._r8
-    do L = 1, LWEPAR
-      do LL = LMAP(L), LMAP(L+1)-1
-        do J = 1, JPARW
-          do I = 1, IPARW
-            CLDLWCW(I,J,L) = CLDLWCW(I,J,L) + W3Da(I,J,LL) * XLMMAP(LL)
-          end do
-        end do
-      end do
-    end do
-    !// Put CLDLWCW into LCDLWC, degrading or not
-    call TRUNG8(CLDLWCW, CLDLWC, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, LWEPAR, 1)
-
-
-    !// Cloud Ice Water Content [Kg/Kg] - midpoint value -------------------
-    !// --------------------------------------------------------------------
-    !// Cloud routine needs CLDIWCW in any case, so we calculate
-    !// that first.
-    call readnc_3d_from4d(FNAME2, 'lon',IPARW,'lat',JPARWNE1, &
-            'lev',LPARW,'time',NMET,'CLDICE',inXYZ,silent=silent)
-    !// Turn field upside down
-    do L = 1,LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    CLDIWCW(:,:,:)  = 0._r8
-    do L = 1, LWEPAR
-      do LL = LMAP(L), LMAP(L+1)-1
-        do J = 1, JPARW
-          do I = 1, IPARW
-            CLDIWCW(I,J,L) = CLDIWCW(I,J,L) + W3Da(I,J,LL) * XLMMAP(LL)
-          end do
-        end do
-      end do
-    end do
-    !// Put CLDIWCW into LCDIWC, degrading or not
-    call TRUNG8(CLDIWCW, CLDIWC, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, LWEPAR, 1)
-
-
-    !// Cloud Fraction [0,1] - midpoint value ------------------------------
-    !// --------------------------------------------------------------------
-    !// Cloud routine needs CLDFRW in any case, so we calculate
-    !// that first.
-    call readnc_3d_from4d(FNAME2, 'lon',IPARW,'lat',JPARWNE1, &
-            'lev',LPARW,'time',NMET,'CLOUD',inXYZ,silent=silent)
-    !// Turn field upside down
-    do L = 1,LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    CLDFRW(:,:,:) = 0._r8
-    do L = 1, LWEPAR
-      do LL = LMAP(L), LMAP(L+1)-1
-        do J = 1, JPARW
-          do I = 1, IPARW
-            CLDFRW(I,J,L) = CLDFRW(I,J,L) &
-                    + max(min(W3Da(I,J,LL),1._r8),0._r8) * XLMMAP(LL)
-          end do
-        end do
-      end do
-    end do
-    !// Put CLDFRW into LCDFR, degrading or not
-    call TRUNG8(CLDFRW, CLDFR, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, LWEPAR, 1)
-
-
-    !//---------------------------------------------------------------------
-    !// 3D GRIDDED DATA - ACCUMULATED
-    !//---------------------------------------------------------------------
-
-    !// Mass Flux updrafts [accumulated kg/(m^2*s)] ------------------------
-    !// --------------------------------------------------------------------
-    !// - Mass flux is through BOTTOM EDGE of grid box (i.e. model
-    !//   half layers).
-    !//
-    !// Consists of deep convection and shallow convection, given on
-    !// separate fields. Fields are averaged over time step, so there
-    !// is no need to divide by DT.
-    !//
-    !// Deep convection is on lev, and has non-zero values at surface
-    !// layer, both for updraft (positive values) and downdraft
-    !// (negative). This means that flux is on upper edges/interfaces.
-    !// NorESM thus has zero ZMMU at model top (no flux out to space).
-    !//
-    !// Moist shallow convection mass flux is net of up-down, and is
-    !// given on ilev. Thus, the values are flux into the box from
-    !// below, and values are zero at surface and at LPARW+1.
-    !//
-    !// Read both datasets and add together:
-    !// Deep convection updraft mass flux
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',NMET,'ZMMU',inXYZ,silent=silent)
-
-    !// Moist shallow convection mass flux (net of up-down)
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'ilev',LPARW+1,'time',NMET,'SHLWFLX',inXYZp1,silent=silent)
-
-    !// Add fields
-    inXYZ(:,:,:) = inXYZ(:,:,:) + inXYZp1(:,:,2:LPARW+1)
-
-    !// CTM3: Mass flux is through BOTTOM EDGE of grid box
-    !//       (i.e. model half layers), so surface layer must
-    !//       have zero flux.
-    !//       - Scale with area --> [kg/s]
-    !//       - Data are averages, not accumulated, so we do
-    !//         not need to divide by DT.
-    !//
-    !// Turn field upside down, and do the vertical shift
-    !// at the same time so that values are flux through bottom
-    !// of grid box
-    W3Da(:,:,1) = 0.d0
-    do L = 2,LPARW !// From 2 to account for the shifting
-       LL = LPARW + 1 - L
-       !// L=LPARW -> LL=1 (could add 1, but rather add to LL below)
-       !// ZMMD: Shift the CTM3 values up 1 level
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL+1),JPARWNE1,JPARW)
-    end do
-
-    !// Override fluxes in stratosphere?
-    !W3Da(:,:,LWEPARW+1:LPARW) = 0._r8
-    !// Possibly degrade without collapsing
-    call TRUNG8(W3Da, R8XYZ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD,IPARW,JPARW,IPAR,JPAR,LPARW,1)
-
-    CWETE(:,:,:) = 0._r8 !// No flux up from surface
-    !// Start retrieval at layer 1, since degrWK3D is already
-    !// converted to CTM definition
-    do L = 1, LWEPAR
-       !// LMAP is full-level, but for since mass fluxes are not stored
-       !// for surface, and starts at layer 2, we need to subtract 1.
-       !// What comes into L=2, comes from LMAP(2)-1.
-       !// For L40, L=2 and LMAP(2)-1 = 1, while
-       !// for L37, L=2 and LMAP(2)-1 = 3
-       LL = LMAP(L)
-       do J = 1, JPAR
-          do I = 1, IPAR
-             !// Filter values. File data has minimum values less than zero.
-             !// Hence we treat values less that that as as zero
-             if (R8XYZ(I,J,LL) .gt. mincwetelim) then
-                CWETE(I,J,L) = R8XYZ(I,J,LL) * AREAXY(I,J) !// kg/s
-             else
-                CWETE(I,J,L) = 0._r8
-             end if
-          end do
-       end do
-    end do
-
-    !// Need to scale down convection to avoid too short time steps
-    !CWETE(:,:,:) = CWETE(:,:,:) * 0.5_r8
-
-    if (verbose) call gotData(212,'3da','ZMMU')
-
-    !// Mass Flux downdrafts [accumulated kg/(m^2*s)] ----------------------
-    !// --------------------------------------------------------------------
-    !// - Mass flux is through BOTTOM EDGE of grid box (i.e. model
-    !//   half layers).
-    !//   This means that the flux for layer 1 is zero, and that
-    !//   downward flux is NEGATIVE, going out at the bottom of the box.
-    !// - EC-data are stored from half layer 2, since the flux into
-    !//   layer 1 is always zero (no flux in through surface).
-    !// - For a grid box in layer L, -FD(L) goes out at bottom
-    !//   and -FD(L+1) comes in from above (FD is negative). The
-    !//   balance with entrainment E and detrainment D is:
-    !//   FD(L) - FD(L+1) = E - D
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',NMET,'ZMMD',inXYZ,silent=silent)
-
-    !// Turn field upside down, and do the vertical shift
-    !// at the same time so that values are flux through bottom
-    !// of grid box
-    W3Da(:,:,1) = 0.d0
-    do L = 2,LPARW !// From 2 to account for the shifting
-       LL = LPARW + 1 - L
-       !// L=LPARW -> LL=1 (could add 1, but rather add to LL below)
-       !// ZMMD: Shift the CTM3 values up 1 level
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL+1),JPARWNE1,JPARW)
-    end do
-
-    W3Da(:,:,LWEPARW+1:LPARW) = 0._r8
-    !// Possibly degrade without collapsing
-    call TRUNG8(W3Da, R8XYZ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD,IPARW,JPARW,IPAR,JPAR,LPARW,1)
-
-    CWETD(:,:,:) = 0._r8 !// No flux down to surface
-    !// Start retrieval at layer 1, since degrWK3D is already
-    !// converted to CTM definition
-    do L = 1, LWDPAR
-       LL = LMAP(L)
-       do J = 1, JPAR
-          do I = 1, IPAR
-             if (R8XYZ(I,J,LL) .lt. maxcwetdlim) then
-                CWETD(I,J,L) = R8XYZ(I,J,LL) * AREAXY(I,J) !// kg/s
-             else
-                CWETD(I,J,L) = 0._r8
-             end if
-          end do
-       end do
-    end do
-
-    if (verbose) call gotData(213,'3da','ZMMD')
-
-
-    !// Updrafts entrainment rate [accumulated kg/(m2*s)] ------------------
-    !// --------------------------------------------------------------------
-    !// Entrainment is read from file.
-    !// The rate kg/m2/s, as average over the meteorological time step.
-    !// Detrainment must be summed up when collapsing layers !
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',NMET,'ZMEU',inXYZ,silent=silent)
-
-    !// Turn field upside down
-    do L = 1,LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    W3Da(:,:,LWEPARW+1:LPARW) = 0._r8
-    !// Possibly degrade without collapsing
-    call TRUNG8(W3Da, R8XYZ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD,IPARW,JPARW,IPAR,JPAR,LPARW,1)
-
-    CENTU(:,:,:) = 0._r8
-    do J = 1, JPAR
-       do I = 1, IPAR
-          do L = 1, LWEPAR
-             do LL = LMAP(L), LMAP(L+1) - 1
-                !// Detrainment must be summed up when collapsing layers
-                !if (R8XYZ(I,J,LL) .gt. mincdetulim) then
-                   CENTU(I,J,L) = CENTU(I,J,L) &
-                        + R8XYZ(I,J,LL) * XLMMAP(LL) &
-                          * AREAXY(I,J)
-                !end if
-             end do
-          end do
-       end do
-    end Do
-
-    if (verbose) call gotData(214,'3da','ZMEU')
-
-
-    !// Downdrafts entrainment rate [acc. kg/(m2*s)] -----------------------
-    !// --------------------------------------------------------------------
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'lev',LPARW,'time',NMET,'ZMED',inXYZ,silent=silent)
-
-    !// Turn field upside down
-    do L = 1,LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    W3Da(:,:,LWEPARW+1:LPARW) = 0._r8
-    !// Possibly degrade without collapsing
-    call TRUNG8(W3Da, R8XYZ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD,IPARW,JPARW,IPAR,JPAR,LPARW,1)
-
-    CENTD(:,:,:) = 0._r8
-    do J = 1, JPAR
-       do I = 1, IPAR
-          do L = 1, LWDPAR
-             do LL = LMAP(L),LMAP(L+1)-1
-                !if (R8XYZ(I,J,LL) .gt. mincdetdlim) then
-                   CENTD(I,J,L) = CENTD(I,J,L) &
-                        + R8XYZ(I,J,LL) * XLMMAP(LL) &
-                          * AREAXY(I,J)
-                !end if
-             end do
-          end do
-       end do
-    end do
-
-    if (verbose) call gotData(215,'3da','ZMED')
-
-    !// Filter fluxes for wrong signs etc.
-    !// call fluxfilter(cdetu, cdetd)
-    call fluxfilter_ENT()
-         
-    if (verbose) then
-       write(*,'(a)')'*** Done fluxfilter_ENT ***'
-       write(*,'(a,2es12.3)') &
-            '   Read conv. updr.mass flx.(CWETE)  ',&
-            minval(CWETE),maxval(CWETE)
-       write(*,'(a,2es12.3)')&
-            '   Read conv. downdr.mass flx.(CWETD)',&
-            minval(CWETD),maxval(CWETD)
-       write(*,'(a,2es12.3)')&
-            '   Read updr.entr.flx.(CENTU)        ',&
-            minval(CENTU),maxval(CENTU)
-       write(*,'(a,2es12.3)')&
-            '   Read downdr.entr.flx.(CENTD)      ',&
-            minval(CENTD),maxval(CENTD)
-    end if
-
-
-    !// CONVECTIVE RAINFALL [kg/(m^2)/s] (stored as mean)
-    !// --------------------------------------------------------------------
-    !// Rain out of grid box bottom
-    !// Deep convection plus shallow convection
-
-    !// Deep:  ZMFLXPRC(time, ilev, lat, lon)
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'ilev',LPARW+1,'time',NMET,'ZMFLXPRC',inXYZp1,silent=silent)
-    !// Pick edge values
-    inXYZ(:,:,1:LPAR) = inXYZp1(:,:,2:LPAR+1)
-
-    !// Shallow: UWFLXPRC(time, ilev, lat, lon)
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'ilev',LPARW+1,'time',NMET,'UWFLXPRC',inXYZp1,silent=silent)
-    !// Add edge values
-    inXYZ(:,:,1:LPAR) = inXYZ(:,:,1:LPAR) + inXYZp1(:,:,2:LPAR+1)
-
-    !// Turn field upside down
-    do L = 1,LPARW
-       LL = LPARW + 1 - L
-       !// Combine polar pie pieces
-       call combinePPP(inXYZ(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    W3Da(:,:,LWEPARW+1:LPARW) = 0._r8
-    !// Possibly degrade without collapsing
-    call TRUNG8(W3Da, R8XYZ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD,IPARW,JPARW,IPAR,JPAR,LPARW,1)
-
-    PRECCNV(:,:,:) = 0._r8
-    do L = 1, LWEPAR
-       LL = LMAP(L)
-       do J = 1, JPAR
-          do I = 1, IPAR
-             PRECCNV(I,J,L) = &
-                  max(0._r8, R8XYZ(I,J,LL) * AREAXY(I,J))
-          end do
-       end do
-    end do
-
-    if (verbose) then
-       write(*,'(a,2es12.3)') &
-            '   Read conv. precip  ',&
-            minval(PRECCNV),maxval(PRECCNV)
-    end if
-
-
-
-    !// LARGE SCALE RAINFALL [kg/(m^2*s)] (written as mean) -----------
-    !// --------------------------------------------------------------------
-    !// Rain out of grid box bottom
-    !// LS_FLXPRC(time, ilev, lat, lon)
-    call readnc_3d_from4d(FNAME1, 'lon',IPARW,'lat',JPARWNE1, &
-         'ilev',LPARW+1,'time',NMET,'LS_FLXPRC',inXYZp1,silent=silent)
-
-    !// Turn field upside down
-    do L = 2,LPARW+1
-       LL = LPARW + 1 - L + 1
-       !// Combine polar pie pieces
-       call combinePPP(inXYZp1(:,:,L),W3Da(:,:,LL),JPARWNE1,JPARW)
-    end do
-
-    W3Da(:,:,LWEPARW+1:LPARW) = 0._r8
-    !// Possibly degrade without collapsing
-    call TRUNG8(W3Da, R8XYZ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD,IPARW,JPARW,IPAR,JPAR,LPARW,1)
-
-    PRECLS(:,:,:) = 0._r8
-    do L = 1, LWEPAR
-       LL = LMAP(L)
-       do J = 1, JPAR
-          do I = 1, IPAR
-             PRECLS(I,J,L) = &
-                  max(0._r8, R8XYZ(I,J,LL) * AREAXY(I,J))
-          end do
-       end do
-    end do
-
-    if (verbose) then
-       write(*,'(a,2es12.3)') &
-            '   Read larg. precip  ',&
-            minval(PRECLS),maxval(PRECLS)
-    end if
-
-
-    !//---------------------------------------------------------------------
-    !// Cloud cover routines
-    if (LOSLOCHEM) &
-         !// New cloud treatment (qcode_60a)
-         call CLOUD(CLDFRW,CLDIWCW,CLDLWCW,PW,TW,ETAA,ETAB,AREAXYW, &
-                    ZOFLEW,ZDEGI,ZDEGJ,IMAP,JMAP, &
-                    SWSTORE,CLDSTORE,TYPSTORE,RAN4,IRAN0, &
-                    LCLDAVG,LCLDQMD,LCLDQMN,LCLDRANA,LCLDRANQ)
-    !//---------------------------------------------------------------------
-
-
-
-
-
-    !//---------------------------------------------------------------------
-    !// 2-d SURFACE GRID POINT DATA
-    !//---------------------------------------------------------------------
-
-    !// SEA ICE COVER (CI) -------------------------------------------------
-    !// --------------------------------------------------------------------
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'ICEFRAC',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, CI, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    if (verbose) call gotData(FLD_ID,'2di','Sea ice (CI)')
-
-
-    !// Snow Evaporation (ES) (accumulated) --------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: m/s water equivalent, accumulated (m w.eq.)
-    !// Not found in NorESM
-    ES(:,:,:) = 0._r8
-    if (verbose) call gotData(FLD_ID,'2da','Snow Evaporation (ES) not available')
-
-    !// Snow Melt (SMLT) (accumulated) -------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: mm/s (water equivalent?)
-!    call readnc_2d_from3d(FNAME4, 'lon',IPARW,'lat',JPARWNE1, &
-!         'time',NMET,'QSNOMELT',inXY,silent=silent)
-!
-!    do J = 1,JPARWNE1
-!       do I = 1,IPARW
-!          if (inXY(I,J) .gt. 1.e20_r8) inXY(I,J) = 0.d0
-!       end do
-!    end do
-!
-!    call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-!         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-!    R8XY(:,:) = max(0._r8, R8XY(:,:))  !// Limit to positive values
-!    call data2mpblocks(R8XY, SMLT)
-!    if (verbose) call gotData(FLD_ID,'2da','Snow Melt (SMLT)')
-    SMLT(:,:,:) = 0._r8
-    if (verbose) call gotData(FLD_ID,'2da','Snow Melt (SMLT) not available')
-
-
-    !// Photosynthetically active radiation @ sfc (PAR) (accumulated) ------
-    !// --------------------------------------------------------------------
-    !// Unit: (W/m2)
-    !// CTM3 does not distinguish on leaves in the sun or in
-    !// the shade. Cannot use sum, but possibly a weighting.
-    !// No possibility to check this, but we can perhaps
-    !// assume that at least 50% of forest is in shade.
-!    call readnc_2d_from3d(FNAME4, 'lon',IPARW,'lat',JPARWNE1, &
-!         'time',NMET,'PARSUN',inXY,silent=silent)
-!    call readnc_2d_from3d(FNAME4, 'lon',IPARW,'lat',JPARWNE1, &
-!         'time',NMET,'PARSHA',inXY_b,silent=silent)
-!
-!    do J = 1,JPARWNE1
-!       do I = 1,IPARW
-!          if (inXY(I,J) .gt. 1.e20_r8) inXY(I,J) = 0.d0
-!       end do
-!    end do
-!    do J = 1,JPARWNE1
-!       do I = 1,IPARW
-!          if (inXY_b(I,J) .gt. 1.e20_r8) inXY_b(I,J) = 0.d0
-!       end do
-!    end do
-!
-!    !// Combine polar pie pieces
-!    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-!    call TRUNG8(W2D, PAR, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-!         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-!    if (verbose) call gotData(FLD_ID,'2da','Photosyn. act. rad. sfc (PAR)')
-
-    PhotActRad(:,:) = 0._r8
-    if (verbose) call gotData(FLD_ID,'2da','Photosynthetically active radiation not available')
-
-
-    !// Snow depth (SD) ----------------------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: m water equivalent
-    !// Separate fields for snow on (sea) ice and for land.
-    !// SNOWHICE(time, lat, lon) (Water equivalent snow depth)
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'SNOWHICE',inXY,silent=silent)
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'SNOWHLND',inXY_b,silent=silent)
-    do J = 1,JPARWNE1
-       do I = 1,IPARW
-          if (inXY(I,J) .gt. 1.e20_r8) inXY(I,J) = 0.d0
-       end do
-    end do
-    do J = 1,JPARWNE1
-       do I = 1,IPARW
-          if (inXY_b(I,J) .gt. 1.e20_r8) inXY_b(I,J) = 0.d0
-       end do
-    end do
-
-    inXY(:,:) = inXY(:,:) + inXY_b(:,:)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, SD, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    if (verbose) call gotData(FLD_ID,'2di','Snow depth (SD)')
-
-
-    !// Large Scale Precipitation (stratiform) (accumulated) ---------------
-    !// --------------------------------------------------------------------
-    !call get_netcdf_var_2d(FNAME, 'LSPREC',W2D, IPARW, JPARW)
-    !call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-    !     JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    !LSPREC(:,:) = R8XY(:,:) * ZDT
-    !if (verbose) call gotData(FLD_ID,'2da','Large Scale Precip. (LSPREC)')
-
-
-    !// Convective Precipitation (accumulated) -----------------------------
-    !// --------------------------------------------------------------------
-    !call get_netcdf_var_2d(FNAME, 'CONVPREC',W2D, IPARW, JPARW)
-    !call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-    !     JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    !CNVPREC(:,:) = R8XY(:,:) * ZDT
-    !if (verbose) call gotData(FLD_ID,'2da','Conv. Precip. (CONVPREC)')
-
-
-    !// SnowFall SF (accumulated) ------------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: m/s
-    !// Separated into snow fall for large scale and convective
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'PRECSL',inXY,silent=silent)
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'PRECSC',inXY_b,silent=silent)
-
-    inXY(:,:) = inXY(:,:) + inXY_b(:,:)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    call data2mpblocks(R8XY, SNFL)
-    if (verbose) call gotData(FLD_ID,'2da','Snow fall (SNFL)')
-
-
-    !// Surface Sensible Heat Flux SSHF (accumulated) ----------------------
-    !// --------------------------------------------------------------------
-    !// Unit: W/m2
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'SHFLX',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, SHF, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    !// Fluxes of zero cause grief with deposition, PBL.
-    !// SHF numbers from -400 to 100, set a small number to avoid
-    !// overflow, not worry about small negative going to small positive
-    do J = 1, JPAR
-       do I = 1, IPAR
-          if (abs(SHF(I,J)) .lt. 1.e-6_r8) SHF(I,J) = 1.e-6_r8
-       end do
-    end do
-    if (verbose) call gotData(FLD_ID,'2da','Sfc. sens. heat flux (SHF)')
-
-
-    !// Surface Latent Heat Flux SLHF (accumulated) ------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: W/m2
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'LHFLX',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, SLH, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    !// Fluxes of zero cause grief with deposition, PBL.
-    !// SLH: set small value if zero.
-    do J = 1, JPAR
-       do I = 1, IPAR
-          if (SLH(I,J) .eq. 0._r8) SLH(I,J) = 1.e-30_r8
-       end do
-    end do
-    if (verbose) call gotData(FLD_ID,'2da','Sfc. lat. heat flux (SLH)')
-
-
-    !// Mean Sealevel Pressure (Diagnostic only - not in old 19-layer) -----
-    !// --------------------------------------------------------------------
-    !// Unit: Pa -> hPa
-    !call get_netcdf_var_2d(FNAME, 'MSLP',W2D, IPARW, JPARW)
-    !call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-    !     JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    !MSLP(:,:) = R8XY(:,:) * 1.e-2_r8
-    !if (verbose) call gotData(FLD_ID,'2di','MSLP')
-
-
-    !// Boundary Layer Height BLH ------------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: m
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'PBLH',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, BLH, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    !// Average BLH at poles
-    do J = 1, JPAR, JPAR-1
-       DMASS = 0._r8
-       do I = 1, IPAR
-          DMASS = DMASS + BLH(I,J)
-       end do
-       DMASS = DMASS / real(IPAR, r8)
-       do I = 1, IPAR
-          BLH(I,J) = DMASS
-       end do
-    end do
-    if (verbose) call gotData(FLD_ID,'2di','Boundary Layer Height (BLH)')
-
-
-    !// 10m U wind ---------------------------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: m/s
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'U10',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, SFU, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-
-    !// Use UMS and VMS at surface layer to decompose U10;
-    !// these are cos(angle) and sin(angle), and retains
-    !// the sign of wind speeds.
-    do J = 1, JPAR
-       do I = 1, IPAR
-          fU = UMS(1,I,J)/(sqrt(UMS(1,I,J)**2 + VMS(1,I,J)**2))
-          fV = VMS(1,I,J)/(sqrt(UMS(1,I,J)**2 + VMS(1,I,J)**2))
-          SFV(I,J) = SFU(I,J) * fV
-          SFU(I,J) = SFU(I,J) * fU
-       end do
-    end do
-
-    !// Combine polar pie pieces
-    if (verbose) call gotData(FLD_ID,'2di','10m U-wind (SFU)')
-    if (verbose) call gotData(FLD_ID,'2di','10m V-wind (SFV)')
-
-
-    !// 2m Temperature T2M -------------------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: K
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'TREFHT',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, SFT, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    if (minval(SFT) .eq. 0._r8) then
-       write(6,'(a)')  f90file//':'//subr//': SFT zero: VERY WRONG!'
-       stop
-    end if
-    if (verbose) call gotData(FLD_ID,'SFC','2m Temperature (SFT)')
-
-
-    !// 2m specific humidity (SFQ) -----------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: kg/kg
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'QREFHT',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, SFQ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-
-    if (verbose) call gotData(FLD_ID,'2di','2m specific humidity (SFQ)')
-
-
-    !// E/W Surface Stress EWSS (accumulated) ------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: N/m2
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'TAUX',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, EWSS, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    if (verbose) call gotData(FLD_ID,'2da','E/W sfc stress (EWSS)')
-
-
-    !// N/S Surface Stress NSSS (accumulated) ------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: N/m2
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'TAUY',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, NSSS, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    if (verbose) call gotData(FLD_ID,'2da','N/S sfc stress (NSSS)')
-
-    !// Friction velocity --------------------------------------------------
-    !// --------------------------------------------------------------------
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'USTAR',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, USTR, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    if (verbose) call gotData(FLD_ID,'2di','Surface friction velocity (USTR)')
-
-
-    !// Forecast Albedo ----------------------------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: fraction
-    call readnc_2d_from3d(FNAME3, 'lon',IPARW,'lat',JPARWNE1, &
-         'time',NMET,'ASDIR',inXY,silent=silent)
-
-    !// Combine polar pie pieces
-    call combinePPP(inXY(:,:),W2D(:,:),JPARWNE1,JPARW)
-    call TRUNG8(W2D, SA, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-    if (verbose) call gotData(FLD_ID,'2di','Forecast Albedo (SA)')
-
-
-    !// --------------------------------------------------------------------
-    !// Read some additional fields for DUST module
-    !// --------------------------------------------------------------------
-
-    !// Surface Solar Radiation Downwards (SSRD) ---------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: W/m2
-    !// CAM5: FSDS
-    if (LDUST) then
-!       call get_netcdf_var_2d(FNAME, 'SSRD',W2D, IPARW, JPARW)
-!       !// Limit to positive values just in case
-!       W2D(:,:) = max(W2D(:,:), 0._r8)
-!       call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-!            JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-!       R8XY(:,:) = R8XY(:,:) * ZDT
-!       call dust_set_ssrd(R8XY)
-!       if (verbose) call gotData(FLD_ID,'2da','Surface Solar Radiation Downwards (SSRD)')
-!    else
-       !// Surface Solar Radiation Downwards (SSRD) (accumulated)
-       if (verbose) call skipData(FLD_ID,'SFC','Surface Solar Radiation Downwards (SSRD)')
-    end if
-
-    !// Surface Thermal Radiation Downwards (STRD) ---------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: W/m2
-    !// CAM5: FLDS
-    if (LDUST) then
-!       call get_netcdf_var_2d(FNAME, 'STRD',W2D, IPARW, JPARW)
-!       !// Limit to positive values just in case
-!       W2D(:,:) = max(W2D(:,:), 0._r8)
-!       call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-!            JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-!       R8XY(:,:) = R8XY(:,:) * ZDT
-!       call dust_set_strd(R8XY)
-!       if (verbose) call gotData(FLD_ID,'2da','Surface Thermal Radiation Downwards (SSRD)')
-!    else
-       !// Surface Thermal Radiation Downwards (STRD) (accumulated)
-       if (verbose) call skipData(FLD_ID,'SFC','Surface Thermal Radiation Downwards (STRD)')
-    end if
-
-    !// Volumetric soil water layer 1 (SWVL1) ------------------------------
-    !// --------------------------------------------------------------------
-    !// Unit: m3/m3
-    !// NorESM: not available
-   if (LDUST) then
-!       call get_netcdf_var_2d(FNAME, 'SWVL1',W2D, IPARW, JPARW)
-!       !// Limit to positive values just in case
-!       W2D(:,:) = max(W2D(:,:), 0._r8)
-!       call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
-!            JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
-!       call dust_set_SWVL1(R8XY)
-!       if (verbose) call gotData(FLD_ID,'2di','Volumetric soil water layer 1 (SWVL1)')
-!    else
-!       !// Volumetric soil water layer 1 (SWVL1)
-       if (verbose) call skipData(FLD_ID,'SFC','Volumetric soil water layer 1 (SWVL1)')
-    end if
-
-
-
-
-    !// Other fields which may or may not be available ---------------------
-    !// --------------------------------------------------------------------
-    !// Snow Albedo (ASN)
-    if (verbose) call skipData(FLD_ID,'SFC','Snow Albedo (ASN)')
-    !// Snow Density (RSN)
-    if (verbose) call skipData(FLD_ID,'SFC','Snow Density (RSN)')
-    !// Sea Surface Temperature-Kelvin (SSTK)
-    if (verbose) call skipData(FLD_ID,'SFC','SSTK')
-    !// Ice surface temperature Layer 1 (ISTL1)
-    if (verbose) call skipData(FLD_ID,'SFC','ISTL1')
-    !// Ice surface temperature Layer 2 (ISTL2) 
-    if (verbose) call skipData(FLD_ID,'SFC','ISTL2')
-    !// Ice surface temperature Layer 3 (ISTL3) 
-    if (verbose) call skipData(FLD_ID,'SFC','ISTL3')
-    !// Ice surface temperature Layer 4 (ISTL4) 
-    if (verbose) call skipData(FLD_ID,'SFC','ISTL4')
-    !// Volumetric soil water layer 2 (SWVL2)
-    if (verbose) call skipData(FLD_ID,'SFC','SWVL2')
-    !// Volumetric soil water layer 3 (SWVL3)
-    if (verbose) call skipData(FLD_ID,'SFC','SWVL3')
-    !// Volumetric soil water layer 4 (SWVL4)
-    if (verbose) call skipData(FLD_ID,'SFC','SWVL4')
-    !// 10m wind gust
-    if (verbose) call skipData(FLD_ID,'SFC','10m wind gust')
-    !// Large-scale precipitation fraction (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Large-scale prec. frac.')
-    !// Downward UV radiation at the surface
-    if (verbose) call skipData(FLD_ID,'SFC','Downw. UV rad. sfc')
-    !// Convective available potential energy
-    if (verbose) call skipData(FLD_ID,'SFC','CAPE')
-    !// Total column liquid water
-    if (verbose) call skipData(FLD_ID,'SFC','Tot. col. liq. water')
-    !// Total column ice water
-    if (verbose) call skipData(FLD_ID,'SFC','Tot. col. ice water')
-    !// Surface Geopotential (Z)
-    if (verbose) call skipData(FLD_ID,'SFC','Sfc. geopot. (Z)')
-    !// Total Column Water (TCW)
-    if (verbose) call skipData(FLD_ID,'SFC','Tot. col. water')
-    !// Total Column Water Vapor (TCWV)
-    if (verbose) call skipData(FLD_ID,'SFC','Tot. col. water vap.')
-    !// Soil Temperature Level 1 (STL1)
-    if (verbose) call skipData(FLD_ID,'SFC','Soil temp. lev. 1')
-    !// Surface stress (eller Charnock)
-    if (verbose) call skipData(FLD_ID,'SFC','Sfc stress/Charnock')
-    !// Boundary Layer Dissipation (BLD) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Boundary Layer Dissipation')
-    !// Total Cloud Cover
-    if (verbose) call skipData(FLD_ID,'SFC','Tot. cloud cover')
-    !// Soil Temperature Level 2 (STL2)
-    if (verbose) call skipData(FLD_ID,'SFC','Soil temp. lev. 2')
-    !// Land/Sea mask (LSM), NOTE: {0,1}
-    !// Not so useful; it is 1 if land fraction > 0.5.
-    if (verbose) call skipData(FLD_ID,'SFC','Land/sea mask')
-    !// Surface Thermal Radiation Downwards (STRD) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Sfc. thermal rad. downwards')
-    !// Surface Solar Radiation (SSR) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Sfc. solar rad.')
-    !// Surface Thermal Radiation (STR) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Sfc. thermal rad.')
-    !// Top Solar Radiation (TSR) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Top Solar Radiation (TSR)')
-    !// Top Thermal Radiation (TTR) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Top Thermal Radiation (TTR)')
-    !// Evaporation (E) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Evaporation')
-    !// Soil Temperature Level 3 (STL3)
-    if (verbose) call skipData(FLD_ID,'SFC','Soil temp. lev. 3')
-    !// Soil Wetness Level 3 (SWL3)
-    if (verbose) call skipData(FLD_ID,'SFC','Soil wetness level 3')
-    !// Convective Cloud Cover (CCC)
-    if (verbose) call skipData(FLD_ID,'SFC','Convective cloud cover')
-    !// Low Cloud Cover (LCC)
-    if (verbose) call skipData(FLD_ID,'SFC','Low cloud cover')
-    !// Medium Cloud Cover (MCC)
-    if (verbose) call skipData(FLD_ID,'SFC','Medium cloud cover')
-    !// High Cloud Cover (HCC)
-    if (verbose) call skipData(FLD_ID,'SFC','High cloud cover')
-    !// Sun Shine Duration (SUND) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','Sunshine duration')
-    !// Latitudinal Gravity Wave Stress (LGWS) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','LGWS')
-    !// Meridional Gravity Wave Stress (MGWS)
-    if (verbose) call skipData(FLD_ID,'SFC','MGWS')
-    !// Gravity Wave Dissipation (GWD)
-    if (verbose) call skipData(FLD_ID,'SFC','GWD')
-    !// Skin Reservoir Content (SRC)
-    if (verbose) call skipData(FLD_ID,'SFC','Skin Reservoir Content (SRC)')
-    !// Maximum Temperature at 2m (MX2T)
-    if (verbose) call skipData(FLD_ID,'SFC','MX2T')
-    !// Minimum Temperature at 2m (MN2T)
-    if (verbose) call skipData(FLD_ID,'SFC','MN2T')
-    !// RunOff (RO)
-    if (verbose) call skipData(FLD_ID,'SFC','RunOff')
-    !// Top Net Solar Radiation Clear Sky (TSRC) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','TSRC')
-    !// Top Net Thermal Radiation Clear Sky (TTRC) (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','TTRC')
-    !// Surface net solar radiation, clear sky (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','SNSRCS')
-    !// Surface net thermal radiation, clear sky (accumulated)
-    if (verbose) call skipData(FLD_ID,'SFC','SNTRCS')
-    !// Log Surface roughness for Heat
-    if (verbose) call skipData(FLD_ID,'SFC','Log(sfc. roughness for heat)')
-    !// Skin Temperature (SKT)
-    if (verbose) call skipData(FLD_ID,'SFC','Skin Temperature (SKT)')
-    !// Soil Temperature Level 4 (STL4)
-    if (verbose) call skipData(FLD_ID,'SFC','Soil temp. lev. 4')
-    !// Temperature of Snow Layer (TSN)
-    if (verbose) call skipData(FLD_ID,'SFC','Temperature of snow layer')
-    !// Forecast Surface Roughness (FSR) 
-    if (verbose) call skipData(FLD_ID,'SFC','Forecast sfc. roughness')
-    !// Forecast Log(Surface Roughness Heat)
-    if (verbose) call skipData(FLD_ID,'SFC','Forecast log(Sfc. roughness heat)')
-
-
-
-
-
-    !// Additional calculations
-    !//---------------------------------------------------------------------
-
-    !// USTAR from Surface Stress NSSS and EWSS
-    do J = 1, JPAR
-      do I = 1, IPAR
-        SMF(I,J) = sqrt(NSSS(I,J)*NSSS(I,J) + EWSS(I,J)*EWSS(I,J))
-        !// ideal gas density [kg/m3]
-        SDEN      = M_AIR * 100._r8*P(I,J) / (R_UNIV * 1.e3_r8 * SFT(I,J))
-        USTR(I,J) = sqrt(SMF(I,J)/SDEN)
-        if (USTR(I,J) .eq. 0._r8) then
-          !// When zero, override with minimum value
-          USTR(I,J) = max(5.e-3_r8, USTR(I,J))
-          !// Also override SMF
-          SMF(I,J) = (USTR(I,J)**2) * SDEN
-        end if
-      end do
-    end do
-
-    !// Filter fluxes for wrong signs etc.
-    !call fluxfilter2(cdetu, cdetd)
-
-    !// Put low level limits to CLDFR, CLDLWC, and CLDIWC, and set junk
-    !// values to zero.
-    do L = 1, LWEPAR
-      do J = 1, JPAR
-        do I = 1, IPAR
-          if (CLDFR(I,J,L) .gt. EPS) then
-            CLDLWC(I,J,L) = CLDLWC(I,J,L) / CLDFR(I,J,L)
-            CLDIWC(I,J,L) = CLDIWC(I,J,L) / CLDFR(I,J,L)
-
-            call CIWMIN(T(I,J,L), CLDLWC(I,J,L), CLDIWC(I,J,L))
-
-            CLDLWC(I,J,L) = CLDLWC(I,J,L) * CLDFR(I,J,L)
-            CLDIWC(I,J,L) = CLDIWC(I,J,L) * CLDFR(I,J,L)
-          else
-            CLDFR(I,J,L) = 0._r8
-            call CFRMIN(T(I,J,L), CLDFR(I,J,L), CLDLWC(I,J,L), &
-                        CLDIWC(I,J,L), EPS)
-          end if
-        end do
-      end do
-    end do
-
-    !// Done reading all meteorological data
-    deallocate( VTMP, UTMP, W3Da, W3Db, ZOFLEW, QW, TW, R8XYZ, &
-         CLDFRW, CLDIWCW, CLDLWCW, &
-         PW, LSPREC, CNVPREC, EWSS, NSSS, W2D, R8XY, &
-         inXYZ, inXYm1Z, inXYZp1, inXY, inXY_b )
-
-    !//---------------------------------------------------------------------
-  end subroutine update_metdata
-  !//-----------------------------------------------------------------------
-
-
-
-  !//-----------------------------------------------------------------------
-  subroutine fluxfilter2(cdetu,cdetd)
-    !//---------------------------------------------------------------------
-    !// Filter convective mass fluxes.
-    !// Based on filtering in p-wind_ec.f.
-    !//
-    !// Ole Amund Sovde, March 2015, March 2010
-    !//---------------------------------------------------------------------
-    use cmn_precision, only: r8
-    use cmn_size, only: IPAR, JPAR, LWEPAR, LWDPAR
-    use cmn_met, only: CENTU, CENTD, CWETE, CWETD
-    !//---------------------------------------------------------------------
-    !// Input
-    real(r8), intent(inout) :: cdetu(ipar,jpar,lwepar)
-    real(r8), intent(inout) :: cdetd(ipar,jpar,lwdpar)
-
-    !// Local variables
-    real(r8) :: sden
-    integer :: KCTOP(ipar,jpar), KDBOT(ipar,jpar), i,j,l,LL
-    !//---------------------------------------------------------------------
-
-    !// CWETE and CWETD are already filtered for wrong signs.
-    !// There may still be some places where a grid box have
-    !// flux, but there is none above or below. This is a bit strange,
-    !// but fairly ok; such a small convective flux will then be
-    !// detrained above. No need to filter these away.
-
-    !// CDETU and CDETD are also already filtered for wrong signs.
-
-
-    !// More CDETU and CDETD filters
-
-    !// Find top of convection
-    KCTOP(:,:) = 1
-    do J = 1, JPAR
-       do I = 1, IPAR
-          do L = LWEPAR-1,1,-1
-             !// Loop downwards
-             if (CWETE(i,j,l) .gt. 0._r8) then
-                KCTOP(i,j) = L
-                exit
-             else
-                !// No flux; no detrainment
-                cdetu(i,j,l) = 0._r8
-             end if
-          end do
-       end do
-    end do
-
-    !// Find bottom of downdrafts
-    KDBOT(:,:) = LWDPAR-1
-    do J = 1,JPAR
-       do I = 1, IPAR
-          do L = 1, LWDPAR-1
-             !// Loop downwards
-             if (cwetd(i,j,l+1) .lt. 0._r8) then
-                !// Mass comes in at top
-                KDBOT(i,j) = L
-                exit
-             else
-                !// No flux in at top; no detrainment
-                cdetd(i,j,l) = 0._r8
-             end if
-          end do
-       end do
-    end do
-
-    !// Detrainment cannot be larger than flux in at bottom
-    do J = 1,JPAR
-       do I = 1, IPAR
-          do l = 1, KCTOP(I,J)
-             !// Loop downwards; cdetu and cwete are non-negative
-             !// due to filtering above
-             if (cdetu(i,j,l) .gt. cwete(i,j,l)) then
-                !// CDETU cannot be larger than the flux in!
-                if (cwete(i,j,l) .eq. 0._r8) then
-                   CDETU(I,J,L) = 0._r8
-                else
-                   CDETU(i,j,l) = CWETE(i,j,l)
-                end if
-             end if
-          end do
-       end do
-    end do
-
-    !// Detrainment cannot be larger than flux in at top
-    do J = 1,JPAR
-       do I = 1, IPAR
-          !// Make sure top is zero
-          CDETD(i,j,LWDPAR) = 0._r8
-          do L = LWDPAR-1, KDBOT(I,J), -1
-             !// Loop downwards; cdetd is non-negative and cwetd is
-             !// non-positive due to filtering above
-             if (CDETD(i,j,l) .gt. -CWETD(i,j,l+1)) then
-                if (CWETD(i,j,l+1) .lt. 0._r8) then
-                   CDETD(i,j,l) = -CWETD(i,j,l+1)
-                else
-                   CDETD(i,j,l) = 0._r8
-                end if
-             end if
-          end do
-       end do
-    end do
-
-    !// FINALLY
-    !// Build entrainment - updrafts (detrainment is positive)
-    do J = 1,JPAR
-       do I = 1, IPAR
-          do L = 1, KCTOP(I,J)
-             !// F(L) + E = F(L+1) + D
-             sden = cwete(i,j,l+1) - cwete(i,j,l) + cdetu(i,j,l)
-             !// Only allow positive entrainment
-             centu(i,j,l) = max(0._r8, sden)
-          end do
-       end do
-    end do
-    !// Build entrainment - downdrafts (flux is negative)
-    do L = 1, LWDPAR-1
-       do J = 1, JPAR
-          do I = 1, IPAR
-             !// -F(L+1) + E = -F(L) + D
-             sden = cwetd(i,j,l+1) - cwetd(i,j,l) + cdetd(i,j,l)
-             !// Only allow positive entrainment
-             centd(i,j,l) = max(0._r8, sden)
-          end do
-       end do
-    end do
-
-    !//---------------------------------------------------------------------
-  end subroutine fluxfilter2
-  !//-----------------------------------------------------------------------
-
-
-  !//-----------------------------------------------------------------------
-  subroutine fluxfilter_ENT()
-    !//---------------------------------------------------------------------
-    !// Filter convective mass fluxes.
-    !// Based on filtering in p-wind_ec.f.
-    !//
-    !// Amund Sovde, Novemeber 2014
-    !//---------------------------------------------------------------------
-    use cmn_precision, only: r8
-    use cmn_size, only: IPAR, JPAR, LWEPAR, LWDPAR
-    use cmn_met, only: CENTU, CENTD, CWETE, CWETD
-    use cmn_ctm, only: AREAXY
-    !//---------------------------------------------------------------------
-    implicit none
-    !// Input: none
-
-    !// Local variables
-    real(r8) :: sden
-    integer :: KCTOP(ipar,jpar), KDBOT(ipar,jpar), i,j,l,LL
-    !//---------------------------------------------------------------------
-
-    ! Remove noise and wrong sign convections
-    ! Noise filter for CWETE
-    !   the min cwete is -2.3e-5 kg/s/m^2, the neg fluxes are often seen as
-    !  'dipoles' with an equally small positive updraft flux in a neighboring layer
-    do l = 1, lwepar
-       do j = 1,jpar
-          do i = 1,ipar
-             sden = cwete(i,j,l) / areaxy(i,j)
-             if (sden .lt. 2.3e-5_r8) cwete(i,j,l) = 0._r8
-          enddo
-       enddo
-    enddo
-    !// Add more filter for boxes where the box above and below have no flux 
-    do l = 2,lwepar-1
-       do j = 1,jpar
-          do i = 1,ipar
-             if (cwete(i,j,l-1).eq.0._r8 .and. cwete(i,j,l).gt.0._r8 &
-                  .and.cwete(i,j,l+1).eq.0._r8) then
-                !// Some boxes have flux, but no flux below. Filter these
-                !// if smaller than 2.d-4
-                sden = CWETE(i,j,l) / areaxy(i,j)
-                if (sden .lt. 2.e-4_r8) cwete(i,j,l) = 0._r8
-             endif
-          enddo
-       enddo
-    enddo
-
-    ! Noise filter for CWETD
-    !  the max cwetd is 7.1e-6 kg/s/m^2, the + fluxes are often seen as 'dipoles'
-    !  with an equally small negative downdraft flux in a neighboring layer
-    do l = 1,lwdpar
-       do j = 1,jpar
-          do i = 1,ipar
-             sden = cwetd(i,j,l) / areaxy(i,j)
-             if (sden .gt. -7.1e-6_r8) cwetd(i,j,l) = 0._r8
-          enddo
-       enddo
-    enddo
-    !// Add more filter for boxes where the box above and below have no flux 
-    do l = 2,lwdpar-1
-       do j = 1,jpar
-          do i = 1,ipar
-             if (cwetd(i,j,l-1).eq.0._r8 .and. cwetd(i,j,l).lt.0._r8 &
-                  .and.cwetd(i,j,l+1).eq.0._r8) then
-                sden = cwetd(i,j,l) / areaxy(i,j)
-                if (sden .gt. -1.d-5) cwetd(i,j,l) = 0._r8
-             endif
-          enddo
-       enddo
-    enddo
-
-    !Noise filter for CENTU
-    do l = 1,lwepar
-       do j = 1,jpar
-          do i = 1,ipar
-             sden = centu(i,j,l) / areaxy(i,j)
-             if (sden .lt. 2.3e-5_r8) centu(i,j,l) = 0._r8
-          enddo
-       enddo
-    enddo
-
-    !Noise filter for CENTD
-    do l = 1,lwdpar
-       do j = 1,jpar
-          do i = 1,ipar
-             sden = centd(i,j,l) / areaxy(i,j)
-             if (sden .lt. 7.1e-6_r8) centd(i,j,l) = 0._r8
-          enddo
-       enddo
-    enddo
-
-    !more filter for updrafts/downdrafts
-
-    !// Find top of convection
-    KCTOP(:,:) = 1
-    do j = 1,jpar
-       do i = 1,ipar
-          do l = lwepar-1,1,-1
-             !// Loop downwards
-             if (cwete(i,j,l).gt. 0._r8) then
-                KCTOP(i,j) = L
-                exit
-             else
-                !// No flux; no entrainment
-                centu(i,j,l) = 0._r8
-             endif
-          enddo
-       enddo
-    enddo
-
-    !// Find bottom of downdrafts
-    KDBOT(:,:) = LWDPAR-1
-    do j = 1,jpar
-       do i = 1,ipar
-          do l = 1,lwdpar-1
-             !// Loop downwards
-             if (cwetd(i,j,l+1).lt. 0._r8) then
-                !// Mass comes in at top
-                KDBOT(i,j) = L
-                exit
-             else
-                !// No flux in at top; no entrainment
-                centd(i,j,l) = 0._r8
-             endif
-          enddo
-       enddo
-    enddo
-
-    !//---------------------------------------------------------------------
-  end subroutine fluxfilter_ENT
-  !//-----------------------------------------------------------------------
-
-
-
-
-  !//-----------------------------------------------------------------------
-  subroutine data2mpblocks(r8data, mpdata)
-    !//---------------------------------------------------------------------
-    !// Puts real*8 data of size (ipar,jpar) into real*8 MP-block structure
-    !// mpdata(idblk,jdblk,mpblk).
-    !//
-    !// Ole Amund Sovde, April 2013
-    !//---------------------------------------------------------------------
-    use cmn_precision, only: r8
-    use cmn_size, only: IPAR, JPAR, IDBLK, JDBLK, MPBLK
-    use cmn_ctm, only: MPBLKIB, MPBLKIE, MPBLKJB, MPBLKJE
-    !//---------------------------------------------------------------------
-    implicit none
-    !//---------------------------------------------------------------------
-    !// Input
-    real(r8), intent(in) :: r8data(ipar,jpar)
-    !// Output
-    real(r8), intent(out) :: mpdata(idblk,jdblk,mpblk)
-    !// Locals
-    integer :: I, J, II, JJ, MP
-    !//---------------------------------------------------------------------
-    do MP = 1, MPBLK
-      !// Loop over latitude (J is global, JJ is block)
-      do J = MPBLKJB(MP),MPBLKJE(MP)
-        JJ    = J - MPBLKJB(MP) + 1
-        !// Loop over longitude (I is global, II is block)
-        do I = MPBLKIB(MP),MPBLKIE(MP)
-          II    = I - MPBLKIB(MP) + 1
-          !// Change structure
-          mpdata(II,JJ,MP) = r8data(I,J)
-        end do
-      end do
-    end do
-    !//---------------------------------------------------------------------
-  end subroutine data2mpblocks
-  !//-----------------------------------------------------------------------
-
-
-
-  !//-----------------------------------------------------------------------
-  subroutine gotData(ID,TYP,LABEL)
-    !//---------------------------------------------------------------------
-    !// Print info about 2D field read.
-    !//---------------------------------------------------------------------
-    implicit none
-    !//---------------------------------------------------------------------
-    integer, intent(in) :: ID
-    character(len=3) :: TYP
-    character(len=*) :: LABEL
-    !//---------------------------------------------------------------------
-    write(6,'(a,i5,1x,a)') ' update_metdata: Read '//TYP//':   ', &
-         ID, trim(LABEL)
-    !//---------------------------------------------------------------------
-  end subroutine gotData
-  !//-----------------------------------------------------------------------
-
-  !//-----------------------------------------------------------------------
-  subroutine skipData(ID,TYP,LABEL)
-    !//---------------------------------------------------------------------
-    !// Print info about 2D field skipped.
-    !//---------------------------------------------------------------------
-    implicit none
-    !//---------------------------------------------------------------------
-    integer, intent(in) :: ID
-    character(len=3) :: TYP
-    character(len=*) :: LABEL
-    !//---------------------------------------------------------------------
-    write(6,'(a,i5,1x,a)') ' update_metdata: Skipped '//TYP//':', &
-         ID,trim(LABEL)
-    !//---------------------------------------------------------------------
-  end subroutine skipData
-  !//-----------------------------------------------------------------------
-
-
-
-  !//-----------------------------------------------------------------------
-  subroutine combinePPP(inXY,wkXY,Jin,Jout)
-    !//---------------------------------------------------------------------
-    !// Combines the NorESM polar pie piece boxes with their Equator-
-    !// ward neighbor boxes.
-    !// Amund Sovde, November 2014
-    !//---------------------------------------------------------------------
-    use cmn_size, only: IPARW
-    use cmn_precision, only: r8, r4
-    use cmn_ctm, only: AREAXY
-    !//---------------------------------------------------------------------
-    implicit none
-    !//---------------------------------------------------------------------
-    !// Input
-    integer, intent(in) :: Jout,Jin !// Jin should be Jout+2
-    real(r8), intent(in)  :: inXY(IPARW,Jin)
-    !// Output
-    real(r8), intent(out) :: wkXY(IPARW,Jout)
-    !// Locals
-    integer :: I,J
-    real(r8) :: APP, APN
-    !//---------------------------------------------------------------------
-
-    !// Will use area as weighting function (equal in EW-direction)
-    APP = areaxy(1,1) !// Pole (same for NH as SH)
-    APN = areaxy(1,2) !// Neighbor equatorwards (same for NH as SH)
-
-    !// SH polar pie box
-    do I = 1, IPARW
-       wkXY(I,1) = (APP*inXY(I,1) + APN*inXY(I,2)) /(APP+APN)
-    end do
-    !// NH polar pie box
-    do I=1,IPARW
-       wkXY(I,Jout) = (APP*inXY(I,Jin) + APN*inXY(I,Jin-1)) / (APP+APN)
-    end do
-    !// The rest of the boxes
-    do J = 2, Jout-1
-       do I = 1, IPARW
-          wkXY(I,J) = inXY(I,J+1)
-       end do
-    end do
-    !//---------------------------------------------------------------------
-  end subroutine combinePPP
-  !//-----------------------------------------------------------------------
-
-
-
-  !//-----------------------------------------------------------------------
-end module metdata_noresm
-!//=========================================================================
Index: c3run.job
===================================================================
--- c3run.job	(.../ctm3f90)	(revision 243)
+++ c3run.job	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,113 +0,0 @@
-#!/bin/bash
-# Script for running on Abel.
-# --------------------------------------------------------------------------
-# Job name:
-#SBATCH --job-name=C3RUN
-#
-# Project:
-#SBATCH --account=<account name>
-#
-# Wall clock limit:
-#SBATCH --time=150:0:0
-#
-# Does your job exceed one week, use "--partition=long":
-# ####SBATCH --partition=long
-#
-# Max memory usage:
-#SBATCH --mem-per-cpu=1450M
-#
-# Number of cores:
-#SBATCH --ntasks-per-node=16
-#
-# Number of nodes:
-#SBATCH --nodes=1
-#
-#
-## Set up job environment
-source /cluster/bin/jobsetup
-# --------------------------------------------------------------------------
-# No need to change this section
-
-# Must set large stack size (unlimited for simplicity)
-ulimit -s unlimited
-# Set ulimit also to unlimited (probably not necessary)
-ulimit unlimited
-# Print out information about ulimit
-ulimit -a
-
-# allocate specified memory to each thread (100M)
-export THREAD_STACKSIZE=300m
-#   ifort uses KMP_STACKSIZE
-export KMP_STACKSIZE=$THREAD_STACKSIZE
-
-# number of OpenMP threads - i.e. number of CPUs requested
-export OMP_NUM_THREADS=$SLURM_NTASKS_PER_NODE
-
-# the PID number is first the date then an uniqe shell pid
-export PID=`date +"%d%m%y".$$`
-
-
-
-# Model input data
-export INPUT_DATA=/work/projects/cicero/ctm_input/Indata_CTM3
-
-# --------------------------------------------------------------------------
-# Do changes here
-
-# Model dir - enter your directory here
-export MODELDIR=$HOME/CTM3_DIR
-
-# Scenario name (use job name or whatever you like)
-export SCEN=$SLURM_JOB_NAME
-
-# Result directory (where your files end up)
-export RESULTDIR=$HOME/DONE.$SCEN
-
-# Set input file name
-export INPUTFILE=L60CTM.inp
-
-# Name of main program
-export PROGFILE=osloctm3
-
-# Job file (this file)
-export JOBFILE=c3run.job
-# Restart file is set below
-
-
-# ...Flytt programmet og tilhrende filer til work omrdet
-cp $MODELDIR/$PROGFILE         $SCRATCH/osloctm3
-cp $MODELDIR/$INPUTFILE        $SCRATCH/
-cp -r $MODELDIR/tables         $SCRATCH/
-ln -fs $INPUT_DATA             $SCRATCH/
-#   CTM3 restart
-cp -r ctm3_restartfile.sav     $SCRATCH/restart.sav
-# if e90-tracer is used, may need restart file
-cp $INPUT_DATA/restart_e90.sav $SCRATCH/
-
-
-# Go to work directory
-cd $SCRATCH
-
-# Run command
-./osloctm3 < $INPUTFILE > results.$PID
-
-
-## Make the result directory
-mkdir $RESULTDIR
-echo 'Program completed, copy to '$RESULTDIR
-# Copy files to result directory
-cp results.$PID     $RESULTDIR/
-cp avgsav*          $RESULTDIR/
-# copy restart file
-#cp restrt0036*          $RESULTDIR/
-cp *dta             $RESULTDIR/
-cp *.dat            $RESULTDIR/
-cp OSLO/Ltracer*    $RESULTDIR/
-cp *.inp            $RESULTDIR/
-cp *.job            $RESULTDIR/
-
-echo 'Results copied to '$RESULTDIR
-
-# Done
-# --------------------------------------------------------------------------
-
Index: L60CTM.inp
===================================================================
--- L60CTM.inp	(.../ctm3f90)	(revision 243)
+++ L60CTM.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,251 +0,0 @@
-=== Oslo CTM3 v1.0 w/Oslo chemistry and EC met fields ===
---------------------------------------------------------------------------------
- 2000  IYEAR = reference year to which NDAI/NDAYE are offset
-    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
-  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
---------------------------------------------------------------------------------
-    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
-    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
-    T  LCLDRANA = Random selected from all cloud cover ICAs                    
-    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
-   66  RANSEED
-    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
-    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
-    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
-0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
-----Meteorological data: File name will be built from following info------------
-ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
-   38    1       met data cycle & revision number
-'/work/projects/cicero/ctm_input/metdataOpenIFS/'                 met data root
-    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
-    T  LFIXMET = annually recycle met field (do not allow leap year)           
-    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
-  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
-----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
-    L  LMMAP      eta-A            eta-B
-    1    1      0.000000000000   1.000000000000
-    2    2      0.000000000000   0.997630120000
-    3    3      7.367743000000   0.994019450000
-    4    4     65.889244000000   0.988270100000
-    5    5    210.393890000000   0.979662720000
-    6    6    467.333588000000   0.967645230000
-    7    7    855.361755000000   0.951821510000
-    8    8   1385.912598000000   0.931940320000
-    9    9   2063.779785000000   0.907883880000
-   10   10   2887.696533000000   0.879656910000
-   11   11   3850.913330000000   0.847374920000
-   12   12   4941.778320000000   0.811253430000
-   13   13   6144.314941000000   0.771596610000
-   14   14   7438.803223000000   0.728785810000
-   15   15   8802.356444999999   0.683268610000
-   16   16  10209.500977000000   0.635547460000
-   17   17  11632.758789000000   0.586168410000
-   18   18  13043.218750000000   0.535709920000
-   19   19  14411.124023000000   0.484771580000
-   20   20  15706.447265999999   0.433962940000
-   21   21  16899.468750000000   0.383892150000
-   22   22  17961.357422000001   0.335154890000
-   23   23  18864.750000000000   0.288322960000
-   24   24  19584.330077999999   0.243933140000
-   25   25  20097.402343999998   0.202475940000
-   26   26  20384.480468999998   0.164384320000
-   27   27  20429.863281000002   0.130022510000
-   28   28  20222.205077999999   0.099674690000
-   29   29  19755.109375000000   0.073533830000
-   30   30  19027.695313000000   0.051690410000
-   31   31  18045.183593999998   0.034121160000
-   32   32  16819.474609000001   0.020677880000
-   33   33  15379.805664000000   0.011142910000
-   34   34  13775.325194999999   0.005081120000
-   35   35  12077.446289000000   0.001815160000
-   36   36  10376.126953000001   0.000461390000
-   37   37   8765.053711000000   0.000075820000
-   38   38   7306.631348000000   0.000000000000
-   39   39   6018.019531000000   0.000000000000
-   40   40   4906.708496000000   0.000000000000
-   41   41   3960.291504000000   0.000000000000
-   42   42   3196.421631000000   0.000000000000
-   43   43   2579.888672000000   0.000000000000
-   44   44   2082.273926000000   0.000000000000
-   45   45   1680.640259000000   0.000000000000
-   46   46   1356.474609000000   0.000000000000
-   47   47   1094.834717000000   0.000000000000
-   48   48    883.660522000000   0.000000000000
-   49   49    713.218079000000   0.000000000000
-   50   50    575.651001000000   0.000000000000
-   51   51    464.618134000000   0.000000000000
-   52   52    373.971924000000   0.000000000000
-   53   53    298.495789000000   0.000000000000
-   54   54    234.779053000000   0.000000000000
-   55   55    180.584351000000   0.000000000000
-   56   56    134.483307000000   0.000000000000
-   57   57     95.636963000000   0.000000000000
-   58   58     63.647804000000   0.000000000000
-   59   59     38.425343000000   0.000000000000
-   60   60     20.000000000000   0.000000000000
-   61   61      2.000000000000   0.000000000000
-PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
-    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
-    0  NDPX dry deposition scheme, now only simple version = 0
-    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
-----file names for further data-------------------------------------------------
-'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
---- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
-    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
- 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
-'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
---- Roughness length (ZOI) ---
- 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
-'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
---- Leaf area index ---
- 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
-'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
---- tracer specific section ---
- T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
---- species information / tracer list --- read from the following file
-'tables/tracer_list_nitrate.d'
---- General multi-species wet scavenging data set:  call WETSET_CTM3
-'tables/scavenging_wet.inp'            WET deposition data set
---- General multi-species dry scavenging data set:  call DRYSET_CTM3
-'tables/scavenging_dry.inp'            DRY deposition data set
---- Emission list ---
-'tables/Ltracer_emis_ceds17_2000.inp'    See ./tables/ for more
---------------------------------------------------------------------------------
-===== CONT = write restart (Continuation) file (unformatted)
-     123456789.123456789.123456789.1              JDO_C
-JAN _1000000000000000000000000000000  001 - 031
-FEB _00000000000000000000000000000    032 - 060
-MAR _0000000000000000000000000000000  061 - 091
-APR _000000000000000000000000000000   092 - 121
-MAY _0000000000000000000000000000000  122 - 152
-JUN _000000000000000000000000000000   153 - 182
-JUL _0000000000000000000000000000000  183 - 213
-AUG _0000000000000000000000000000000  214 - 244
-SEP _000000000000000000000000000000   245 - 274
-OCT _0000000000000000000000000000000  275 - 305
-NOV _000000000000000000000000000000   306 - 335
-DEC _0000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== BUDGET tendencies calendar (unf + some form output)
-     123456789.123456789.123456789.1              JDO_T
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-    8 # CATEGORIES for tendency budgets
-    1 = SOURCE
-    2 = BNDLYR
-    3 = DRYDEP
-    4 = UV_ADV
-    5 = W_ADV_
-    6 = LSSCAV
-    7 = CHEMIS
-    8 = CNSCAV
-Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
-1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
-box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
-box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
-box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
-box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
-box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
-box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
-box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
-box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
-box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
-box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
-box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
-box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
---------------------------------------------------------------------------------
-===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
-     123456789.123456789.123456789.1             JDO_A
-JAN _2000000000000000000000000000000  001 - 031
-FEB _20000000000000000000000000000    032 - 060
-MAR _2000000000000000000000000000000  061 - 091
-APR _200000000000000000000000000000   092 - 121
-MAY _2000000000000000000000000000000  122 - 152
-JUN _200000000000000000000000000000   153 - 182
-JUL _2000000000000000000000000000000  183 - 213
-AUG _2000000000000000000000000000000  214 - 244
-SEP _200000000000000000000000000000   245 - 274
-OCT _2000000000000000000000000000000  275 - 305
-NOV _200000000000000000000000000000   306 - 335
-DEC _2000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== STE-flux output                            JDO_X
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
-1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
---------------------------------------------------------------------------------
-==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-statn  1  Alert          82.45   -1.20   LAT/LNG
-statn  2  Pt. Barrow     71.32 -156.61
-statn  3  Rorvik         57.00   12.00
-statn  4  Mace Head      53.32   -9.88
-statn  5  Hohenpssnb     47.48   11.01
-statn  6  Payerne        46.82    6.95
-statn  7  Harvard Fo     43.00  -79.00
-statn  8  Niwot Ridg     40.04 -105.58
-statn  9  Azores         38.75   27.08
-statn 10  Wallops Is     37.90  -75.50
-statn 11  Bermuda        32.00  -64.00
-statn 12  Mauna Loa      19.54 -155.58
-statn 13  Cp. Kumaka     19.54 -155.58
-statn 14  Barbados       13.17  -59.43
-statn 15  Natal          -5.92  -35.17
-statn 16  Ascension      -7.98  -14.42
-statn 17  Amazon        -10.00  -50.00
-statn 18  Am. Samoa     -14.23  170.56
-statn 19  Cuiaba        -15.60  -56.10
-statn 20  Cape Grim     -40.41  144.69
-statn 21  Neumayer      -70.00   -8.00
-statn 22  South Pole    -90.00     .00
-statn 23  Taibei         25.03  121.52
-statn 24  Tokyo          35.68  139.77
-statn 25  Guam           13.22  145.33
-statn 26  Shemya         52.92  174.06
-statn 27  Mauna Loa      19.53 -155.58
-statn 28  Anchorage      61.17 -150.02
-statn 29  San Frans      37.62 -122.38
-statn 30  Quito           0.22  -78.53
--------Stations local time diags------------------------------------------------
-    0 stations for local time diag. LT may be adjusted to fit at least one pnt
--------Tracers for local time diags at stations---------------------------------
-    0     # of tracer global local time diag. LT may be adjusted
---------------------------------------------------------------------------------
Index: LnorESM.inp
===================================================================
--- LnorESM.inp	(.../ctm3f90)	(revision 243)
+++ LnorESM.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,223 +0,0 @@
-=== Oslo CTM3 v2015.01 w/Oslo chemistry and EC met fields ===
---------------------------------------------------------------------------------
- 2000  IYEAR = reference year to which NDAI/NDAYE are offset
-    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
-    5  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
---------------------------------------------------------------------------------
-    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
-    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
-    T  LCLDRANA = Random selected from all cloud cover ICAs                    
-    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
-   66  RANSEED
-    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
-    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
-    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
-0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
-----Meteorological data: File name will be built from following info------------
-norESM           met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
-    2    1       met data cycle & revision number
-'/div/amoc/metdata/NorESM2/EVA_OCN_REF/'
-    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
-    T  LFIXMET = annually recycle met field (do not allow leap year)           
-    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
-  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
-----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
-    L  LMMAP      eta-A            eta-B
-    1    1      0.000000000000   1.000000000000
-    2    2      0.000000000000   0.985112190247
-    3    3    397.881805419922   0.963559806347
-    4    4    853.108886718750   0.938901245594
-    5    5   1361.802734375000   0.911346435547
-    6    6   1919.673706054688   0.881127893925
-    7    7   2522.121826171875   0.848494648933
-    8    8   3164.267822265625   0.813710987568
-    9    9   4273.463867187500   0.753628432751
-   10   10   5765.894042968750   0.672786951065
-   11   11   7534.445312500000   0.576988518238
-   12   12   9461.385742187500   0.472610563040
-   13   13  11387.556640625000   0.368274360895
-   14   14  13024.831054687500   0.279586911201
-   15   15  14416.541015625000   0.204201176763
-   16   16  15599.515625000000   0.140122056007
-   17   17  16605.066406250000   0.085653759539
-   18   18  17459.798828125000   0.039354827255
-   19   19  18186.335937500000   0.000000000000
-   20   20  15458.680664062500   0.000000000000
-   21   21  13140.126953125000   0.000000000000
-   22   22  11169.321289062500   0.000000000000
-   23   23   9494.104492187500   0.000000000000
-   24   24   8070.141601562500   0.000000000000
-   25   25   6332.348144531250   0.000000000000
-   26   26   4586.747558593750   0.000000000000
-   27   27   3066.912353515625   0.000000000000
-   28   28   1855.531738281250   0.000000000000
-   29   29   1015.794738769531   0.000000000000
-   30   30    503.169189453125   0.000000000000
-   31   31    225.523956298828   0.000000000000
-PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
-    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
-    0  NDPX dry deposition scheme, now only simple version = 0
-    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
-----file names for further data-------------------------------------------------
-'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
---- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
-    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
- 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
-'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
---- Roughness length (ZOI) ---
- 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
-'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
---- Leaf area index ---
- 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
-'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
---- tracer specific section ---
- T  0    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
---- species information / tracer list --- read from the following file
-'tables/tracer_list_all_soa.d'
---- General multi-species wet scavenging data set:  call WETSET_CTM3
-'tables/scavenging_wet.inp'            WET deposition data set
---- General multi-species dry scavenging data set:  call DRYSET_CTM3
-'tables/scavenging_dry.inp'            DRY deposition data set
---- Emission list ---
-'tables/Ltracer_emis_ceds17_2000_eva.inp'    See ./tables/ for more
---------------------------------------------------------------------------------
-===== CONT = write restart (Continuation) file (unformatted)
-     123456789.123456789.123456789.1              JDO_C
-JAN _1000000000000000000000000000000  001 - 031
-FEB _00000000000000000000000000000    032 - 060
-MAR _0000000000000000000000000000000  061 - 091
-APR _000000000000000000000000000000   092 - 121
-MAY _0000000000000000000000000000000  122 - 152
-JUN _000000000000000000000000000000   153 - 182
-JUL _0000000000000000000000000000000  183 - 213
-AUG _0000000000000000000000000000000  214 - 244
-SEP _000000000000000000000000000000   245 - 274
-OCT _0000000000000000000000000000000  275 - 305
-NOV _000000000000000000000000000000   306 - 335
-DEC _0000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== BUDGET tendencies calendar (unf + some form output)
-     123456789.123456789.123456789.1              JDO_T
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-    8 # CATEGORIES for tendency budgets
-    1 = SOURCE
-    2 = BNDLYR
-    3 = DRYDEP
-    4 = UV_ADV
-    5 = W_ADV_
-    6 = LSSCAV
-    7 = CHEMIS
-    8 = CNSCAV
-Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
-1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
-box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
-box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
-box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
-box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
-box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
-box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
-box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
-box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
-box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
-box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
-box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
-box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
---------------------------------------------------------------------------------
-===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
-     123456789.123456789.123456789.1             JDO_A
-JAN _2000000000000000000000000000000  001 - 031
-FEB _20000000000000000000000000000    032 - 060
-MAR _2000000000000000000000000000000  061 - 091
-APR _200000000000000000000000000000   092 - 121
-MAY _2000000000000000000000000000000  122 - 152
-JUN _200000000000000000000000000000   153 - 182
-JUL _2000000000000000000000000000000  183 - 213
-AUG _2000000000000000000000000000000  214 - 244
-SEP _200000000000000000000000000000   245 - 274
-OCT _2000000000000000000000000000000  275 - 305
-NOV _200000000000000000000000000000   306 - 335
-DEC _2000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-===== STE-flux output                            JDO_X
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
---------------------------------------------------------------------------------
-      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
-1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
---------------------------------------------------------------------------------
-==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
-     123456789.123456789.123456789.1
-JAN _1000000000000000000000000000000  001 - 031
-FEB _10000000000000000000000000000    032 - 060
-MAR _1000000000000000000000000000000  061 - 091
-APR _100000000000000000000000000000   092 - 121
-MAY _1000000000000000000000000000000  122 - 152
-JUN _100000000000000000000000000000   153 - 182
-JUL _1000000000000000000000000000000  183 - 213
-AUG _1000000000000000000000000000000  214 - 244
-SEP _100000000000000000000000000000   245 - 274
-OCT _1000000000000000000000000000000  275 - 305
-NOV _100000000000000000000000000000   306 - 335
-DEC _1000000000000000000000000000000  336 - 366
-   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
-statn  1  Alert          82.45   -1.20   LAT/LNG
-statn  2  Pt. Barrow     71.32 -156.61
-statn  3  Rorvik         57.00   12.00
-statn  4  Mace Head      53.32   -9.88
-statn  5  Hohenpssnb     47.48   11.01
-statn  6  Payerne        46.82    6.95
-statn  7  Harvard Fo     43.00  -79.00
-statn  8  Niwot Ridg     40.04 -105.58
-statn  9  Azores         38.75   27.08
-statn 10  Wallops Is     37.90  -75.50
-statn 11  Bermuda        32.00  -64.00
-statn 12  Mauna Loa      19.54 -155.58
-statn 13  Cp. Kumaka     19.54 -155.58
-statn 14  Barbados       13.17  -59.43
-statn 15  Natal          -5.92  -35.17
-statn 16  Ascension      -7.98  -14.42
-statn 17  Amazon        -10.00  -50.00
-statn 18  Am. Samoa     -14.23  170.56
-statn 19  Cuiaba        -15.60  -56.10
-statn 20  Cape Grim     -40.41  144.69
-statn 21  Neumayer      -70.00   -8.00
-statn 22  South Pole    -90.00     .00
-statn 23  Taibei         25.03  121.52
-statn 24  Tokyo          35.68  139.77
-statn 25  Guam           13.22  145.33
-statn 26  Shemya         52.92  174.06
-statn 27  Mauna Loa      19.53 -155.58
-statn 28  Anchorage      61.17 -150.02
-statn 29  San Frans      37.62 -122.38
-statn 30  Quito           0.22  -78.53
--------Stations local time diags------------------------------------------------
-    0 stations for local time diag. LT may be adjusted to fit at least one pnt
--------Tracers for local time diags at stations---------------------------------
-    0     # of tracer global local time diag. LT may be adjusted
--------3D unf inst.(select AIR & TRACER m/m) from start to K3DMAX, then stops---
-K3DMAX      900   F FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
---------------------------------------------------------------------------------
Index: manual_osloctm3.pdf
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: p-cloud2.f
===================================================================
--- p-cloud2.f	(.../ctm3f90)	(revision 243)
+++ p-cloud2.f	(.../branches/brOzoNorClim)	(revision 243)
@@ -60,17 +60,6 @@
       BOXIWR(:,:) = 0._r8
       RANNUM(:) = -1._r8
 !
-!// Could possibly be a bit faster to put openmp here, but
-!// not much.
-c!$omp parallel private(J,I,IRAN,N,RANNUM,JX,IX,L,KBOX,
-c!$omp& ILNG,JLAT,GAREA,PSRF,AWT,TEM,ZL,CLDFN,BOXIWR,BOXLWR, 
-c!$omp& TAUQCA,JXQCA,WTQCA)
-c!$omp& shared(IRAN0,LTOP,ETAA,ETAB,SWSTORE,CLDSTORE,TYPSTORE,
-c!$omp&        LCLDAVG,LCLDQMD,LCLDQMN,LCLDRANA,LCLDRANQ,
-c!$omp&        IMAP,JMAP,AREAXYW,PW,ZDEGI,ZDEGJ,TW,ZOFLEW,CLDFRW,
-c!$omp&        CLDIWCW,CLDLWCW,RAN4)
-c!$omp& default(NONE)
-c!$omp do schedule(static)
       do J = 1,JPAR
       do I = 1,IPAR
 
@@ -121,8 +110,6 @@
 
       enddo
       enddo
-c!$omp end do
-c!$omp end parallel
 
       return
       end
Index: pmain_lit.f90
===================================================================
--- pmain_lit.f90	(.../ctm3f90)	(revision 243)
+++ pmain_lit.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,13 +1,14 @@
 !//=========================================================================
 !// Oslo CTM3
 !//=========================================================================
-!// Based on UCI CTM core p-7.1 (1/2013).
+!// Lightning generation.
+!// Stripped version of Oslo CTM3 pmain.f90
 !//
-!// Amund Sovde Haslerud, May 2017
+!// Ole Amund Sovde, April 2015
 !//=========================================================================
-!// pmain.f90 version of UCIrvine CTM p-main.f.
+!// p-main.f90 version of UCIrvine CTM p-main.f.
 !//=========================================================================
-!// Driver for CHEMICAL TRANSPORT MODEL
+!// Lightning generation: Stripped of transport and chemistry.
 !//=========================================================================
 program pmain
   !//-----------------------------------------------------------------------
@@ -18,18 +19,17 @@
        LOSLOCHEM, LBCOC, LSOA, LSALT, LDUST
   use cmn_ctm, only: AIR, LYEAR, GMTAU, NRMETD, NROPSM, NRCHEM, JDATE, &
        JDAY, JMON, JYEAR, NTM, IDAY, IYEAR, LLPYR, LFIXMET, TMON, TMET, &
-       JDAY_NEXT, JDATE_NEXT, JMON_NEXT, JYEAR_NEXT, &
-       SOLDEC, SOLDIS, LCONT, modelTimeIntegrated
+       SOLDEC, SOLDIS, LCONT, STT
   use cmn_chem, only: N_LZ, N_STE, LZLBO3, O3iso1,O3iso2
   use cmn_diag, only: NTDPAR, USTEP, VSTEP, WSTEP, JMON0, LFLXDG, LMXDG, &
        STTTND, NDAY0, JDO_A, JDO_C, JDO_X, JDO_T, &
        NTND_SOURCE, NTND_BNDLYR, NTND_DRYDEP, NTND_CHEM, &
        NTND_LSSCAV, NTND_CNSCAV, NTND_WADV, NTND_UVADV
   use cmn_fjx, only: JVN_
-  use cmn_met, only: MYEAR
+  use cmn_met, only: MYEAR,precls, CLDFR, CLDIWC, CLDLWC
   use cmn_parameters, only: LDEBUG
   !//-----------------------------------------------------------------------
-  use averages, only: AVG_P1, AVG_WRT_NC4, AVG_ADD2, AVG_CLR2
+  use averages, only: AVG_P1, AVG_WRT2, AVG_ADD2, AVG_CLR2
   use budgets, only: TBGT_G, TBGT_P0, TBGT_P1, TBGT_P2, TBGT_IJ, TBGT_L
   use cloudjx, only: cloud_init
   use convection, only: CONVW_OSLO
@@ -46,9 +46,9 @@
   use steflux, only: CHEMFLUX, CHEMFLUX_E90, dumpuvflux, DUMPTRMASS, &
        DUMPTRMASS_E90, SAVETRMASS, STEBGT_CLR, STEBGT_WRITE, &
        ctm3_pml, ctm3_o3scav
-  use stt_save_load, only: save_restart_file
-  use utilities, only: write_log, LCM, calendar, get_soldecdis, &
-       CALENDL, get_dinm, check_btt
+  use stt_save_load, only: oslo_con_sav
+  use utilities, only: write_log, ctmExitC, LCM, CALENDR, CALENDL, &
+       get_dinm, check_btt
   !//-----------------------------------------------------------------------
   use cmn_oslo, only: METHANEMIS, JVAL_IJ
   use emissions_aircraft, only: aircraft_h2o_zero
@@ -61,14 +61,14 @@
   use diagnostics_scavenging, only: &
        scav_diag_ls, scav_diag_cn, scav_diag_brd, scav_diag_2fileA
   use drydeposition_oslo, only: setdrydep
-  use dust_oslo, only: dustbdg2file, dustInstBdg
+  use dust_oslo, only: dustbdg2d
   use emissions_ocean, only: emissions_ocean_total
   use emissions_oslo, only: update_emis, update_emis_ij
   use gmdump3hrs, only: dump3hrs
   use input_oslo, only: init_oslo
   use main_oslo, only: master_oslo, update_chemistry
-  use physics_oslo, only: update_physics, set_blh_ij
-  use seasalt, only: saltbdg2file, emissions_seasalt_total
+  use physics_oslo, only: update_physics
+  use seasalt, only: seasaltbdg2d, emissions_seasalt_total
   use utilities_oslo, only: get_chmcycles, &
        source_e90, decay_e90, &
        tpauseb_e90, tpauseb_o3
@@ -92,7 +92,7 @@
   real(r8) :: DTOPS, DTCHM, DTMET, DTADV, DTLCM
   !//---CTM3: time steps variables
   integer :: CHMCYCLES, CCYC
-  real(r8) :: dtchm2, nmetTimeIntegrated(MPBLK)
+  real(r8) :: dtchm2
 
   !//---private arrays B--(reverse order) for IJ-block OMP calculation
   real(r8), dimension(LPAR,IDBLK,JDBLK)      :: AIRB, GAMAB, GAMACB, BTEM
@@ -101,8 +101,8 @@
        BXT, BXX, BYT, BYY, BZT, BZZ, BXY, BXZ, BYZ
   real(r8), dimension(MPBLK,NPAR,NTDPAR)   :: BTTTN0
   real(rTnd), dimension(LPAR,NPAR,IDBLK,JDBLK,NTDPAR)::  BTTTND
-  logical, dimension(LPAR,IDBLK,JDBLK)     :: LSTRATAIR_E90B
-  logical, dimension(LPAR,IPAR,JPAR,2)     :: LSTRATAIR_O3
+  logical, dimension(LPAR,IDBLK,JDBLK)     :: LPAUZB
+  logical, dimension(LPAR,IPAR,JPAR,2)     :: LO3PAUZ
 
   !//---private array AIRUV for UV-advection
   real(r8), dimension(IPAR,JPAR)   ::  AIRUV
@@ -130,18 +130,18 @@
 
   !//---for timing the run
   character(len=10) :: BIG_BEN(3)
-  integer :: END_TIME(8), START_TIME(8)
-  integer(kind=8) :: stime
-  real(r8) :: tot_dt, nops_dt, nday_dt, nmp_dt, nuv_dt, rtime
+  integer :: DATE_TIME(8), START_TIME(8)
+  real(r8) :: tot_dt, nops_dt, nday_dt
   !//-----------------------------------------------------------------------
 
-  !// Start time and system clock for timings
-  call DATE_AND_TIME (BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),START_TIME)
-  call SYSTEM_CLOCK(count=stime, count_rate=rtime)
-  tot_dt = - real(stime, r8) / rtime
+  !// Start time
+  call DATE_AND_TIME (BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),DATE_TIME)
+  start_time(:) = date_time(:)
+  tot_dt = - (date_time(3)*86400._r8 + date_time(5)*3600._r8 &
+       + date_time(6)*60._r8 + date_time(7) + date_time(8)*1.e-3_r8)
 
   !// Write start info
-  call write_log(0, start_time, start_time, 0._r8)
+  call write_log(0, start_time, start_time)
 
   !// Input (std in) and initialization, also calls calendar
   call INPUT(NDAYI, NDAYE)
@@ -188,12 +188,12 @@
   !// TRACER SPECIFIC INPUT
   !//-----------------------------------------------------------------------
 
-  !// Separate read-in for Oslo chemistry (must be after AIRSET)
+  !// Separate read-in for Oslo chemistry
   call init_oslo(NDAY,DTCHM,CHMCYCLES)
 
   !// Set up species (initialize.f90)
-!  call SETUP_SPECIES(NDAY,NDAYI)
-!  call SETUP_UNF_OUTPUT(NDAY,NDAYI)
+  !call SETUP_SPECIES(NDAY,NDAYI)
+  !call SETUP_UNF_OUTPUT(NDAY,NDAYI)
 
   !// RESET SELECTED TRACERS
   !// Set CH4 to HYMN-results
@@ -203,13 +203,13 @@
   !// Set aircraft H2O to zero
   !call aircraft_h2o_zero()
 
-  !// Clear averages
-!  call AVG_CLR2
+  !// Clear averages (AVG_CLR2 in oc_diagnoses.f)
+  !call AVG_CLR2
   !// Initialize budgets
-!  call TBGT_G(STTTNL,BTTTN0,0)
+  !call TBGT_G(STTTNL,BTTTN0,0)
 
   !// STEFLUX: Initialize
-!  if (LFLXDG) call STEBGT_CLR(NDAY,0) !// Initialize STE budgets
+  !if (LFLXDG) call STEBGT_CLR(NDAY,0) !// Initialize STE budgets
 
   !//-----------------------------------------------------------------------
   !// MAIN LOOP
@@ -244,18 +244,19 @@
   do NDAY = NDAYI, NDAYE-1
     !//---------------------------------------------------------------------
 
-    !// Keep track of seconds calculated per day
-    call SYSTEM_CLOCK(count=stime)
-    nday_dt = - real(stime, r8) / rtime
+    !// Date and time stuff
+    call DATE_AND_TIME (BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),DATE_TIME)
+    nday_dt = - (date_time(3)*86400._r8 + date_time(5)*3600._r8 &
+         + date_time(6)*60._r8 + date_time(7) + date_time(8)*1.e-3_r8)
     if (NDAY.eq.NDAYI) tot_dt = tot_dt - nday_dt !// Time spent on init
 
     IDAY = NDAY !// Set IDAY
 
     !// Initialize LINOZ each day
-!    if (LLINOZ)  call LNZ_SET(JMON,JYEAR)
+    !if (LLINOZ)  call LNZ_SET(JMON,JYEAR)
 
-    !// Daily initialization of diagnostics (diagnostics_general.f90)
-!    call init_daily_diag(JYEAR,JMON,JDATE,NDAY,NDAYI)
+    !// Daily initialization of diagnostics (oc_diagnostics.f)
+    !call init_daily_diag(JYEAR,JMON,JDATE,NDAY,NDAYI)
 
     !// Set up number of days in months
     call get_dinm(LYEAR)
@@ -265,6 +266,10 @@
     do NMET = 1, NRMETD
       !//-------------------------------------------------------------------
 
+      call DATE_AND_TIME (BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),DATE_TIME)
+      nops_dt = - (date_time(3)*86400._r8 + date_time(5)*3600._r8 &
+           + date_time(6)*60._r8 + date_time(7) + date_time(8)*1.e-3_r8)
+
       !// Read met fields & set up surface
       call update_metdata(1, DTMET, NMET)
 
@@ -272,13 +277,12 @@
         !// Set climatological mass, O3 & T above CTM
         call SET_ATM
         !// Find lightning
-        call LIGHTNING_OAS2015(NDAY,NDAYI,DTMET,LNEWM,NMET)
+        call LIGHTNING_OAS2015(NDAY,NDAYI,DTMET,LNEWM)
         NCLDRAN   = 0
       end if
       call DYN0 (DTMET)             ! process wind/advection fields
       call CFLADV (DTOPS,NADV)      ! global cfl criteria
       call LCM (NRCHEM,NADV,NLCM)   ! find least common multiple
-!      write(6,'(a,2i3)') 'NADV/NLCM: ',NADV,NLCM
 
       !//---DTxxx = time step in seconds 
       DTLCM   = DTOPS / real(NLCM, r8)
@@ -286,10 +290,9 @@
       DTCHM   = DTOPS / real(NRCHEM, r8) ! same as defined above
       DTAULCM = DTLCM / 3600._r8
       DTCHM2 = DTCHM / real(CHMCYCLES, r8) ! for Oslo chemistry internal loop
-      nmetTimeIntegrated(:) = 0._r8   ! sums up seconds calculated in CCYC-loop
 
-      !// Dump aerosol data each 3 hour? (gmdump3hrs.f90)
-!      call dump3hrs(NDAYI,NDAY,NMET)
+      !// Dump aerosol data each 3 hour? (set LDUMP3HRS in oc_gmdump3hrs.f90)
+      !call dump3hrs(NDAYI,NDAY,NMET)
 
       !//-------------------------------------------------------------------
       do NOPS = 1, NROPSM
@@ -320,31 +323,31 @@
         !//---Diagnoses (names set in LxxTyy-file)
         !//--- 0=INITIA, 1=SOURCE, 2=BndryL, 3=DRYDEP, 4=UV_ADV, 5=W_ADV_,
         !//--- 6=LSSCAV, 7=CHEMIS, 8=C_SCAV, 9=
-!        call SYSTEM_CLOCK(count=stime)
-!        nops_dt = - real(stime, r8) / rtime
+        !call DATE_AND_TIME (BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),DATE_TIME)
+        !nops_dt = - (date_time(3)*86400._r8 + date_time(5)*3600._r8 &
+        !     + date_time(6)*60._r8 + date_time(7) + date_time(8)*1.e-3_r8)
 
         !// Update global variables needed for Oslo chemistry.
         !// Also initialises E90-tracer and tropopause.
-!        call update_physics(NDAYI,NDAY,NMET,NOPS,LNEWM)
+        !call update_physics(NDAYI,NDAY,NMET,NOPS,JMON,LNEWM)
 
         !// Update parameters for chemistry and aerosols.
         !// Also initialises stratospheric H2O.
-!        call update_chemistry(NDAYI,NDAY,NMET,NOPS,JMON,LNEWM)
+        !call update_chemistry(NDAYI,NDAY,NMET,NOPS,JMON,LNEWM)
 
         !// Update short term variations in emissions.
         !// Note that some parts may be updated within MP-block, using
         !// subroutine update_emis_ij.
-!        call update_emis(NDAY,NMET,NOPS,NDAYI,LNEWM,DTOPS)
+        !call update_emis(NDAY,NMET,NOPS,NDAYI,LNEWM,DTOPS)
 
 
         !// Do NOPS-based diagnosics.
         !// Remember that for asynchronous chemistry/transport
         !// steps, the previous process MAY NOT BE transport.
-!        call nops_diag(JYEAR,JMON,JDATE,NDAY,NMET,NOPS,NDAYI,LNEWM)
+        !call nops_diag(JYEAR,JMON,JDATE,NDAY,NMET,NOPS,NDAYI,LNEWM)
         
-        nmp_dt = 0._r8
-        nuv_dt = 0._r8
 
+
         !//-----------------------------------------------------------------
         do NSUB = 1, NLCM
           !//---------------------------------------------------------------
@@ -361,13 +364,10 @@
 
 
           !// Accumulate global budgets
-!          call TBGT_G (STTTNL,BTTTN0, 1)
+          !call TBGT_G (STTTNL,BTTTN0, 1)
 
           GMTAU = GMTAU + DTAULCM
 
-          !// Model integrated time (seconds)
-!          modelTimeIntegrated = modelTimeIntegrated + DTLCM
-
           !//---------------------------------------------------------------
         end do !// NSUB                                                 NSUB
         !//-----------------------------------------------------------------
@@ -375,30 +375,30 @@
         !---have completed the basic op-split time step = DTAU
         DAY = real(NDAY, r8) + GMTAU / 24._r8
 
+        !call DUMP3D (25, JYEAR,DAY)
+
         !// Add to averages (in averages.f90)
-!        call AVG_ADD2
+        !call AVG_ADD2
 
-!        call TSER_1 (KSERIES)
+        !call TSER_1 (KSERIES)
 
         !// Report chemistry & physics
-!        call REPORTS_CHEMISTRY(NDAY,NMET,NOPS,GMTAU, NDAYI,LNEWM)
+        !call REPORTS_CHEMISTRY(NDAY,NMET,NOPS,GMTAU, NDAYI,LNEWM)
 
         !// NOPS diag for SOA
-!        if (LSOA) call soa_nopsdiag(NDAY,NMET,NOPS,JDAY,DTOPS)
+        !if (LSOA) call soa_nopsdiag(NDAY,NMET,NOPS,JDAY,DTOPS)
 
-!        if (LDUST) call dustInstBdg(NDAY,NDAY0,NMET,NOPS,DTOPS)
-
         !// Done everything for the beginning of new month
         if (LNEWM) LNEWM = .false.
 
-        !// Additional printouts
-        !call emissions_seasalt_total()
-        !call emissions_ocean_total()
+      !// Additional printout
+      !call emissions_seasalt_total()
+      !call emissions_ocean_total()
 
-!        call SYSTEM_CLOCK(count=stime)
-!        nops_dt = nops_dt + real(stime, r8) / rtime
-!        write(6,'(a,i4,2i3,3f8.2)') 'WC NMP/NUV/NOPS [s]: ',NDAY,NMET,NOPS, &
-!             nmp_dt, nuv_dt, nops_dt
+        !call DATE_AND_TIME(BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),DATE_TIME)
+        !nops_dt = nops_dt + (date_time(3)*86400._r8 + date_time(5)*3600._r8 &
+        !     + date_time(6)*60._r8 + date_time(7) + date_time(8)*1.e-3_r8)
+        !write(6,'(a,i4,2i3,f8.2)') 'WC NOPS [s]: ',NDAY,NMET,NOPS,nops_dt
         !//-----------------------------------------------------------------
       end do !// NOPS                                                   NOPS
       !//-------------------------------------------------------------------
@@ -406,31 +406,28 @@
 
 
 
-!      if (LFLXDG .and. N_STE.ne.0)  then
-!        call DUMPTRMASS(LSTRATAIR_O3,1)
-!        call DUMPTRMASS(LSTRATAIR_O3,2)
-!        call DUMPTRMASS_E90(3,N_STE)
-!        if (LLINOZ) call DUMPTRMASS_E90(4,N_LZ)
-!      end if
+      !if (LFLXDG .and. N_STE.ne.0)  then
+      !  call DUMPTRMASS(LO3PAUZ,1)
+      !  call DUMPTRMASS(LO3PAUZ,2)
+      !  call DUMPTRMASS_E90(3,N_STE)
+      !  if (LLINOZ) call DUMPTRMASS_E90(4,N_LZ)
+      !end if
 
+      call DATE_AND_TIME(BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),DATE_TIME)
+      nops_dt = nops_dt + (date_time(3)*86400._r8 + date_time(5)*3600._r8 &
+           + date_time(6)*60._r8 + date_time(7) + date_time(8)*1.e-3_r8)
+      write(6,'(a,i4,i3,f8.2)') 'WC NMET [s]: ',NDAY,NMET,nops_dt
 
-!      do M = 1, MPBLK
-!         if (nmetTimeIntegrated(M) .ne. DTMET) then
-!            print*,'pmain: Seriously wrong',M,nmetTimeIntegrated(M),DTMET
-!            stop
-!         end if
-!      end do
-
       !//-------------------------------------------------------------------
     end do !// NMET                                                     NMET
     !//---------------------------------------------------------------------
 
     !// STEFLUX: Save daily tropospheric O3 mass
-!    if (LFLXDG .and. N_STE .gt. 0) then
-!      !// Create the very initial trop column mass
-!      if (NDAY .eq. NDAYI)  call SAVETRMASS(0)
-!      call SAVETRMASS(1)
-!    end if
+    !if (LFLXDG .and. N_STE .gt. 0) then
+    !  !// Create the very initial trop column mass
+    !  if (NDAY .eq. NDAYI)  call SAVETRMASS(0)
+    !  call SAVETRMASS(1)
+    !end if
 
     !//---have completed 24-hour (day) step
     GMTAU   = 0._r8
@@ -439,68 +436,61 @@
     !// Daily/monthly diagnostics & saves
     !//---------------------------------------------------------------------
 
-    !// Daily output of diagnostics; before calendar update
-    !// (diagnostics_general.f90)
-!    call daily_diag_output(JYEAR,JMON,JDATE,JDAY,NDAY,NDAYI)
+    !// Daily output of diagnostics; before calendar update (oc_diagnostics.f)
+    !call daily_diag_output(JYEAR,JMON,JDATE,JDAY,NDAY,NDAYI)
 
 
     !//---update the calendar to the new, upcoming day
     IDAY = NDAY + 1
-    !call CALENDR (IYEAR,IDAY, LLPYR,LFIXMET,MYEAR, &
-    !     JYEAR,JDAY,JMON,TMON,JDATE,LYEAR,TMET,SOLDEC,SOLDIS)
-    !//---update the calendar to the new, upcoming day plus more
-    call calendar(IYEAR,IDAY, LLPYR,LFIXMET,MYEAR, &
-         JYEAR,JDAY,JMON,TMON,JDATE,LYEAR,TMET, &
-         JYEAR_NEXT,JDAY_NEXT,JMON_NEXT,JDATE_NEXT)
-    call get_soldecdis(JDAY,SOLDEC,SOLDIS)
+    call CALENDR (IYEAR,IDAY, LLPYR,LFIXMET,MYEAR, &
+         JYEAR,JDAY,JMON,TMON,JDATE,LYEAR,TMET,SOLDEC,SOLDIS)
     LNEWM = JDATE.eq.1
 
-
     !// STEFLUX: flux dump share calendar JDO_X
     call CALENDL (JYEAR,JDAY,LYEAR,  JDO_X, LMXDG,L2)
-!    if (LMXDG .and. LFLXDG)  then
-!      call STEBGT_WRITE
-!      call STEBGT_CLR(IDAY,1)
-!    end if
+    !if (LMXDG .and. LFLXDG)  then
+    !  call STEBGT_WRITE
+    !  call STEBGT_CLR(IDAY,1)
+    !end if
 
     !//---TENDENCIES:  write/reset budget tendencies & time series
     !//---use calendar to trigger diagnostics/saves on/off
     call CALENDL (JYEAR,JDAY,LYEAR,  JDO_T, LTBGT,L2)
 
     !// Initialize 2D budgets files
-!    if (NDAY .eq. NDAYI) call TBGT_2FILE(0)
+    !if (NDAY .eq. NDAYI) call TBGT_2FILE(0)
 
-!    if (LTBGT .or. LEND) then
-!      !// Write diagnostics: emissions
-!      call tnd_emis2file(NDAY)
+    !if (LTBGT .or. LEND) then
+      !// Write diagnostics: emissions
+      !call tnd_emis2file(JYEAR,JMON,JDATE,NDAY)
 
-!      !// Print out tendencies 0D, 1D and 2D
-!      call TBGT_P0 (IDAY)
-!      call TBGT_P1 (IDAY)
-!      !call TBGT_P2 (IDAY) !// Unformatted output to 24 currently disabled
-!
-!      !// Print out SALT budget (NDAY, not IDAY)
-!      if (LSALT) call saltbdg2file(NDAY,NDAYI,NDAY0)
-!
-!      !// Print out DUST budget
-!      if (LDUST) call dustbdg2file(NDAY,NDAYI,NDAY0)
-!
-!      !// Print 2D budgets to file
-!      call TBGT_2FILE(1)
-!
-!      if (LSOA) call soa_diag2file(NDAY,NDAYI)
-!
-!      !// Chemistry budgets
-!      !call chembud_output(JYEAR,JMON,JDATE,NDAY)
-!
-!      !// Write diagnostics: scavenging
-!      call scav_diag_2fileA(JYEAR,JMON,JDAY,NDAY)
-!
-!      !// Initialize core tendencies for next average
-!      call TBGT_G(STTTNL, BTTTN0, 0)
-!
-!    end if
+      !// Print out tendencies 0D, 1D and 2D
+      !call TBGT_P0 (IDAY)
+      !call TBGT_P1 (IDAY)
+      !call TBGT_P2 (IDAY) !// Unformatted output to 24 currently disabled
 
+      !// Print out SALT budget (NDAY, not IDAY)
+      !if (LSALT) call seasaltbdg2d(NDAY,NDAYI, STTTND, NDAY0)
+
+      !// Print out DUST budget
+      !if (LDUST) call dustbdg2d(NDAY,NDAYI, STTTND, NDAY0)
+
+      !// Print 2D budgets to file
+      !call TBGT_2FILE(1)
+
+      !if (LSOA) call soa_diag2file(NDAY,NDAYI)
+
+      !// Chemistry budgets
+      !call chembud_output(JYEAR,JMON,JDATE,NDAY)
+
+      !// Write diagnostics: scavenging
+      !call scav_diag_2fileA(JYEAR,JMON,JDAY,NDAY)
+
+      !// Initialize core tendencies for next average
+      !call TBGT_G(STTTNL, BTTTN0, 0)
+
+    !end if
+
     !//---SERIES:  write TRACER time series (unf unit=23)
     !//---use calendar to trigger diagnostics/saves on/off
     !//---reset (KSERIES=0) must be done every day since series is always accum.
@@ -514,7 +504,7 @@
     !//---write/reset average tracer
     call CALENDL (JYEAR,JDAY,LYEAR,  JDO_A, LAVGS,L2)
 !    if (LAVGS .or. LEND) then
-!      call AVG_WRT_NC4    !// Write averages
+!      call AVG_WRT2    !// Write averages
 !
 !      if (L2) then
 !        call AVG_P1
@@ -526,12 +516,13 @@
     !//---restart file save (at least at end of run)
     call CALENDL (JYEAR,JDAY,LYEAR,  JDO_C, LCONT,L2)
 !    if (LCONT .or. LEND)  then
-!      call save_restart_file(NDAY+1,NDAYI)
+!      call OSLO_CON_SAV(NDAY+1)
 !      if (LBCOC) call bcsnow_save_restart(NDAY+1)
 !    end if
 
-    call SYSTEM_CLOCK(count=stime)
-    nday_dt = nday_dt + real(stime, r8) / rtime
+    call DATE_AND_TIME(BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),DATE_TIME)
+    nday_dt = nday_dt + (date_time(3)*86400._r8 + date_time(5)*3600._r8 &
+         + date_time(6)*60._r8 + date_time(7) + date_time(8)*1.e-3_r8)
     tot_dt = tot_dt + nday_dt !// Summing up total time
     write(6,'(a,i4,f8.1,1x,f10.2,1x,f7.2)') &
          '** WC time NDAY [s] / total [hours/days]:', &
@@ -542,8 +533,8 @@
 
   !//---Final: closeout the model run
   close(21)
-  call DATE_AND_TIME (BIG_BEN(1),BIG_BEN(2),BIG_BEN(3),END_TIME)
-  call write_log(1, start_time, end_time, tot_dt)
+  call write_log(1, start_time, date_time)
+  call ctmExitC(' std exit')
   !//-----------------------------------------------------------------------
 end program pmain
 !//=========================================================================
Index: cmn_met.f90
===================================================================
--- cmn_met.f90	(.../ctm3f90)	(revision 243)
+++ cmn_met.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -25,7 +25,8 @@
 
   !// Met-file names
   character(len=80) :: MET_ROOT   !// Root where metdata resides
-  character(len=80) :: MPATH1, MPATH2, MFILE3
+  character(len=80) :: MPATH1, MPATH2, MFILE3, PPFDFILE
+  character(len=120):: PPFDPATH
 
   !// Metdata type (e.g. ECMWF_IFS/ECMWF_oIFS/ECMWF_oIFSnc4),
   !// cycle and revision number
@@ -91,27 +92,28 @@
        SFQ, &
        SFU, &
        SFV, &
-       !SPRECLS, & !// Surface value of PRECLS_LIJ [kg/s]
-       BLH, &  !// Boundary layer height [m], see LBLH for model level.
-       BLH_CUR, &  !// Boundary layer height [m] for current time step
-       BLH_NEXT, &  !// Boundary layer height [m] for next time step
+       !SPRECLS, &    !// Surface value of PRECLS_LIJ [kg/s]
+       BLH, &        !// Boundary layer height [m], see LBLH for model level.
+       BLH_CUR, &    !// Boundary layer height [m] for current time step
+       BLH_NEXT, &   !// Boundary layer height [m] for next time step
        USTR, &
-       CI, &   !// Sea ice cover [0,1]
-       SD, &   !// Snow depth [m water equivalent]
+       CI, &         !// Sea ice cover [0,1]
+       SD, &         !// Snow depth [m water equivalent]
        PhotActRad, & !// Photosynthetically active radiation [W/m2]
+       PPFD, &       !// Photosynthetically active radiation - deaccumulated [W/m2]
        SWVL1, &      !// Soil volumetric water level 1 [m3/m3]
        STL1          !// Soil temperature level 1 [K]
 
   integer, dimension(IPAR,JPAR) :: &
-       LBLH    !// Uppermost model level for PBL
+       LBLH          !// Uppermost model level for PBL
 
   real(r8), dimension(IDBLK,JDBLK,MPBLK) :: &
-       SMLT, &      !// Snow melt [m water equivalent per seconds]
-       ES, &        !// Snow evaporation [m water equivalent per seconds]
-       SNFL, &      !// Snow fall [m water equivalent per seconds]
-       PBL_KEDDY, & !// KEDDY (KH) for PBL
-       MO_LENGTH, & !// Monin-Obukhov (MO_LENGTH) from PBL
-       PRANDTLL1    !// Prandtl for surface layer
+       SMLT, &       !// Snow melt [m water equivalent per seconds]
+       ES, &         !// Snow evaporation [m water equivalent per seconds]
+       SNFL, &       !// Snow fall [m water equivalent per seconds]
+       PBL_KEDDY, &  !// KEDDY (KH) for PBL
+       MO_LENGTH, &  !// Monin-Obukhov (MO_LENGTH) from PBL
+       PRANDTLL1     !// Prandtl for surface layer
 
 
 
Index: grid.f90
===================================================================
--- grid.f90	(.../ctm3f90)	(revision 243)
+++ grid.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -2041,7 +2041,7 @@
        !// 16    16    Barren or Sparsely Vegetated
        !// 17    17    Unclassified
        !//------------------------------------------------------------------
-       if (nPft .gt. NVGPAR+1) then
+       if (nPft .gt. NVGPAR) then
           write(6,'(a,2i5)') f90file//':'//subr// &
                ': nPft / NVGPAR mismatch: ',nPft,NVGPAR
           stop
@@ -2075,7 +2075,6 @@
           end if
        end do !// do M = 1, nPft
 
-
        !// Possible correction to landSurfTypeFrac and PLAND
        do J = 1, JPAR
           do I = 1, IPAR
@@ -2095,6 +2094,7 @@
           end do
        end do
 
+
     else if (LANDUSE_IDX .eq. 3) then
        !//------------------------------------------------------------------
        !// CLM4 PFTs
@@ -2188,16 +2188,6 @@
     !// At the end
     deallocate( XBEDGE, YBEDGE, inTime, XYBOX, inPFT, R8DATA )
 
-    !// Check for wrong file
-    RTMP = sum(PLAND*AREAXY)/sum(AREAXY)
-    if (RTMP .lt. 0.28_r8 .or. RTMP .gt. 0.34_r8) then
-       write(6,'(a)') f90file//':'//subr// &
-            ': Land fraction (PLAND) is probably wrong.'
-       write(6,'(a,f6.2)') 'Total land area (%): ',RTMP*100._r8
-       write(6,'(a)') 'Did you set wrong PFT-file in input file?'
-       stop
-    end if
-
     write(6,'(a)') f90file//':'//subr//': landSurfTypeFrac is set'
 
 
@@ -2783,11 +2773,85 @@
   end subroutine gridICAO
   !//-----------------------------------------------------------------------
 
+ !// ----------------------------------------------------------------------
+  subroutine read_growing_season()
+    !// --------------------------------------------------------------------
+    !// Reads surface input for CTM3:
+    !//   1. Preprocessed daily GDAY -> GDAY_MAP.
+    !//   2. Preprocessed GLEN -> GLEN_MAP
+    !//
+    !// Only called during initialization. For runs exceeding one year
+    !// a restart and change of file in *.inp is currently needed!
+    !// Based on SURF_IN.
+    !//
+    !// Stefanie Falk, August 2018
+    !// --------------------------------------------------------------------
+    use cmn_precision, only: r8
+    use cmn_ctm, only: JYEAR, JMON, JDAY, LYEAR, JDATE, NRMETD, &
+         ZDEGI, ZDEGJ, IMAP, JMAP
+    use cmn_size, only: IPARW, JPARW, &
+         IPAR, JPAR, IDGRD, JDGRD
+    use cmn_sfc, only: GDAY_MAP, GLEN_MAP, fileGSMAP
+        use regridding, only: TRUNG8
+    use ncutils, only: get_netcdf_var_2d, get_netcdf_var_3d
+    !// --------------------------------------------------------------------
+    implicit none
+    !// --------------------------------------------------------------------
+    logical, parameter :: VERBOSE = .false.
+    !// Local parameters
+    integer :: totdays = 365
+    !// To be read from file
+    logical :: fex
+    !//---------------------------------------------------------------------
+    !// Allocatable arrays - double precision
+    real(r8), dimension(:,:), allocatable :: W2D, R8XY
+    real(r8), dimension(:,:,:), allocatable :: W3D, R8XYZ
+    !// --------------------------------------------------------------------
+    character(len=*), parameter :: subr = 'read_GROWING_SEASON'
+    !// --------------------------------------------------------------------
+    if (LYEAR) then
+       totdays = 366
+    end if
+    !// Allocate
+    allocate( GDAY_MAP(IPAR,JPAR,totdays) )
+    !// Initialize
+    GDAY_MAP(:,:,:) = 0
+    GLEN_MAP(:,:) = 0
+    !// Allocate 2D arrays - native resolution
+    allocate( W2D(IPARW,JPARW) )
+    !// Allocate 2D arrays - window resolution (IPAR/JPAR)
+    allocate( R8XY(IPAR,JPAR) )
+    !// Allocate 3D arrays - native resolution
+    allocate( W3D(IPARW,JPARW,totdays) )
+    !// Allocate 3D arrays - window resolution (IPAR/JPAR)
+    allocate( R8XYZ(IPAR,JPAR,totdays) )
+    
+    !// Check if files exist
+    inquire(FILE=trim(fileGSMAP), exist=fex)
+    if (.not. fex) then
+       write(6,'(a)') f90file//':'//subr// &
+            ': No such file: '//trim(fileGSMAP)
+       stop
+    end if
+    !// Growing season parameters GDAY and GLEN
+    !// --------------------------------------------------------------------
+    call get_netcdf_var_2d(fileGSMAP, 'GLEN',W2D, IPARW, JPARW)
+    call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
+         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
+     GLEN_MAP(:,:) = max(0._r8, R8XY(:,:))  !// Limit to positive values
+    if (verbose) call gotData('2da','GLEN')
+    
+    call get_netcdf_var_3d(fileGSMAP, 'GDAY',W3D, IPARW, JPARW, totdays)
+    call TRUNG8(W3D, R8XYZ, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
+         JDGRD, IPARW, JPARW, IPAR, JPAR, totdays, 1)
+    GDAY_MAP(:,:,:) = max(0._r8, R8XYZ(:,:,:))  !// Limit to positive values
+    if (verbose) call gotData('3da','GDAY')
 
+    !// --------------------------------------------------------------------
+  end subroutine read_growing_season
+  !// ----------------------------------------------------------------------
 
 
-
-
   !//-----------------------------------------------------------------------
 end module grid
 !//=========================================================================
Index: c3run/old/emep_full.inp
===================================================================
--- c3run/old/emep_full.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/emep_full.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,257 @@
+=== Oslo CTM3 v1.0 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 2005  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  366  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data: File name will be built from following info------------
+ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   38    1       met data cycle & revision number
+'/work/projects/cicero/ctm_input/metdataOpenIFS/'                 met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
+--- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
+    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
+ 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
+'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
+--- Roughness length (ZOI) ---
+ 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- Leaf area index ---
+ 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- EMEP parameter list ---
+    T  LDEPEMEP2012 Dry deposition scheme / T = EMEP based dry deposition scheme, F = old scheme
+'Indata_CTM3/DRYDEP/EMEP.par'
+--- PPFD directory and dummy filename ---
+'/projects/researchers/researchers01/sfalk/ctm_input/PPFD/'
+'ECopenIFSc38r1_yYYYYmMMdDDhHH_T159N80L60'
+--- tracer specific section ---
+ T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_nitrate.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_ceds17_2014_megan_gfed4blhdaily.inp'    See ./tables/ for more
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+--------------------------------------------------------------------------------
Index: c3run/old/emep_offLight.inp
===================================================================
--- c3run/old/emep_offLight.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/emep_offLight.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,257 @@
+=== Oslo CTM3 v1.0 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 2005  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  366  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data: File name will be built from following info------------
+ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   38    1       met data cycle & revision number
+'/work/projects/cicero/ctm_input/metdataOpenIFS/'                 met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
+--- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
+    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
+ 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
+'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
+--- Roughness length (ZOI) ---
+ 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- Leaf area index ---
+ 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- EMEP parameter list ---
+    T  LDEPEMEP2012 Dry deposition scheme / T = EMEP based dry deposition scheme, F = old scheme
+'Indata_CTM3/DRYDEP/EMEP.par'
+--- PPFD directory and dummy filename ---
+'/projects/researchers/researchers01/sfalk/ctm_input/PPFD/'
+'ECopenIFSc38r1_yYYYYmMMdDDhHH_T159N80L60'
+--- tracer specific section ---
+ T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_nitrate.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_ceds17_2014_megan_gfed4blhdaily.inp'    See ./tables/ for more
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+--------------------------------------------------------------------------------
Index: c3run/old/c3run_emep_offPhen.job
===================================================================
--- c3run/old/c3run_emep_offPhen.job	(.../ctm3f90)	(revision 0)
+++ c3run/old/c3run_emep_offPhen.job	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,152 @@
+#!/bin/bash
+# Script for running on Abel.
+# --------------------------------------------------------------------------
+# Job name:
+#SBATCH --job-name=C3RUN_emep_offPhen
+#
+# Project:
+#SBATCH --account=nn2806k
+#
+# Wall clock limit:
+#SBATCH --time=166:0:0
+#
+# Does your job exceed one week, use "--partition=long":
+# ####SBATCH --partition=long
+#
+# Max memory usage:
+#SBATCH --mem-per-cpu=3000M
+#
+# Number of cores:
+#SBATCH --ntasks-per-node=16
+#
+# Number of nodes:
+#SBATCH --nodes=1
+#
+#
+## Set up job environment
+source /cluster/bin/jobsetup
+# --------------------------------------------------------------------------
+# No need to change this section
+
+# Must set large stack size (unlimited for simplicity)
+ulimit -s unlimited
+# Set ulimit also to unlimited (probably not necessary)
+ulimit unlimited
+# Print out information about ulimit
+ulimit -a
+
+# allocate specified memory to each thread (100M)
+export THREAD_STACKSIZE=300m
+#   ifort uses KMP_STACKSIZE
+export KMP_STACKSIZE=$THREAD_STACKSIZE
+
+# number of OpenMP threads - i.e. number of CPUs requested
+export OMP_NUM_THREADS=$SLURM_NTASKS_PER_NODE
+
+# the PID number is first the date then an uniqe shell pid
+export PID=`date +"%d%m%y".$$`
+
+
+
+# Model input data
+export INPUT_DATA=$INPUT_OCTM3
+
+# --------------------------------------------------------------------------
+# Do changes here
+
+# Model dir - enter your directory here
+export MODELDIR=$CTM3_DIR
+
+# Scenario name (use job name or whatever you like)
+export SCEN=$SLURM_JOB_NAME
+
+# Scratch directory
+export SCRATCH=$WORK/$SCEN
+
+# Result directory (where your files end up)
+export RESULTDIR=$WORK/$SCEN.$PID
+
+# Directory for restart
+export RESTARTDIR=$RESULTDIR/restart_$PID
+
+# Set input file name
+export INPUTFILE=emep_offPhen.inp
+
+# Name of main program
+export PROGFILE=osloctm3
+
+# Job file (this file)
+export JOBFILE=c3run_emep_offPhen.job
+
+# The dust file
+export DUSTFILE=OSLO/DEAD_COLUMN/dustinput/dst_T159.nc
+
+# A restart file
+export RESTARTFILE=/usit/abel/u1/sfalk/bin/restart.sav
+
+# Make the scratch directory
+if [ ! -d $SCRATCH ]; then mkdir $SCRATCH; fi 
+
+# Put svn info to slurm out
+cd $MODELDIR
+echo `svn info`
+# Go to work directory
+cd $SCRATCH
+
+# Restart file is set below
+# ...Move the program and the belonging files to $SCRATCH
+cp $MODELDIR/$PROGFILE         $SCRATCH/osloctm3
+cp $MODELDIR/$INPUTFILE        $SCRATCH/
+cp -r $MODELDIR/tables         $SCRATCH/
+ln -fs $INPUT_DATA             $SCRATCH/
+cp $MODELDIR/$DUSTFILE         $SCRATCH/ 
+#   CTM3 restart:  Has to be set accordingly ctm3_restartfile.sav
+cp $RESTARTFILE                $SCRATCH/restart.sav #
+#cp $RESTARTFILE                $SCRATCH/restart.nc
+# if e90-tracer is used, may need restart file
+cp $INPUT_DATA/restart_e90.sav $SCRATCH/
+# Copy the executing job file to $SCRATCH
+cp $0                          $SCRATCH/$JOBFILE
+
+
+
+
+# Run command
+./osloctm3 < $INPUTFILE > results.$PID
+
+
+## Make the result directory
+if [ ! -d $RESULTDIR ]; then mkdir $RESULTDIR; fi
+echo 'Program completed, copy to '$RESULTDIR
+# Copy files to result directory
+mv results.$PID     $RESULTDIR/
+mv avgsav*          $RESULTDIR/
+# Copy the results
+mkdir $RESULTDIR/'scavenging_daily'
+mv scavenging_daily*.nc            $RESULTDIR/'scavenging_daily'
+mkdir $RESULTDIR/'emis'
+mv emis*.nc                        $RESULTDIR/'emis'
+mv ctm3sltbudget.nc $RESULTDIR/
+mv dobson_nmet.nc   $RESULTDIR/
+mv ste*.nc          $RESULTDIR/
+mv *dta             $RESULTDIR/
+mv *.dat            $RESULTDIR/
+echo 'Results copied to '$RESULTDIR
+mv OSLO/Ltracer*    $RESULTDIR/
+#mv *.out            $RESULTDIR/
+# Copy restart file
+mkdir $RESTARTDIR
+mv *restart*.nc     $RESTARTDIR/
+mv osloctm3         $RESTARTDIR/
+mv *.job            $RESTARTDIR/
+mv *.inp            $RESTARTDIR/
+mv *.sav            $RESTARTDIR/
+mv dst_*.nc         $RESTARTDIR/
+cp -r tables        $RESTARTDIR/
+echo 'Results copied to '$RESTARTDIR
+# Move remaining .nc files
+mv *.nc             $RESULTDIR/
+
+# Done
+# --------------------------------------------------------------------------
+
Index: c3run/old/L60CTM_bcoc.inp
===================================================================
--- c3run/old/L60CTM_bcoc.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/L60CTM_bcoc.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,251 @@
+=== Oslo CTM3 v2015.01 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 1995  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data---------------------------------------------------------
+ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   38    1       met data cycle & revision number
+/work/projects/cicero/ctm_input/metdataOpenIFS/                   met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
+    T  LISLSCP2 = switch for ISLSCP2 data (if true, use ISLSCP2, otherwise ISLSCP1)
+'Indata_CTM3/ISLSCP2/MODIS/modis_landcover_1deg/modis_landcover_1d_cXX.asc'       land frac and type
+'Indata_CTM3/ISLSCP2/FASIR/fasir_rough_1d_1982-1998/fasir_rough413_1d_YYYYMM.asc' roughness Zo
+'Indata_CTM3/ISLSCP2/FASIR/fasir_glai_1d_1982-1998/fasir_glai413_1d_YYYYMM.asc'   LAI
+*** ISLSCP 1 data ***
+'tables/landfr.dat'             FILE land fraction input file, opened in SURFSET
+'tables/LS_islscp88x.dat'       FILE land surface data (Zo, LAI, veg type) 
+--------------------------------------------------------------------------------
+--- tracer specific section ---
+ F  0    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_bcoc.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_eclipse_V5_2010_meganMACC.inp'      'edgar4_megan_noch4_2000.inp'
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+-------3D unf inst.(select AIR & TRACER m/m) from start to K3DMAX, then stops---
+K3DMAX      900   F FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
Index: c3run/old/L60T42.inp
===================================================================
--- c3run/old/L60T42.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/L60T42.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,251 @@
+=== Oslo CTM3 v2015.01 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 2005  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data: File name will be built from following info------------
+ECMWF_IFS        met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   36    1       met data cycle & revision number
+/work/projects/cicero/ctm_input/metdataIFSL60/                    met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT42.dat'          FILE annual mean pressure field, opened in INPUT
+    T  LISLSCP2 = switch for ISLSCP2 data (if true, use ISLSCP2, otherwise ISLSCP1)
+'Indata_CTM3/ISLSCP2/MODIS/modis_landcover_1deg/modis_landcover_1d_cXX.asc'       land frac and type
+'Indata_CTM3/ISLSCP2/FASIR/fasir_rough_1d_1982-1998/fasir_rough413_1d_YYYYMM.asc' roughness Zo
+'Indata_CTM3/ISLSCP2/FASIR/fasir_glai_1d_1982-1998/fasir_glai413_1d_YYYYMM.asc'   LAI
+*** ISLSCP 1 data ***
+'tables/landfr.dat'             FILE land fraction input file, opened in SURFSET
+'tables/LS_islscp88x.dat'       FILE land surface data (Zo, LAI, veg type) 
+--------------------------------------------------------------------------------
+--- tracer specific section ---
+ T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_nitrate.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_eclipse_V5_2010_meganMACC.inp'      'edgar4_megan_noch4_2000.inp'
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1110000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+-------3D unf inst.(select AIR & TRACER m/m) from start to K3DMAX, then stops---
+K3DMAX      900   F FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
Index: c3run/old/emep_offPhen.inp
===================================================================
--- c3run/old/emep_offPhen.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/emep_offPhen.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,257 @@
+=== Oslo CTM3 v1.0 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 2005  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  366  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data: File name will be built from following info------------
+ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   38    1       met data cycle & revision number
+'/work/projects/cicero/ctm_input/metdataOpenIFS/'                 met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
+--- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
+    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
+ 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
+'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
+--- Roughness length (ZOI) ---
+ 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- Leaf area index ---
+ 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- EMEP parameter list ---
+    T  LDEPEMEP2012 Dry deposition scheme / T = EMEP based dry deposition scheme, F = old scheme
+'Indata_CTM3/DRYDEP/EMEP.par'
+--- PPFD directory and dummy filename ---
+'/projects/researchers/researchers01/sfalk/ctm_input/PPFD/'
+'ECopenIFSc38r1_yYYYYmMMdDDhHH_T159N80L60'
+--- tracer specific section ---
+ T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_nitrate.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_ceds17_2014_megan_gfed4blhdaily.inp'    See ./tables/ for more
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+--------------------------------------------------------------------------------
Index: c3run/old/c3run.job
===================================================================
--- c3run/old/c3run.job	(.../ctm3f90)	(revision 0)
+++ c3run/old/c3run.job	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,113 @@
+#!/bin/bash
+# Script for running on Abel.
+# --------------------------------------------------------------------------
+# Job name:
+#SBATCH --job-name=C3RUN
+#
+# Project:
+#SBATCH --account=<account name>
+#
+# Wall clock limit:
+#SBATCH --time=150:0:0
+#
+# Does your job exceed one week, use "--partition=long":
+# ####SBATCH --partition=long
+#
+# Max memory usage:
+#SBATCH --mem-per-cpu=1450M
+#
+# Number of cores:
+#SBATCH --ntasks-per-node=16
+#
+# Number of nodes:
+#SBATCH --nodes=1
+#
+#
+## Set up job environment
+source /cluster/bin/jobsetup
+# --------------------------------------------------------------------------
+# No need to change this section
+
+# Must set large stack size (unlimited for simplicity)
+ulimit -s unlimited
+# Set ulimit also to unlimited (probably not necessary)
+ulimit unlimited
+# Print out information about ulimit
+ulimit -a
+
+# allocate specified memory to each thread (100M)
+export THREAD_STACKSIZE=300m
+#   ifort uses KMP_STACKSIZE
+export KMP_STACKSIZE=$THREAD_STACKSIZE
+
+# number of OpenMP threads - i.e. number of CPUs requested
+export OMP_NUM_THREADS=$SLURM_NTASKS_PER_NODE
+
+# the PID number is first the date then an uniqe shell pid
+export PID=`date +"%d%m%y".$$`
+
+
+
+# Model input data
+export INPUT_DATA=/work/projects/cicero/ctm_input/Indata_CTM3
+
+# --------------------------------------------------------------------------
+# Do changes here
+
+# Model dir - enter your directory here
+export MODELDIR=$HOME/CTM3_DIR
+
+# Scenario name (use job name or whatever you like)
+export SCEN=$SLURM_JOB_NAME
+
+# Result directory (where your files end up)
+export RESULTDIR=$HOME/DONE.$SCEN
+
+# Set input file name
+export INPUTFILE=L60CTM.inp
+
+# Name of main program
+export PROGFILE=osloctm3
+
+# Job file (this file)
+export JOBFILE=c3run.job
+# Restart file is set below
+
+
+# ...Flytt programmet og tilhrende filer til work omrdet
+cp $MODELDIR/$PROGFILE         $SCRATCH/osloctm3
+cp $MODELDIR/$INPUTFILE        $SCRATCH/
+cp -r $MODELDIR/tables         $SCRATCH/
+ln -fs $INPUT_DATA             $SCRATCH/
+#   CTM3 restart
+cp -r ctm3_restartfile.sav     $SCRATCH/restart.sav
+# if e90-tracer is used, may need restart file
+cp $INPUT_DATA/restart_e90.sav $SCRATCH/
+
+
+# Go to work directory
+cd $SCRATCH
+
+# Run command
+./osloctm3 < $INPUTFILE > results.$PID
+
+
+## Make the result directory
+mkdir $RESULTDIR
+echo 'Program completed, copy to '$RESULTDIR
+# Copy files to result directory
+cp results.$PID     $RESULTDIR/
+cp avgsav*          $RESULTDIR/
+# copy restart file
+#cp restrt0036*          $RESULTDIR/
+cp *dta             $RESULTDIR/
+cp *.dat            $RESULTDIR/
+cp OSLO/Ltracer*    $RESULTDIR/
+cp *.inp            $RESULTDIR/
+cp *.job            $RESULTDIR/
+
+echo 'Results copied to '$RESULTDIR
+
+# Done
+# --------------------------------------------------------------------------
+
Index: c3run/old/emep_ppgs.inp
===================================================================
--- c3run/old/emep_ppgs.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/emep_ppgs.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,260 @@
+=== Oslo CTM3 v1.0 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 2005  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  366  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data: File name will be built from following info------------
+ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   38    1       met data cycle & revision number
+'/work/projects/cicero/ctm_input/metdataOpenIFS/'                 met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
+--- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
+    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
+ 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
+'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
+--- Roughness length (ZOI) ---
+ 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- Leaf area index ---
+ 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- EMEP parameter list ---
+    T  LDEPEMEP2012 Dry deposition scheme / T = EMEP based dry deposition scheme, F = old scheme
+'Indata_CTM3/DRYDEP/EMEP.par'
+--- PPFD directory and dummy filename ---
+'/projects/researchers/researchers01/sfalk/ctm_input/PPFD/'
+'ECopenIFSc38r1_yYYYYmMMdDDhHH_T159N80L60'
+--- Growing Season ---
+    T  LGSMAP Growing season (GDAY/GLEN) / T = Use preprocessed  maps, F = use fixed latitudinal bands
+'/projects/researchers/researchers01/sfalk/ctm_input/GROWING_SEASON/GROWING_SEASON_2005.nc'
+--- tracer specific section ---
+ T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_nitrate.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_ceds17_2005_megan_gfed4blhdaily.inp'    See ./tables/ for more
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+--------------------------------------------------------------------------------
Index: c3run/old/c3run_emep_ppgs_2005.job
===================================================================
--- c3run/old/c3run_emep_ppgs_2005.job	(.../ctm3f90)	(revision 0)
+++ c3run/old/c3run_emep_ppgs_2005.job	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,152 @@
+#!/bin/bash
+# Script for running on Abel.
+# --------------------------------------------------------------------------
+# Job name:
+#SBATCH --job-name=C3RUN_emep_ppgs_2005
+#
+# Project:
+#SBATCH --account=nn2806k
+#
+# Wall clock limit:
+#SBATCH --time=150:0:0
+#
+# Does your job exceed one week, use "--partition=long":
+# ####SBATCH --partition=long
+#
+# Max memory usage:
+#SBATCH --mem-per-cpu=3000M
+#
+# Number of cores:
+#SBATCH --ntasks-per-node=16
+#
+# Number of nodes:
+#SBATCH --nodes=1
+#
+#
+## Set up job environment
+source /cluster/bin/jobsetup
+# --------------------------------------------------------------------------
+# No need to change this section
+
+# Must set large stack size (unlimited for simplicity)
+ulimit -s unlimited
+# Set ulimit also to unlimited (probably not necessary)
+ulimit unlimited
+# Print out information about ulimit
+ulimit -a
+
+# allocate specified memory to each thread (100M)
+export THREAD_STACKSIZE=300m
+#   ifort uses KMP_STACKSIZE
+export KMP_STACKSIZE=$THREAD_STACKSIZE
+
+# number of OpenMP threads - i.e. number of CPUs requested
+export OMP_NUM_THREADS=$SLURM_NTASKS_PER_NODE
+
+# the PID number is first the date then an uniqe shell pid
+export PID=`date +"%d%m%y".$$`
+
+
+
+# Model input data
+export INPUT_DATA=$INPUT_OCTM3
+
+# --------------------------------------------------------------------------
+# Do changes here
+
+# Model dir - enter your directory here
+export MODELDIR=$CTM3_DIR
+
+# Scenario name (use job name or whatever you like)
+export SCEN=$SLURM_JOB_NAME
+
+# Scratch directory
+export SCRATCH=$WORK/$SCEN
+
+# Result directory (where your files end up)
+export RESULTDIR=$WORK/$SCEN.$PID
+
+# Directory for restart
+export RESTARTDIR=$RESULTDIR/restart_$PID
+
+# Set input file name
+export INPUTFILE=emep_ppgs.inp
+
+# Name of main program
+export PROGFILE=osloctm3
+
+# Job file (this file)
+export JOBFILE=c3run_emep_ppgs_2005.job
+
+# The dust file
+export DUSTFILE=OSLO/DEAD_COLUMN/dustinput/dst_T159.nc
+
+# A restart file
+export RESTARTFILE=/usit/abel/u1/sfalk/bin/restart.sav
+
+# Make the scratch directory
+if [ ! -d $SCRATCH ]; then mkdir $SCRATCH; fi 
+
+# Put svn info to slurm out
+cd $MODELDIR
+echo `svn info`
+# Go to work directory
+cd $SCRATCH
+
+# Restart file is set below
+# ...Move the program and the belonging files to $SCRATCH
+cp $MODELDIR/$PROGFILE         $SCRATCH/osloctm3
+cp $MODELDIR/$INPUTFILE        $SCRATCH/
+cp -r $MODELDIR/tables         $SCRATCH/
+ln -fs $INPUT_DATA             $SCRATCH/
+cp $MODELDIR/$DUSTFILE         $SCRATCH/ 
+#   CTM3 restart:  Has to be set accordingly ctm3_restartfile.sav
+cp $RESTARTFILE                $SCRATCH/restart.sav #
+#cp $RESTARTFILE                $SCRATCH/restart.nc
+# if e90-tracer is used, may need restart file
+cp $INPUT_DATA/restart_e90.sav $SCRATCH/
+# Copy the executing job file to $SCRATCH
+cp $0                          $SCRATCH/$JOBFILE
+
+
+
+
+# Run command
+./osloctm3 < $INPUTFILE > results.$PID
+
+
+## Make the result directory
+if [ ! -d $RESULTDIR ]; then mkdir $RESULTDIR; fi
+echo 'Program completed, copy to '$RESULTDIR
+# Copy files to result directory
+mv results.$PID     $RESULTDIR/
+mv avgsav*          $RESULTDIR/
+# Copy the results
+mkdir $RESULTDIR/'scavenging_daily'
+mv scavenging_daily*.nc            $RESULTDIR/'scavenging_daily'
+mkdir $RESULTDIR/'emis'
+mv emis*.nc                        $RESULTDIR/'emis'
+mv ctm3sltbudget.nc $RESULTDIR/
+mv dobson_nmet.nc   $RESULTDIR/
+mv ste*.nc          $RESULTDIR/
+mv *dta             $RESULTDIR/
+mv *.dat            $RESULTDIR/
+echo 'Results copied to '$RESULTDIR
+mv OSLO/Ltracer*    $RESULTDIR/
+#mv *.out            $RESULTDIR/
+# Copy restart file
+mkdir $RESTARTDIR
+mv *restart*.nc     $RESTARTDIR/
+mv osloctm3         $RESTARTDIR/
+mv *.job            $RESTARTDIR/
+mv *.inp            $RESTARTDIR/
+mv *.sav            $RESTARTDIR/
+mv dst_*.nc         $RESTARTDIR/
+cp -r tables        $RESTARTDIR/
+echo 'Results copied to '$RESTARTDIR
+# Move remaining .nc files
+mv *.nc             $RESULTDIR/
+
+# Done
+# --------------------------------------------------------------------------
+

Property changes on: c3run/old/c3run_emep_ppgs_2005.job
___________________________________________________________________
Added: svn:executable
   + *

Index: c3run/old/L60CTM.inp
===================================================================
--- c3run/old/L60CTM.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/L60CTM.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,251 @@
+=== Oslo CTM3 v1.0 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 2000  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data: File name will be built from following info------------
+ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   38    1       met data cycle & revision number
+'/work/projects/cicero/ctm_input/metdataOpenIFS/'                 met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
+--- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
+    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
+ 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
+'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
+--- Roughness length (ZOI) ---
+ 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- Leaf area index ---
+ 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- tracer specific section ---
+ T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_nitrate.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_ceds17_2000.inp'    See ./tables/ for more
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+--------------------------------------------------------------------------------
Index: c3run/old/L60T42newFastJX.inp
===================================================================
--- c3run/old/L60T42newFastJX.inp	(.../ctm3f90)	(revision 0)
+++ c3run/old/L60T42newFastJX.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,259 @@
+ === CTM p-code 5.5 with Oslo chemistry with EC met fields ===
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+ 2005  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+  367  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)
+    F  0 1: Clear sky J's
+    F  0 2: Averaged cloud cover
+    F  0 3: cloud-fract**3/2, then average cloud cover
+    F  0 4: Average direct solar beam over all ICA's, invert to get clouds
+    F  1 5: Random select NRANDO ICAs from all(Independent Column Atmos.)
+    F  0 6: Use all (up to 4) quadrature cloud cover QCA's (mid-pts of bin)
+    T  0 7: Use all (up to 4) QCA's (average clouds within each Q-bin)
+    F  0 8: Calcluate J's for ALL ICA's (up to 20,000 per cell!)
+   66  RANSEED
+    8    3    1  NRMETD=#met fields/day, NROPSM=#op split, NRCH=#chem sub-steps
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+/projects/geo/IFSL60/cy36_                               met field path1
+2000/T42_data/                                           met field path2
+EC001T42                                           met data fname
+  128   64   60  IMX x JMX x LMX = Longit x Latit x Eta-level of metfield grid
+  128   64   60  IM  x JM  x LM  = Longit x Latit x Eta-level of CTM run
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+-------file names for further data-------------------------------------
+'tables/P_meanT42.dat'          FILE annual mean pressure field, opened in INPUT
+    T  LISLSCP2 = switch for ISLSCP2 data (if true, use ISLSCP2, otherwise ISLSCP1)
+'Indata_CTM3/ISLSCP2/MODIS/modis_landcover_1deg/modis_landcover_1d_cXX.asc'       land frac and type
+'Indata_CTM3/ISLSCP2/FASIR/fasir_rough_1d_1982-1998/fasir_rough413_1d_YYYYMM.asc' roughness Zo
+'Indata_CTM3/ISLSCP2/FASIR/fasir_glai_1d_1982-1998/fasir_glai413_1d_YYYYMM.asc'   LAI
+*** ISLSCP 1 data ***
+'tables/landfr.dat'             FILE land fraction input file, opened in SURFSET
+'tables/LS_islscp88x.dat'       FILE land surface data (Zo, LAI, veg type) 
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+--- tracer specific section ---
+ T  1    LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+--- species information --- read tracer information from the following file
+'tables/chch_oc_nitrate.d'                  Tracer list
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_eclipse_V5_2010_meganMACC.inp'      'edgar4_megan_noch4_2000.inp'
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE          titles for tendencies, see pmain.f
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEM_1
+    8 = C_SCAV
+    9 = >SUMS<
+   10 = INST-M
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TTFTFFFFFF TFTFTFFFTF FFFFFFFFFT TTTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TTFTFFFFFF TFTFTFFFTF FFFFFFFFFF FFTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFTFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF TFTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFTFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF TFTTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+    0     # of tracer global local time diag. LT may be adjusted
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+=========3-D unf inst.(select AIR & TRACER m/m) from start to K3DMAX, then stops
+K3DMAX      900   F FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Index: c3run/old/c3run_emep_full.job
===================================================================
--- c3run/old/c3run_emep_full.job	(.../ctm3f90)	(revision 0)
+++ c3run/old/c3run_emep_full.job	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,152 @@
+#!/bin/bash
+# Script for running on Abel.
+# --------------------------------------------------------------------------
+# Job name:
+#SBATCH --job-name=C3RUN_emep_full
+#
+# Project:
+#SBATCH --account=nn2806k
+#
+# Wall clock limit:
+#SBATCH --time=166:0:0
+#
+# Does your job exceed one week, use "--partition=long":
+# ####SBATCH --partition=long
+#
+# Max memory usage:
+#SBATCH --mem-per-cpu=3000M
+#
+# Number of cores:
+#SBATCH --ntasks-per-node=16
+#
+# Number of nodes:
+#SBATCH --nodes=1
+#
+#
+## Set up job environment
+source /cluster/bin/jobsetup
+# --------------------------------------------------------------------------
+# No need to change this section
+
+# Must set large stack size (unlimited for simplicity)
+ulimit -s unlimited
+# Set ulimit also to unlimited (probably not necessary)
+ulimit unlimited
+# Print out information about ulimit
+ulimit -a
+
+# allocate specified memory to each thread (100M)
+export THREAD_STACKSIZE=300m
+#   ifort uses KMP_STACKSIZE
+export KMP_STACKSIZE=$THREAD_STACKSIZE
+
+# number of OpenMP threads - i.e. number of CPUs requested
+export OMP_NUM_THREADS=$SLURM_NTASKS_PER_NODE
+
+# the PID number is first the date then an uniqe shell pid
+export PID=`date +"%d%m%y".$$`
+
+
+
+# Model input data
+export INPUT_DATA=$INPUT_OCTM3
+
+# --------------------------------------------------------------------------
+# Do changes here
+
+# Model dir - enter your directory here
+export MODELDIR=$CTM3_DIR
+
+# Scenario name (use job name or whatever you like)
+export SCEN=$SLURM_JOB_NAME
+
+# Scratch directory
+export SCRATCH=$WORK/$SCEN
+
+# Result directory (where your files end up)
+export RESULTDIR=$WORK/$SCEN.$PID
+
+# Directory for restart
+export RESTARTDIR=$RESULTDIR/restart_$PID
+
+# Set input file name
+export INPUTFILE=emep_full.inp
+
+# Name of main program
+export PROGFILE=osloctm3
+
+# Job file (this file)
+export JOBFILE=c3run_emep_full.job
+
+# The dust file
+export DUSTFILE=OSLO/DEAD_COLUMN/dustinput/dst_T159.nc
+
+# A restart file
+export RESTARTFILE=/usit/abel/u1/sfalk/bin/restart.sav
+
+# Make the scratch directory
+if [ ! -d $SCRATCH ]; then mkdir $SCRATCH; fi 
+
+# Put svn info to slurm out
+cd $MODELDIR
+echo `svn info`
+# Go to work directory
+cd $SCRATCH
+
+# Restart file is set below
+# ...Move the program and the belonging files to $SCRATCH
+cp $MODELDIR/$PROGFILE         $SCRATCH/osloctm3
+cp $MODELDIR/$INPUTFILE        $SCRATCH/
+cp -r $MODELDIR/tables         $SCRATCH/
+ln -fs $INPUT_DATA             $SCRATCH/
+cp $MODELDIR/$DUSTFILE         $SCRATCH/ 
+#   CTM3 restart:  Has to be set accordingly ctm3_restartfile.sav
+cp $RESTARTFILE                $SCRATCH/restart.sav #
+#cp $RESTARTFILE                $SCRATCH/restart.nc
+# if e90-tracer is used, may need restart file
+cp $INPUT_DATA/restart_e90.sav $SCRATCH/
+# Copy the executing job file to $SCRATCH
+cp $0                          $SCRATCH/$JOBFILE
+
+
+
+
+# Run command
+./osloctm3 < $INPUTFILE > results.$PID
+
+
+## Make the result directory
+if [ ! -d $RESULTDIR ]; then mkdir $RESULTDIR; fi
+echo 'Program completed, copy to '$RESULTDIR
+# Copy files to result directory
+mv results.$PID     $RESULTDIR/
+mv avgsav*          $RESULTDIR/
+# Copy the results
+mkdir $RESULTDIR/'scavenging_daily'
+mv scavenging_daily*.nc            $RESULTDIR/'scavenging_daily'
+mkdir $RESULTDIR/'emis'
+mv emis*.nc                        $RESULTDIR/'emis'
+mv ctm3sltbudget.nc $RESULTDIR/
+mv dobson_nmet.nc   $RESULTDIR/
+mv ste*.nc          $RESULTDIR/
+mv *dta             $RESULTDIR/
+mv *.dat            $RESULTDIR/
+echo 'Results copied to '$RESULTDIR
+mv OSLO/Ltracer*    $RESULTDIR/
+#mv *.out            $RESULTDIR/
+# Copy restart file
+mkdir $RESTARTDIR
+mv *restart*.nc     $RESTARTDIR/
+mv osloctm3         $RESTARTDIR/
+mv *.job            $RESTARTDIR/
+mv *.inp            $RESTARTDIR/
+mv *.sav            $RESTARTDIR/
+mv dst_*.nc         $RESTARTDIR/
+cp -r tables        $RESTARTDIR/
+echo 'Results copied to '$RESTARTDIR
+# Move remaining .nc files
+mv *.nc             $RESULTDIR/
+
+# Done
+# --------------------------------------------------------------------------
+
Index: c3run/old/c3run_emep_offLight.job
===================================================================
--- c3run/old/c3run_emep_offLight.job	(.../ctm3f90)	(revision 0)
+++ c3run/old/c3run_emep_offLight.job	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,152 @@
+#!/bin/bash
+# Script for running on Abel.
+# --------------------------------------------------------------------------
+# Job name:
+#SBATCH --job-name=C3RUN_emep_offLight
+#
+# Project:
+#SBATCH --account=nn2806k
+#
+# Wall clock limit:
+#SBATCH --time=166:0:0
+#
+# Does your job exceed one week, use "--partition=long":
+# ####SBATCH --partition=long
+#
+# Max memory usage:
+#SBATCH --mem-per-cpu=3000M
+#
+# Number of cores:
+#SBATCH --ntasks-per-node=16
+#
+# Number of nodes:
+#SBATCH --nodes=1
+#
+#
+## Set up job environment
+source /cluster/bin/jobsetup
+# --------------------------------------------------------------------------
+# No need to change this section
+
+# Must set large stack size (unlimited for simplicity)
+ulimit -s unlimited
+# Set ulimit also to unlimited (probably not necessary)
+ulimit unlimited
+# Print out information about ulimit
+ulimit -a
+
+# allocate specified memory to each thread (100M)
+export THREAD_STACKSIZE=300m
+#   ifort uses KMP_STACKSIZE
+export KMP_STACKSIZE=$THREAD_STACKSIZE
+
+# number of OpenMP threads - i.e. number of CPUs requested
+export OMP_NUM_THREADS=$SLURM_NTASKS_PER_NODE
+
+# the PID number is first the date then an uniqe shell pid
+export PID=`date +"%d%m%y".$$`
+
+
+
+# Model input data
+export INPUT_DATA=$INPUT_OCTM3
+
+# --------------------------------------------------------------------------
+# Do changes here
+
+# Model dir - enter your directory here
+export MODELDIR=$CTM3_DIR
+
+# Scenario name (use job name or whatever you like)
+export SCEN=$SLURM_JOB_NAME
+
+# Scratch directory
+export SCRATCH=$WORK/$SCEN
+
+# Result directory (where your files end up)
+export RESULTDIR=$WORK/$SCEN.$PID
+
+# Directory for restart
+export RESTARTDIR=$RESULTDIR/restart_$PID
+
+# Set input file name
+export INPUTFILE=emep_offLight.inp
+
+# Name of main program
+export PROGFILE=osloctm3
+
+# Job file (this file)
+export JOBFILE=c3run_emep_offLight.job
+
+# The dust file
+export DUSTFILE=OSLO/DEAD_COLUMN/dustinput/dst_T159.nc
+
+# A restart file
+export RESTARTFILE=/usit/abel/u1/sfalk/bin/restart.sav
+
+# Make the scratch directory
+if [ ! -d $SCRATCH ]; then mkdir $SCRATCH; fi 
+
+# Put svn info to slurm out
+cd $MODELDIR
+echo `svn info`
+# Go to work directory
+cd $SCRATCH
+
+# Restart file is set below
+# ...Move the program and the belonging files to $SCRATCH
+cp $MODELDIR/$PROGFILE         $SCRATCH/osloctm3
+cp $MODELDIR/$INPUTFILE        $SCRATCH/
+cp -r $MODELDIR/tables         $SCRATCH/
+ln -fs $INPUT_DATA             $SCRATCH/
+cp $MODELDIR/$DUSTFILE         $SCRATCH/ 
+#   CTM3 restart:  Has to be set accordingly ctm3_restartfile.sav
+cp $RESTARTFILE                $SCRATCH/restart.sav #
+#cp $RESTARTFILE                $SCRATCH/restart.nc
+# if e90-tracer is used, may need restart file
+cp $INPUT_DATA/restart_e90.sav $SCRATCH/
+# Copy the executing job file to $SCRATCH
+cp $0                          $SCRATCH/$JOBFILE
+
+
+
+
+# Run command
+./osloctm3 < $INPUTFILE > results.$PID
+
+
+## Make the result directory
+if [ ! -d $RESULTDIR ]; then mkdir $RESULTDIR; fi
+echo 'Program completed, copy to '$RESULTDIR
+# Copy files to result directory
+mv results.$PID     $RESULTDIR/
+mv avgsav*          $RESULTDIR/
+# Copy the results
+mkdir $RESULTDIR/'scavenging_daily'
+mv scavenging_daily*.nc            $RESULTDIR/'scavenging_daily'
+mkdir $RESULTDIR/'emis'
+mv emis*.nc                        $RESULTDIR/'emis'
+mv ctm3sltbudget.nc $RESULTDIR/
+mv dobson_nmet.nc   $RESULTDIR/
+mv ste*.nc          $RESULTDIR/
+mv *dta             $RESULTDIR/
+mv *.dat            $RESULTDIR/
+echo 'Results copied to '$RESULTDIR
+mv OSLO/Ltracer*    $RESULTDIR/
+#mv *.out            $RESULTDIR/
+# Copy restart file
+mkdir $RESTARTDIR
+mv *restart*.nc     $RESTARTDIR/
+mv osloctm3         $RESTARTDIR/
+mv *.job            $RESTARTDIR/
+mv *.inp            $RESTARTDIR/
+mv *.sav            $RESTARTDIR/
+mv dst_*.nc         $RESTARTDIR/
+cp -r tables        $RESTARTDIR/
+echo 'Results copied to '$RESTARTDIR
+# Move remaining .nc files
+mv *.nc             $RESULTDIR/
+
+# Done
+# --------------------------------------------------------------------------
+
Index: c3run/c3run_emeppar_example.job
===================================================================
--- c3run/c3run_emeppar_example.job	(.../ctm3f90)	(revision 0)
+++ c3run/c3run_emeppar_example.job	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,162 @@
+#!/bin/bash
+# Script for running on Abel.
+# --------------------------------------------------------------------------
+# Job name (enter your distinct job name):
+#SBATCH --job-name=C3RUN_emep
+#
+# Project (enter your noturn project number):
+#SBATCH --account=nn2806k
+#
+# Wall clock limit (setting for one year 96:0:0):
+#SBATCH --time=0:30:0
+#
+# Does your job exceed one week, use "--partition=long":
+# ####SBATCH --partition=long
+#
+# Max memory usage:
+#SBATCH --mem-per-cpu=3000M
+#
+# Number of cores:
+#SBATCH --ntasks-per-node=16
+#
+# Number of nodes:
+#SBATCH --nodes=1
+#
+#
+## Set up job environment
+source /cluster/bin/jobsetup
+# --------------------------------------------------------------------------
+# No need to change this section
+
+# Must set large stack size (unlimited for simplicity)
+ulimit -s unlimited
+# Set ulimit also to unlimited (probably not necessary)
+ulimit unlimited
+# Print out information about ulimit
+ulimit -a
+
+# allocate specified memory to each thread (100M)
+export THREAD_STACKSIZE=300m
+#   ifort uses KMP_STACKSIZE
+export KMP_STACKSIZE=$THREAD_STACKSIZE
+
+# number of OpenMP threads - i.e. number of CPUs requested
+export OMP_NUM_THREADS=$SLURM_NTASKS_PER_NODE
+
+# the PID number is first the date then an uniqe shell pid
+export PID=`date +"%d%m%y".$$`
+
+# --------------------------------------------------------------------------
+# Do changes here
+# --------------------------------------------------------------------------
+# Model input data
+export INPUT_DATA=$INPUT_OCTM3
+
+# Model dir - enter your directory here
+export MODELDIR=$CTM3_DIR
+
+# Project/scenario diectory (place of this file and your .inp)
+export SCENDIR=c3run
+
+# Scenario name (use job name or whatever you like)
+export SCEN=$SLURM_JOB_NAME
+
+# Scratch directory
+export SCRATCH=$WORK/$SCEN
+
+# Result directory (where your files end up)
+export RESULTDIR=$WORK/$SCEN.$PID
+
+# Directory for restart
+export RESTARTDIR=$RESULTDIR/restart_$PID
+
+# Set input file name
+export INPUTFILE=emeppar_example.inp
+
+# Name of main program
+export PROGFILE=osloctm3
+
+# Job file (this file)
+export JOBFILENAME=c3run_emeppar_example.job
+
+# The dust file
+export DUSTFILE=OSLO/DEAD_COLUMN/dustinput/dst_T159.nc
+
+# A restart file (old = .sav, new = .nc) 
+# - Set copy statement below accordingly.
+export RESTARTFILE=/projects/researchers/researchers01/sfalk/ctm_input/restart.sav
+
+# --------------------------------------------------------------------------
+# Initialize the model run
+# --------------------------------------------------------------------------
+# Make the scratch directory
+if [ ! -d $SCRATCH ]; then mkdir $SCRATCH; fi 
+
+# Put svn info to slurm out
+cd $MODELDIR
+echo `svn info`
+
+
+
+# Move the program and the necessary files to $SCRATCH
+cp $MODELDIR/$PROGFILE                  $SCRATCH/osloctm3
+cp $MODELDIR/$SCENDIR/$INPUTFILE        $SCRATCH/
+cp -r $MODELDIR/tables                  $SCRATCH/
+ln -fs $INPUT_DATA                      $SCRATCH/
+cp $MODELDIR/$DUSTFILE                  $SCRATCH/
+ 
+# CTM3 restart:  Has to be set accordingly ctm3_restartfile.sav
+cp $RESTARTFILE                $SCRATCH/restart.sav #
+#cp $RESTARTFILE                $SCRATCH/restart.nc
+
+# if e90-tracer is used, may need restart file
+cp $INPUT_DATA/restart_e90.sav $SCRATCH/
+
+# Copy the executing job file to $SCRATCH
+cp $0                          $SCRATCH/$JOBFILENAME
+
+# Go to work directory
+cd $SCRATCH
+
+#----------------------------------------------------------------------------
+# Run the model
+#----------------------------------------------------------------------------
+./osloctm3 < $INPUTFILE > results.$PID
+#----------------------------------------------------------------------------
+
+## Make the result directory
+if [ ! -d $RESULTDIR ]; then mkdir $RESULTDIR; fi
+echo 'Program completed, copy to '$RESULTDIR
+# Copy files to result directory
+mv results.$PID     $RESULTDIR/
+mv avgsav*          $RESULTDIR/
+# Copy the results
+mkdir $RESULTDIR/'scavenging_daily'
+mv scavenging_daily*.nc            $RESULTDIR/'scavenging_daily'
+mkdir $RESULTDIR/'emis'
+mv emis*.nc                        $RESULTDIR/'emis'
+mv ctm3sltbudget.nc $RESULTDIR/
+mv dobson_nmet.nc   $RESULTDIR/
+mv ste*.nc          $RESULTDIR/
+mv *dta             $RESULTDIR/
+mv *.dat            $RESULTDIR/
+echo 'Results copied to '$RESULTDIR
+mv OSLO/Ltracer*    $RESULTDIR/
+#mv *.out            $RESULTDIR/
+# Copy restart file
+mkdir $RESTARTDIR
+mv *restart*.nc     $RESTARTDIR/
+mv osloctm3         $RESTARTDIR/
+mv *.job            $RESTARTDIR/
+mv *.inp            $RESTARTDIR/
+mv *.sav            $RESTARTDIR/
+mv dst_*.nc         $RESTARTDIR/
+cp -r tables        $RESTARTDIR/
+echo 'Results copied to '$RESTARTDIR
+# Move remaining .nc files
+# and sort them afterwards
+mv *.nc             $RESULTDIR/
+
+# Done
+# --------------------------------------------------------------------------
+
Index: c3run/emeppar_example.inp
===================================================================
--- c3run/emeppar_example.inp	(.../ctm3f90)	(revision 0)
+++ c3run/emeppar_example.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,271 @@
+=== Oslo CTM3 v1.0 w/Oslo chemistry and EC met fields ===
+--------------------------------------------------------------------------------
+ 2005  IYEAR = reference year to which NDAI/NDAYE are offset
+    1  NDAYI = day of year to begin CTM run at 0000 hhmm UT (can be >365)
+    2  NDAYE = day at end of CTM run, finishes at end of day=NDAYE-1
+--------------------------------------------------------------------------------
+    F  LCLDQMD  = Mid point of quadrature cloud cover ICAs                     
+    F  LCLDQMN  = Mean quadrature cloud cover ICAs                             
+    T  LCLDRANA = Random selected from all cloud cover ICAs                    
+    F  LCLDRANQ = Random selected from 4 Mean quadrature cloud cover ICAs      
+   66  RANSEED
+    3    1  NROPSM=#op split, NRCH=#chem sub-steps (NRMETD=#met fields/day are fixed)
+    F  LJCCYC = F if J-values only the first NRCHEM (once every NOPS)
+    2  LMTSOM =1,2,3= SOM limiter:  2=monotonic, 3=min/max
+0.950  CFLLIM = max amount taken from box w/global CFL limit (divergence only!)
+----Meteorological data: File name will be built from following info------------
+ECMWF_oIFSnc4       met data type (ECMWF_oIFSnc4/ECMWF_oIFS/ECMWF_IFS)
+   38    1       met data cycle & revision number
+'/work/projects/cicero/ctm_input/metdataOpenIFS/'                 met data root
+    F  LLPYR = allow for leap year (if true, looks for day=901 for Feb 29)
+    T  LFIXMET = annually recycle met field (do not allow leap year)           
+    0  JMPOLR (if .not.LGAUGRD) =0 =>polar box same delta-lat as others, =1=>halfsize
+  1.5  GM0000 = I-coord of Greenwich M: 1.5=>mid-[1] on GM, 65.0=>left[1] at dateline
+----Vertical ETAA & ETAB levels w/possible collapsing of layers-----------------
+    L  LMMAP      eta-A            eta-B
+    1    1      0.000000000000   1.000000000000
+    2    2      0.000000000000   0.997630120000
+    3    3      7.367743000000   0.994019450000
+    4    4     65.889244000000   0.988270100000
+    5    5    210.393890000000   0.979662720000
+    6    6    467.333588000000   0.967645230000
+    7    7    855.361755000000   0.951821510000
+    8    8   1385.912598000000   0.931940320000
+    9    9   2063.779785000000   0.907883880000
+   10   10   2887.696533000000   0.879656910000
+   11   11   3850.913330000000   0.847374920000
+   12   12   4941.778320000000   0.811253430000
+   13   13   6144.314941000000   0.771596610000
+   14   14   7438.803223000000   0.728785810000
+   15   15   8802.356444999999   0.683268610000
+   16   16  10209.500977000000   0.635547460000
+   17   17  11632.758789000000   0.586168410000
+   18   18  13043.218750000000   0.535709920000
+   19   19  14411.124023000000   0.484771580000
+   20   20  15706.447265999999   0.433962940000
+   21   21  16899.468750000000   0.383892150000
+   22   22  17961.357422000001   0.335154890000
+   23   23  18864.750000000000   0.288322960000
+   24   24  19584.330077999999   0.243933140000
+   25   25  20097.402343999998   0.202475940000
+   26   26  20384.480468999998   0.164384320000
+   27   27  20429.863281000002   0.130022510000
+   28   28  20222.205077999999   0.099674690000
+   29   29  19755.109375000000   0.073533830000
+   30   30  19027.695313000000   0.051690410000
+   31   31  18045.183593999998   0.034121160000
+   32   32  16819.474609000001   0.020677880000
+   33   33  15379.805664000000   0.011142910000
+   34   34  13775.325194999999   0.005081120000
+   35   35  12077.446289000000   0.001815160000
+   36   36  10376.126953000001   0.000461390000
+   37   37   8765.053711000000   0.000075820000
+   38   38   7306.631348000000   0.000000000000
+   39   39   6018.019531000000   0.000000000000
+   40   40   4906.708496000000   0.000000000000
+   41   41   3960.291504000000   0.000000000000
+   42   42   3196.421631000000   0.000000000000
+   43   43   2579.888672000000   0.000000000000
+   44   44   2082.273926000000   0.000000000000
+   45   45   1680.640259000000   0.000000000000
+   46   46   1356.474609000000   0.000000000000
+   47   47   1094.834717000000   0.000000000000
+   48   48    883.660522000000   0.000000000000
+   49   49    713.218079000000   0.000000000000
+   50   50    575.651001000000   0.000000000000
+   51   51    464.618134000000   0.000000000000
+   52   52    373.971924000000   0.000000000000
+   53   53    298.495789000000   0.000000000000
+   54   54    234.779053000000   0.000000000000
+   55   55    180.584351000000   0.000000000000
+   56   56    134.483307000000   0.000000000000
+   57   57     95.636963000000   0.000000000000
+   58   58     63.647804000000   0.000000000000
+   59   59     38.425343000000   0.000000000000
+   60   60     20.000000000000   0.000000000000
+   61   61      2.000000000000   0.000000000000
+PFZON  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+    5  NBLX =1,2,3,4,5= (Prather, H&R, Louis, M-Y2.5, Holtz) !! now only = 1 !!
+    0  NDPX dry deposition scheme, now only simple version = 0
+    1  NSCX scavenging scheme: 0 = tables, 1 = new washout/rainout (Neu)
+----file names for further data-------------------------------------------------
+'tables/P_meanT319_IFScy36r1_2005.nc'    FILE annual mean pressure field
+--- Land surface type fractions (landSurfTypeFrac) and land fraction (PLAND) ---
+    3  LANDUSE_IDX  Index for land use / PFT files. 2 = MODIS, 3 = CLM4
+ 9999  LANDUSE_YEAR Year of the land use dataset (9999=meteorological year)
+'Indata_CTM3/surface/pftlandusedyn.0.5x0.5.gcp2015.simyr1860-2015.c160715.nc'
+--- Roughness length (ZOI) ---
+ 0000  ZOI_YEAR Year of the Z0 (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/rough_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- Leaf area index ---
+ 0000  LAI_YEAR Year of the LAI (9999=meteorological year, 0000: climatology 1982-1998)
+'Indata_CTM3/surface/lai_islscp2_fasir_0.25x0.25_1982_1998.nc'
+--- EMEP parameter list ---
+    T  LDEPEMEP2012 Dry deposition scheme / T = EMEP based dry deposition scheme, F = old scheme
+'Indata_CTM3/DRYDEP/EMEP.par'
+--- PPFD directory and dummy filename ---
+'/projects/researchers/researchers01/sfalk/ctm_input/PPFD/'
+'ECopenIFSc38r1_yYYYYmMMdDDhHH_T159N80L60'
+--- Growing Season ---
+    T  LGSMAP Growing season (GDAY/GLEN) / T = Use preprocessed  maps, F = use fixed latitudinal bands
+'/projects/researchers/researchers01/sfalk/ctm_input/GROWING_SEASON/GROWING_SEASON_2005.nc'
+--- tracer specific section ---
+ T  1  LCONT T: start from restart file, F: set START_AVG: 0: start from STT=0, 1: CTM3 average, 2: CTM2 average
+    F  LNCR T: use restart file in netCDF, F: old .sav format
+--- species information / tracer list --- read from the following file
+'tables/tracer_list_nitrate.d'
+--- General multi-species wet scavenging data set:  call WETSET_CTM3
+'tables/scavenging_wet.inp'            WET deposition data set
+--- General multi-species dry scavenging data set:  call DRYSET_CTM3
+'tables/scavenging_dry.inp'            DRY deposition data set
+--- Emission list ---
+'tables/Ltracer_emis_ceds17_2005_megan_gfed4blhdaily.inp'    See ./tables/ for more
+--------------------------------------------------------------------------------
+---- DIAGNOSTICS ---------------------------------------------------------------
+LDUMP3HRS - T: Write diagnostic 3 hourly output and monthly means of defined tracers; F: Do not
+   all air trp sul slt min nit bio moa ffc bfc soa
+    T  T  T  T  F  T  F  T  T  T  T  T
+LSTOM1HRS - T: Write diagnostic 1 hourly output of GstO3 and FstO3; F: Do not
+    T  
+LDLYSCAV - T: Write daily total and 2d scavenging; F: Do not
+   TOT 2D brd ls cnv dry sto 
+    T  T  T  T  T  T  T
+--------------------------------------------------------------------------------
+===== CONT = write restart (Continuation) file (unformatted)
+     123456789.123456789.123456789.1              JDO_C
+JAN _1000000000000000000000000000000  001 - 031
+FEB _00000000000000000000000000000    032 - 060
+MAR _0000000000000000000000000000000  061 - 091
+APR _000000000000000000000000000000   092 - 121
+MAY _0000000000000000000000000000000  122 - 152
+JUN _000000000000000000000000000000   153 - 182
+JUL _0000000000000000000000000000000  183 - 213
+AUG _0000000000000000000000000000000  214 - 244
+SEP _000000000000000000000000000000   245 - 274
+OCT _0000000000000000000000000000000  275 - 305
+NOV _000000000000000000000000000000   306 - 335
+DEC _0000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== BUDGET tendencies calendar (unf + some form output)
+     123456789.123456789.123456789.1              JDO_T
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+    8 # CATEGORIES for tendency budgets
+    1 = SOURCE
+    2 = BNDLYR
+    3 = DRYDEP
+    4 = UV_ADV
+    5 = W_ADV_
+    6 = LSSCAV
+    7 = CHEMIS
+    8 = CNSCAV
+Tendency Budgets air N=1:10    11:20      21:30      31:40      41:50      51:60      61:70      71:80      81:90      91:100
+1-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+2-D tend bdgts:   F TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+NBOXD 12  3D blk title   longitude--range latitude--range Lbeg-Lend
+box    1  S.Hem./Strat       0.00   -2.00  -90.00  -28.00   25   37
+box    2  Tropic/Strat       0.00   -2.00  -27.50   27.50   25   37
+box    3  N.Hem./Strat       0.00   -2.00   28.00   90.00   25   37
+box    4  S.Hem./Global      0.00   -2.00  -90.00    0.00    1   37
+box    5  N.Hem./Global      0.00   -2.00    0.50   90.00    1   37
+box    6  China /B.Layer   100.00  127.00   22.50   42.00    1   12
+box    7  China /Mid.Trp   100.00  127.00   22.50   42.00   13   21
+box    8  China /Upp.Trp   100.00  127.00   22.50   42.00   22   29
+box    9  U.S.A./B.Layer  -125.00  -70.00   28.00   48.00    1   12
+box   10  U.S.A./Mid.Trp  -125.00  -70.00   28.00   48.00   13   21
+box   11  U.S.A./Upp.Trp  -125.00  -70.00   28.00   48.00   22   29
+box   12  ATLAT /Global    -75.00   15.00  -75.00   75.00    1   37
+--------------------------------------------------------------------------------
+===== AVERAGES 3-D tracer mass fraction(all tracers, unf), if 2(stdout 1-D prof)
+     123456789.123456789.123456789.1             JDO_A
+JAN _2000000000000000000000000000000  001 - 031
+FEB _20000000000000000000000000000    032 - 060
+MAR _2000000000000000000000000000000  061 - 091
+APR _200000000000000000000000000000   092 - 121
+MAY _2000000000000000000000000000000  122 - 152
+JUN _200000000000000000000000000000   153 - 182
+JUL _2000000000000000000000000000000  183 - 213
+AUG _2000000000000000000000000000000  214 - 244
+SEP _200000000000000000000000000000   245 - 274
+OCT _2000000000000000000000000000000  275 - 305
+NOV _200000000000000000000000000000   306 - 335
+DEC _2000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+===== STE-flux output                            JDO_X
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+--------------------------------------------------------------------------------
+      tracers for stdout of 1-D average profiles for the tendency boxes(NBOXD)
+1-D avg profiles:   TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+--------------------------------------------------------------------------------
+==========time series (at 24/(NRMETD*NROPSM)) at stations for all L----
+     123456789.123456789.123456789.1
+JAN _1000000000000000000000000000000  001 - 031
+FEB _10000000000000000000000000000    032 - 060
+MAR _1000000000000000000000000000000  061 - 091
+APR _100000000000000000000000000000   092 - 121
+MAY _1000000000000000000000000000000  122 - 152
+JUN _100000000000000000000000000000   153 - 182
+JUL _1000000000000000000000000000000  183 - 213
+AUG _1000000000000000000000000000000  214 - 244
+SEP _100000000000000000000000000000   245 - 274
+OCT _1000000000000000000000000000000  275 - 305
+NOV _100000000000000000000000000000   306 - 335
+DEC _1000000000000000000000000000000  336 - 366
+   30 stations L(N)=TFFTFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF FFFFFFFFFF
+statn  1  Alert          82.45   -1.20   LAT/LNG
+statn  2  Pt. Barrow     71.32 -156.61
+statn  3  Rorvik         57.00   12.00
+statn  4  Mace Head      53.32   -9.88
+statn  5  Hohenpssnb     47.48   11.01
+statn  6  Payerne        46.82    6.95
+statn  7  Harvard Fo     43.00  -79.00
+statn  8  Niwot Ridg     40.04 -105.58
+statn  9  Azores         38.75   27.08
+statn 10  Wallops Is     37.90  -75.50
+statn 11  Bermuda        32.00  -64.00
+statn 12  Mauna Loa      19.54 -155.58
+statn 13  Cp. Kumaka     19.54 -155.58
+statn 14  Barbados       13.17  -59.43
+statn 15  Natal          -5.92  -35.17
+statn 16  Ascension      -7.98  -14.42
+statn 17  Amazon        -10.00  -50.00
+statn 18  Am. Samoa     -14.23  170.56
+statn 19  Cuiaba        -15.60  -56.10
+statn 20  Cape Grim     -40.41  144.69
+statn 21  Neumayer      -70.00   -8.00
+statn 22  South Pole    -90.00     .00
+statn 23  Taibei         25.03  121.52
+statn 24  Tokyo          35.68  139.77
+statn 25  Guam           13.22  145.33
+statn 26  Shemya         52.92  174.06
+statn 27  Mauna Loa      19.53 -155.58
+statn 28  Anchorage      61.17 -150.02
+statn 29  San Frans      37.62 -122.38
+statn 30  Quito           0.22  -78.53
+-------Stations local time diags------------------------------------------------
+    0 stations for local time diag. LT may be adjusted to fit at least one pnt
+-------Tracers for local time diags at stations---------------------------------
+    0     # of tracer global local time diag. LT may be adjusted
+--------------------------------------------------------------------------------
Index: metdata_ecmwf.f90
===================================================================
--- metdata_ecmwf.f90	(.../ctm3f90)	(revision 243)
+++ metdata_ecmwf.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -193,8 +193,8 @@
           end if
           write(CUTC(1:2),'(i2.2)') (NMET_NEXT - 1) * 24/NRMETD    ! Time UTC
        end if
-       write(MFILE3(16:29),'(a1,i4.4,a1,a2,a1,a2,a1,a2)') &
-            'y',i,'m',CMON,'d',CDATE,'h',CUTC
+       write(MFILE3(16:29),'(a1,i4.4,a1,i2.2,a1,a2,a1,a2)') &
+            'y',i,'m',JMON_NEXT,'d',CDATE,'h',CUTC
        FNAME_NEXT  = trim(MPATH1)//trim(MPATH2)//'/'//CMON//'/'// &
             trim(MFILE3)//'.nc'
 
@@ -1228,7 +1228,7 @@
        call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
             JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
        R8XY(:,:) = R8XY(:,:) * ZDT
-       call dust_set_ssrd(R8XY)
+       call dust_set_ssrd(SWVL1)
        if (verbose) call gotData('2da','Surface Solar Radiation Downwards (SSRD)')
     else
        !// Surface Solar Radiation Downwards (SSRD) (accumulated)
Index: pmain.f90
===================================================================
--- pmain.f90	(.../ctm3f90)	(revision 243)
+++ pmain.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -19,7 +19,8 @@
   use cmn_ctm, only: AIR, LYEAR, GMTAU, NRMETD, NROPSM, NRCHEM, JDATE, &
        JDAY, JMON, JYEAR, NTM, IDAY, IYEAR, LLPYR, LFIXMET, TMON, TMET, &
        JDAY_NEXT, JDATE_NEXT, JMON_NEXT, JYEAR_NEXT, &
-       SOLDEC, SOLDIS, LCONT, modelTimeIntegrated
+       SOLDEC, SOLDIS, LCONT, modelTimeIntegrated, &
+       LSTOM1HRS, LDLYSCAV
   use cmn_chem, only: N_LZ, N_STE, LZLBO3, O3iso1,O3iso2
   use cmn_diag, only: NTDPAR, USTEP, VSTEP, WSTEP, JMON0, LFLXDG, LMXDG, &
        STTTND, NDAY0, JDO_A, JDO_C, JDO_X, JDO_T, &
@@ -28,6 +29,7 @@
   use cmn_fjx, only: JVN_
   use cmn_met, only: MYEAR
   use cmn_parameters, only: LDEBUG
+  use cmn_sfc, only: LDEPEMEP2012
   !//-----------------------------------------------------------------------
   use averages, only: AVG_P1, AVG_WRT_NC4, AVG_ADD2, AVG_CLR2
   use budgets, only: TBGT_G, TBGT_P0, TBGT_P1, TBGT_P2, TBGT_IJ, TBGT_L
@@ -59,7 +61,8 @@
        mp_diag, TBGT_2FILE, reports_chemistry, &
        tnd_emis2file, chembud_output
   use diagnostics_scavenging, only: &
-       scav_diag_ls, scav_diag_cn, scav_diag_brd, scav_diag_2fileA
+       scav_diag_ls, scav_diag_cn, scav_diag_brd, scav_diag_2fileA, &
+       scav_diag_nmet_output_nc
   use drydeposition_oslo, only: setdrydep
   use dust_oslo, only: dustbdg2file, dustInstBdg
   use emissions_ocean, only: emissions_ocean_total
@@ -75,7 +78,7 @@
   !//-----------------------------------------------------------------------
   use stratchem_oslo, only: update_strat_boundaries
   use strat_h2o, only: set_h2_eurohydros
-  use soa_oslo, only: soa_diag2file_nc4, soa_nopsdiag
+  use soa_oslo, only: soa_diag2file, soa_nopsdiag
   use fallingaerosols, only: aerosolsettling
   !//-----------------------------------------------------------------------
   implicit none
@@ -272,7 +275,7 @@
         !// Set climatological mass, O3 & T above CTM
         call SET_ATM
         !// Find lightning
-        call LIGHTNING_OAS2015(NDAY,NDAYI,DTMET,LNEWM,NMET)
+        call LIGHTNING_OAS2015(NDAY,NDAYI,DTMET,LNEWM)
         NCLDRAN   = 0
       end if
       call DYN0 (DTMET)             ! process wind/advection fields
@@ -341,7 +344,7 @@
         !// Remember that for asynchronous chemistry/transport
         !// steps, the previous process MAY NOT BE transport.
         call nops_diag(JYEAR,JMON,JDATE,NDAY,NMET,NOPS,NDAYI,LNEWM)
-
+        
         nmp_dt = 0._r8
         nuv_dt = 0._r8
 
@@ -359,7 +362,6 @@
           LDO_CHM = mod((NSUB-1)*NRCHEM,NLCM).eq.0 !// Do chemistry?
           if (LDO_CHM) NCLDRAN = NCLDRAN+1
 
-
 !//-------------------------------------------------------------------------
           if (LDO_ADV .or. LDO_CHM) then
             call SYSTEM_CLOCK(count=stime)
@@ -648,6 +650,11 @@
 
         if (LDUST) call dustInstBdg(NDAY,NDAY0,NMET,NOPS,DTOPS)
 
+        !// Diag for stomatal conductance and flux
+        if(LDEPEMEP2012 .and. LSTOM1HRS) then
+           call scav_diag_nmet_output_nc(JYEAR,JMON,JDATE,NDAY,NMET,NOPS)
+        end if
+
         !// Done everything for the beginning of new month
         if (LNEWM) LNEWM = .false.
 
@@ -748,14 +755,15 @@
       !// Print 2D budgets to file
       call TBGT_2FILE(1)
 
-      if (LSOA) call soa_diag2file_nc4(NDAY,NDAYI)
+      if (LSOA) call soa_diag2file(NDAY,NDAYI)
 
       !// Chemistry budgets
       !call chembud_output(JYEAR,JMON,JDATE,NDAY)
 
-      !// Write diagnostics: scavenging
-      call scav_diag_2fileA(JYEAR,JMON,JDAY,NDAY)
-
+      !// Write diagnostics: scavenging daily totals
+      if (LDLYSCAV(1)) then
+         call scav_diag_2fileA(JYEAR,JMON,JDAY,NDAY)
+      end if
       !// Initialize core tendencies for next average
       call TBGT_G(STTTNL, BTTTN0, 0)
 
Index: cmn_size.F90
===================================================================
--- cmn_size.F90	(.../ctm3f90)	(revision 243)
+++ cmn_size.F90	(.../branches/brOzoNorClim)	(revision 243)
@@ -94,18 +94,6 @@
   integer, parameter :: NRFFT   = 32
   integer, parameter :: FFTPTS  = 3*(NTRUNW+2)
 
-#elif defined(HNATIVEnorESM)
-  integer, parameter :: IPARW      = 144
-  integer, parameter :: JPARW      = 94
-  logical, parameter :: LGAUGRD    = .TRUE.
-
-  integer, parameter :: NSPGT   = 3-(IPARW/300)
-  integer, parameter :: NTRUNW  = 1
-  integer, parameter :: NRNM    = (NTRUNW+1)*(NTRUNW+2)
-  integer, parameter :: NMMAX   = (NTRUNW+1)*(NTRUNW+4)/2
-  integer, parameter :: NRFFT   = 1
-  integer, parameter :: FFTPTS  = 1
-
 #endif
 
   !// Metdata: Native vertical resolution
@@ -116,9 +104,6 @@
 #elif defined(VNATIVEL60)
   integer, parameter :: LPARW    = 60
   integer, parameter :: LWEPARW  = 40
-#elif defined(VNATIVEnorESM)
-  integer, parameter :: LPARW    = 30
-  integer, parameter :: LWEPARW  = 22
 #endif
 
 
@@ -212,20 +197,8 @@
   integer, parameter :: MPJPAR  = JPAR
 #endif
 
-#elif defined(HNATIVEnorESM)
-#if defined(HORIGINAL)
-  integer, parameter :: MPIPAR  = 1
-  integer, parameter :: MPJPAR  = JPAR
-#elif defined(HTWO)
-  integer, parameter :: MPIPAR  = 2
-  integer, parameter :: MPJPAR  = JPAR
-#else
-  integer, parameter :: MPIPAR  = 1
-  integer, parameter :: MPJPAR  = JPAR
 #endif
 
-#endif
-
   !// OpenMP blocks
   integer, parameter :: MPBLK   = MPIPAR*MPJPAR   ! number of OpenMP blocks
   integer, parameter :: IDBLK   = IPAR/MPIPAR  ! block longitude dimension
@@ -272,7 +245,7 @@
 
   !// Tropospheric chemistry parameters
 #if defined(TROPCHEM)
-  integer, parameter :: NPAR_TROP     = 40
+  integer, parameter :: NPAR_TROP     = 39
   integer, parameter :: NOTRPAR_TROP  = 7
   logical, parameter :: LOSLOCTROP    = .true.
 #else
Index: cmn_sfc.f90
===================================================================
--- cmn_sfc.f90	(.../ctm3f90)	(revision 243)
+++ cmn_sfc.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -18,7 +18,6 @@
   !//-----------------------------------------------------------------------
   implicit none
   !//-----------------------------------------------------------------------
-  public
   save
   !//-----------------------------------------------------------------------
 
@@ -43,7 +42,11 @@
   character(len=160) :: fileZOI
   integer :: ZOI_YEAR
   
-
+  !// DRYDEP EMEP parameter switch
+  logical :: LDEPEMEP2012
+  !// Parameters and land use type from EMEP
+  real(r8), dimension(28,16) :: EMEP_PAR
+  
   !// Displacement height [m] for given land type fraction (LS_FRAC)
   real(r8) :: ZPDVT_C3(NVGPAR)
 
@@ -51,9 +54,17 @@
   real(r8), dimension(IPAR,JPAR,5) :: LSMASK
 
   !// Dry deposition
-  real(r8), dimension(NPAR,IPAR,JPAR)   :: VDEP      !dep veloc, mean
-  real(r8), dimension(NPAR,3) :: VDEPIN  !// UCI dep vel for land/ocean/cryo
+  real(r8), dimension(NPAR,IPAR,JPAR) :: VDEP      !// dep veloc, mean
+  real(r8), dimension(NPAR,3)         :: VDEPIN    !// UCI dep vel for land/ocean/cryo
+  !// Stomatal conductance
+  real(r8), dimension(IPAR,JPAR)      :: VGSTO3    !// dep veloc, stomata
 
+  !// Growing season
+  logical :: LGSMAP
+  character(len=160) :: fileGSMAP
+  integer, dimension(:,:,:), allocatable  :: GDAY_MAP  !// Daily map of number of growing days
+  integer, dimension(IPAR,JPAR)           :: GLEN_MAP  !// Map of length of the growing season
+  
   !//-----------------------------------------------------------------------
 end module CMN_SFC
 !//=========================================================================
Index: tables/norESMgrid.nc
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: tables/PMEAN/p-wind_ec.f
===================================================================
--- tables/PMEAN/p-wind_ec.f	(.../ctm3f90)	(revision 243)
+++ tables/PMEAN/p-wind_ec.f	(.../branches/brOzoNorClim)	(revision 243)
@@ -1489,7 +1489,7 @@
       elseif (IFAC.eq.8) then
 
           if (.not.LAEQM) then
-           IERR=3
+           IERR = 3
             return
           endif
 
Index: tables/Ltracer_emis_ceds17_2014_megan_gfed4blhdaily.inp
===================================================================
--- tables/Ltracer_emis_ceds17_2014_megan_gfed4blhdaily.inp	(.../ctm3f90)	(revision 243)
+++ tables/Ltracer_emis_ceds17_2014_megan_gfed4blhdaily.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -7,7 +7,7 @@
 Nothing special yet.
 --- Aircraft emission data --------------------------------------------------
   AirScen CEDS2017 2014     #NONE/REACT4C_5a/Quantify_MA8/TradeOff_1e
-  AirEmisPath '/div/pdo/emissions/CEDS0517/'
+  AirEmisPath '/work/projects/cicero/ctm_input/EMIS/CEDS0517/'
 --- Lightning emission data -------------------------------------------------
   1       No. of species with lightning sources; emissions in Tg/yr
   'NO'       14.0D0   5.0000D+00  0
@@ -17,49 +17,49 @@
     SPECIES SCALING ('xxx' to close dataset)
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'NOx_em_anthro_AGR'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'NOx_em_anthro_ENE'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'NOx_em_anthro_IND'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'NOx_em_anthro_TRA'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'NOx_em_anthro_RCO'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'NOx_em_anthro_SOL'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'NOx_em_anthro_WAS'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'NOx_em_anthro_SHI'  2014
     NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
    NO2 0.04d0         # 0.04 as NO2
@@ -69,42 +69,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'CO_em_anthro_AGR'  2014
     CO 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'CO_em_anthro_ENE'  2014
     CO 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'CO_em_anthro_IND'  2014
     CO 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'CO_em_anthro_TRA'  2014
     CO 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'CO_em_anthro_RCO'  2014
     CO 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'CO_em_anthro_SOL'  2014
     CO 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'CO_em_anthro_WAS'  2014
     CO 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'CO_em_anthro_SHI'  2014
     CO 1.d0
     xxx 0 To close this data set
@@ -112,49 +112,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'SO2_em_anthro_AGR'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'SO2_em_anthro_ENE'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'SO2_em_anthro_IND'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'SO2_em_anthro_TRA'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'SO2_em_anthro_RCO'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'SO2_em_anthro_SOL'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'SO2_em_anthro_WAS'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'SO2_em_anthro_SHI'  2014
     SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
     SO4 0.0375d0     # 0.025 * 96/64
@@ -164,42 +164,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'NH3_em_anthro_AGR'  2014
     NH3 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'NH3_em_anthro_ENE'  2014
     NH3 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'NH3_em_anthro_IND'  2014
     NH3 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'NH3_em_anthro_TRA'  2014
     NH3 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'NH3_em_anthro_RCO'  2014
     NH3 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'NH3_em_anthro_SOL'  2014
     NH3 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'NH3_em_anthro_WAS'  2014
     NH3 1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
   460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'NH3_em_anthro_SHI'  2014
     NH3 1.d0
     xxx 0 To close this data set
@@ -209,42 +209,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_AGR'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_ENE'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_IND'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_TRA'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_RCO'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_SOL'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_WAS'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_SHI'  2014
     C2H6 1.0000d0
     xxx 0 To close this data set
@@ -252,42 +252,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_AGR'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_ENE'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_IND'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_TRA'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_RCO'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_SOL'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_WAS'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_SHI'  2014
     C3H8 1.0000d0
     xxx 0 To close this data set
@@ -296,42 +296,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_AGR'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_ENE'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_IND'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_TRA'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_RCO'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_SOL'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_WAS'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_SHI'  2014
     C4H10 1.0000d0
     xxx 0 To close this data set
@@ -342,42 +342,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_AGR'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_ENE'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_IND'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_TRA'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_RCO'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_SOL'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_WAS'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_SHI'  2014
     C4H10 0.80555555d0    # Change from pentanes to butanes
     xxx 0 To close this data set
@@ -388,42 +388,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_AGR'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_ENE'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_IND'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_TRA'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_RCO'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_SOL'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_WAS'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_SHI'  2014
     C6H14 1.0000d0
     xxx 0 To close this data set
@@ -436,42 +436,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_AGR'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_ENE'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_IND'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_TRA'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_RCO'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_SOL'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_WAS'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_SHI'  2014
     C2H4 1.0000d0
     xxx 0 To close this data set
@@ -481,42 +481,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_AGR'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_ENE'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_IND'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_TRA'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_RCO'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_SOL'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_WAS'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_SHI'  2014
     C3H6 1.0000d0
     xxx 0 To close this data set
@@ -530,49 +530,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_AGR'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_ENE'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_IND'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_TRA'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_RCO'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_SOL'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_WAS'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_SHI'  2014
     C6HXR 1.0000d0
     Benzene 1.0000d0
@@ -586,49 +586,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_AGR'  2014
     C6HXR 1.1500d0        # For non-SOA. Mass of toluene (92g7mol) converted to xylene (106g/mol)
     Tolmatic 1.0000d0     # For SOA
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_ENE'  2014
     C6HXR 1.1500d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_IND'  2014
     C6HXR 1.1500d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_TRA'  2014
     C6HXR 1.1500d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_RCO'  2014
     C6HXR 1.1500d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_SOL'  2014
     C6HXR 1.1500d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_WAS'  2014
     C6HXR 1.1500d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_SHI'  2014
     C6HXR 1.1500d0
     Tolmatic 1.0000d0
@@ -641,49 +641,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_AGR'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_ENE'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_IND'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_TRA'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_RCO'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_SOL'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_WAS'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_SHI'  2014
     C6HXR 1.0000d0
     C6HXR_SOA 1.0000d0
@@ -694,49 +694,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_AGR'  2014
     C6HXR 0.8833d0              # For non-SOA. Input 120g/mol converted to 106g/mol
     C6HXR_SOA 0.8833d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_ENE'  2014
     C6HXR 0.8833d0
     C6HXR_SOA 0.8833d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_IND'  2014
     C6HXR 0.8833d0
     C6HXR_SOA 0.8833d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_TRA'  2014
     C6HXR 0.8833d0
     C6HXR_SOA 0.8833d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_RCO'  2014
     C6HXR 0.8833d0
     C6HXR_SOA 0.8833d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_SOL'  2014
     C6HXR 0.8833d0
     C6HXR_SOA 0.8833d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_WAS'  2014
     C6HXR 0.8833d0
     C6HXR_SOA 0.8833d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_SHI'  2014
     C6HXR 0.8833d0
     C6HXR_SOA 0.8833d0
@@ -750,49 +750,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_AGR'  2014
     C6HXR 1.0000d0              # For non-SOA
     Tolmatic 1.0000d0           # For SOA
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_ENE'  2014
     C6HXR 1.0000d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_IND'  2014
     C6HXR 1.0000d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_TRA'  2014
     C6HXR 1.0000d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_RCO'  2014
     C6HXR 1.0000d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_SOL'  2014
     C6HXR 1.0000d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_WAS'  2014
     C6HXR 1.0000d0
     Tolmatic 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_SHI'  2014
     C6HXR 1.0000d0
     Tolmatic 1.0000d0
@@ -805,42 +805,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_AGR'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_ENE'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_IND'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_TRA'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_RCO'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_SOL'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_WAS'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_SHI'  2014
     CH2O 1.0000d0
     xxx 0 To close this data set
@@ -851,42 +851,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_AGR'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_ENE'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_IND'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_TRA'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_RCO'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_SOL'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_WAS'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_SHI'  2014
     CH3CHO 1.0000d0
     xxx 0 To close this data set
@@ -899,42 +899,42 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_AGR'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_ENE'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_IND'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_TRA'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_RCO'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_SOL'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_WAS'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_SHI'  2014
     ACETONE 1.0000d0
     xxx 0 To close this data set
@@ -948,49 +948,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_AGR'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_ENE'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_IND'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_TRA'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_RCO'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_SOL'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_WAS'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_SHI'  2014
     bcFF1fob 0.8d0
     bcFF1fil 0.2d0
@@ -1002,49 +1002,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  AGR   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_AGR'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  ENE   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_ENE'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  IND   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_IND'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  TRA   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_TRA'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  RCO   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_RCO'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SLV   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_SOL'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  WAS   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_WAS'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460    1.d0  HLF   99  9999  SHI   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_SHI'  2014
     bcBF1fob 0.8d0
     bcBF1fil 0.2d0
@@ -1055,49 +1055,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  AGR   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_AGR'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  ENE   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_ENE'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  IND   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_IND'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  TRA   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_TRA'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  RCO   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_RCO'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  SLV   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_SOL'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  WAS   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_WAS'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  SHI   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_SHI'  2014
     omFF1fob 0.5d0
     omFF1fil 0.5d0
@@ -1107,49 +1107,49 @@
 
 
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  AGR   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_AGR'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  ENE   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_ENE'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  IND   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_IND'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  TRA   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_TRA'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  RCO   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_RCO'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  SLV   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_SOL'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  WAS   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_WAS'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
   460   1.6d0  HLF   99  9999  SHI   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_SHI'  2014
     omBF1fob 0.5d0
     omBF1fil 0.5d0
@@ -1165,38 +1165,38 @@
 
 
 
-'/div/pdo/emissions/POET/oceans.co.nc'
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.co.nc'
   601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
     CO 1.d0         # Oceanic emissions not included in MEGAN
     xxx 0 To close this data set
-'/div/pdo/emissions/POET/oceans.c2h4.nc'
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c2h4.nc'
   601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
     C2H4 1.d0         # Oceanic emissions not included in MEGAN
     xxx 0 To close this data set
-'/div/pdo/emissions/POET/oceans.c2h6.nc'
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c2h6.nc'
   601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
     C2H6 1.d0         # Oceanic emissions not included in MEGAN
     xxx 0 To close this data set
-'/div/pdo/emissions/POET/oceans.c3h6.nc'
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c3h6.nc'
   601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
     C3H6 1.d0         # Oceanic emissions not included in MEGAN
     xxx 0 To close this data set
-'/div/pdo/emissions/POET/oceans.c3h8.nc'
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c3h8.nc'
   601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
     C3H8 1.d0         # Oceanic emissions not included in MEGAN
     xxx 0 To close this data set
 
 
-'/div/pdo/emissions/NH3/NH3geia1997.nc'
+'/work/projects/cicero/ctm_input/EMIS/NH3/NH3geia1997.nc'
   601    1.0000d+00  1x1   99  9999  NAT   0    0    0    0   'emiss_wilan'  9999
     NH3  1.d0
     xxx 0 To close this data set
-'/div/pdo/emissions/NH3/NH3geia1997.nc'
+'/work/projects/cicero/ctm_input/EMIS/NH3/NH3geia1997.nc'
   601    1.0000d+00  1x1   99  9999  OCE   0    0    0    0   'emiss_oce'  9999
     NH3  1.d0
     xxx 0 To close this data set
 
-'/div/pdo/emissions/SULFUR/H2Ssol.1x1'
+'/work/projects/cicero/ctm_input/EMIS/SULFUR/H2Ssol.1x1'
   551    1.0000d+00  1x1   99  9999  NAT   1    1    0    0   'H2S_soil'  9999
     H2S 1.d0
     xxx 0 To close this data set
@@ -1211,11 +1211,11 @@
 -STV- Used for short time variations; only one species per field ------------
 format(char)/name for 2d-variable/tracer info
 
-'/div/pdo/emissions/SULFUR/DMSconc_Kettle2.1x1'
+'/work/projects/cicero/ctm_input/EMIS/SULFUR/DMSconc_Kettle2.1x1'
   551    1.0000d+00  1x1   99  9999  NAT   2   -1    0   'DMSseaconc'  9999
     DMS     # Unit is nmol*m2/L, handeled by read-in
 
-'/div/pdo/emissions/SULFUR/contineous_volc.1x1'  
+'/work/projects/cicero/ctm_input/EMIS/SULFUR/contineous_volc.1x1'  
   554    1.0000d+00  1x1   99  9999  NAT   2   -1    0   '---' 9999
     SO2     # Unit is kg/year, changed to kg/s in read-in
 
@@ -1236,7 +1236,7 @@
 -BBB- Used for biomass burning - may list several species -------------------
 filename / description
   ID     SCALE       RES MONTH YEAR  CAT TYPE UNIT DIURN DATASET_NAME
-'/div/pdo/emissions/GFEDv4/'
+'/work/projects/cicero/ctm_input/EMIS/GFEDv4/'
   572    1.0000d-00  HLF   99  9999  NAT   0   -1    0   'biomass_burning'
   #CTMname    GFEDname        Scaling    Part.factor (SAVA/BORF/TEMF/DEFO/PEAT/AGRI)
    'CO'       'CO'             1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
@@ -1251,7 +1251,6 @@
    'C6HXR'    'Toluene_lump'   1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'Tolmatic' 'Toluene_lump'   1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'CH2O'     'CH2O'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'CH3OH'    'CH3OH'          1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'CH3CHO'   'C2H4O'          1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'ISOPRENE' 'C5H8'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'C3H8'     'C3H8'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
@@ -1259,10 +1258,10 @@
    'NH3'      'NH3'            1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'SO2'      'SO2'            0.9750d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'SO4'      'SO2'            0.0375d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'bcBB1fob' 'BC'             0.8000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'bcBB1fil' 'BC'             0.2000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'omBB1fob' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'omBB1fil' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'bcBB1fob' 'BC'             0.8000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'bcBB1fil' 'BC'             0.2000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'omBB1fob' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'omBB1fil' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
    '---'      '---'            0.0000d0   0.00d0 0.00d0 0.00d0 0.00d0 0.00d0 0.00d0
 'endFF' 'endFF'  -------------------------------------------------------------
 
Index: tables/EMISSION_LISTS/Ltracer_emis_biomassburning.dat
===================================================================
--- tables/EMISSION_LISTS/Ltracer_emis_biomassburning.dat	(.../ctm3f90)	(revision 243)
+++ tables/EMISSION_LISTS/Ltracer_emis_biomassburning.dat	(.../branches/brOzoNorClim)	(revision 243)
@@ -2,11 +2,6 @@
 is available through codes 573 and 567.
 For CEDS: Use code 574 for BLH vertical distribution and 568 for old.
 
-Note that for GFED4, the AGRI partition is sometimes included in anthropogenic
-agricultural emissions. For CEDS, however, their biomass burning emissions
-is the same as full GFED4, so the AGRI partition should be included.
-
-
 -BBB- Used for biomass burning (GFEDv4) - may list several species ----------
 filename / description
   ID     SCALE       RES MONTH YEAR  CAT TYPE UNIT DIURN DATASET_NAME
@@ -25,7 +20,6 @@
    'C6HXR'    'Toluene_lump'   1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'Tolmatic' 'Toluene_lump'   1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'CH2O'     'CH2O'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'CH3OH'    'CH3OH'          1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'CH3CHO'   'C2H4O'          1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'ISOPRENE' 'C5H8'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'C3H8'     'C3H8'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
@@ -33,10 +27,10 @@
    'NH3'      'NH3'            1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'SO2'      'SO2'            0.9750d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
    'SO4'      'SO2'            0.0375d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'bcBB1fob' 'BC'             0.8000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'bcBB1fil' 'BC'             0.2000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'omBB1fob' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
-   'omBB1fil' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'bcBB1fob' 'BC'             0.8000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'bcBB1fil' 'BC'             0.2000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'omBB1fob' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'omBB1fil' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
    '---'      '---'            0.0000d0   0.00d0 0.00d0 0.00d0 0.00d0 0.00d0 0.00d0
 'endFF' 'endFF'  -------------------------------------------------------------
 
@@ -58,7 +52,6 @@
    'C6HXR'    'NMVOC-Toluene-lump'   'Toluene_lump'   1.0000d0
    'Tolmatic' 'NMVOC-Toluene-lump'   'Toluene_lump'   1.0000d0
    'CH2O'     'NMVOC-CH2O'     'CH2O'          1.0000d0
-   'CH3OH'    'NMVOC-CH3OH'    'CH3OH'         1.0000d0
    'CH3CHO'   'NMVOC-C2H4O'    'C2H4O'         1.0000d0
    'ISOPRENE' 'NMVOC-C5H8'     'C5H8'          1.0000d0
    'C3H8'     'NMVOC-C3H8'     'C3H8'          1.0000d0
Index: tables/tracer_list_all_soa.d
===================================================================
--- tables/tracer_list_all_soa.d	(.../ctm3f90)	(revision 243)
+++ tables/tracer_list_all_soa.d	(.../branches/brOzoNorClim)	(revision 243)
@@ -43,7 +43,6 @@
 049       'C3H7O2'      75.086    'Propyl peroxide; Radical from (propane+OH)+O2'
 050       'ACETONE'     58.078    'Acetone [CH3COCH3]'
 051       'CH3COD'      89.070    'Propyldioxy, 2-oxo- [CH3COCH2(O2)], [C3H5O3]'
-052       'CH3OH'       32.032    'Methanol'
 061       'NH3'         17.034    'NH3 gas'
 062       'NH4fine'     18.042    'Fine mode aerosols'
 063       'NH4coarse'   18.042    'Coarse mode aerosols'
Index: tables/megan_tables.dat
===================================================================
--- tables/megan_tables.dat	(.../ctm3f90)	(revision 243)
+++ tables/megan_tables.dat	(.../branches/brOzoNorClim)	(revision 243)
@@ -169,7 +169,7 @@
 069 'nerolidol_t'       222.37  12        'OQST'         290       0.00200 0.00200 0.00200 0.00500 0.00500 0.00500 0.00500 0.00500 0.00200 0.00200 0.00200 0.00500 0.00500 0.00500 0.00500 0.00500
 070 'cedrol'            222.37  12        'OQST'         290       0.00200 0.00200 0.00200 0.00200 0.00200 0.00200 0.00200 0.00200 0.00200 0.00200 0.00200 0.00500 0.00500 0.00500 0.00500 0.00500
 071 'MBO_2m3e2ol'        86.13  13        'MBO'            0       1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000
-072 'methanol'           32.04  14        'MEOH'          52       1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000
+072 'methanol'           32.04  14        'MEOH'           0       1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000
 073 'acetone'            58.08  15        'ACTO'          50       1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000 1.00000
 074 'methane'            16.04  20        'OTHER'         46       0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500 0.00500
 075 'ammonia'            17.03  17        'NO'            61       1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000 1.51000
Index: tables/tracer_list_nitrate.d
===================================================================
--- tables/tracer_list_nitrate.d	(.../ctm3f90)	(revision 243)
+++ tables/tracer_list_nitrate.d	(.../branches/brOzoNorClim)	(revision 243)
@@ -43,7 +43,6 @@
 049       'C3H7O2'      75.086    'Propyl peroxide; Radical from (propane+OH)+O2'
 050       'ACETONE'     58.078    'Acetone [CH3COCH3]'
 051       'CH3COD'      89.070    'Propyldioxy, 2-oxo- [CH3COCH2(O2)], [C3H5O3]'
-052       'CH3OH'       32.032    'Methanol'
 061       'NH3'         17.034    'NH3 gas'
 062       'NH4fine'     18.042    'Fine mode aerosols'
 063       'NH4coarse'   18.042    'Coarse mode aerosols'
@@ -99,7 +98,7 @@
 204       'SALT04'      58.440    'Sea salt mode 4'
 205       'SALT05'      58.440    'Sea salt mode 5'
 206       'SALT06'      58.440    'Sea salt mode 6'
-207       'SALT07'      58.440    'Sea salt mode 7
+207       'SALT07'      58.440    'Sea salt mode 7'
 208       'SALT08'      58.440    'Sea salt mode 8'
  -2- list of non-transported species (MUST match NOTRPAR in params.F)- - - - - -
 022       'CH3O2'       47.034    
Index: tables/Ltracer_emis_ceds17_2005_megan_gfed4blhdaily.inp
===================================================================
--- tables/Ltracer_emis_ceds17_2005_megan_gfed4blhdaily.inp	(.../ctm3f90)	(revision 0)
+++ tables/Ltracer_emis_ceds17_2005_megan_gfed4blhdaily.inp	(.../branches/brOzoNorClim)	(revision 243)
@@ -0,0 +1,1315 @@
+----- Emissions for Oslo CTM3 -----------------------------------------------
+Lists the emissions used in monthly emission tables. In addition there are
+some hard coded emissions, which you define by setting the following flags.
+They are hard coded because they have their own arrays, and do not use the
+emission arrays E2DS and E3DS, and may be updated more often.
+--- IMPORTANT!!! ------------------------------------------------------------
+Nothing special yet.
+--- Aircraft emission data --------------------------------------------------
+  AirScen CEDS2017 2005     #NONE/REACT4C_5a/Quantify_MA8/TradeOff_1e
+  AirEmisPath '/work/projects/cicero/ctm_input/EMIS/CEDS0517/'
+--- Lightning emission data -------------------------------------------------
+  1       No. of species with lightning sources; emissions in Tg/yr
+  'NO'       14.0D0   5.0000D+00  0
+-2D-- 2D emissions ----------------------------------------------------------
+filename / description  (See detailed description below)
+  ID     SCALE       RES MONTH YEAR  CAT TYPE UNIT DIURN VERT DATASET_NAME SCENYEAR
+    SPECIES SCALING ('xxx' to close dataset)
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'NOx_em_anthro_AGR'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'NOx_em_anthro_ENE'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'NOx_em_anthro_IND'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'NOx_em_anthro_TRA'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'NOx_em_anthro_RCO'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'NOx_em_anthro_SOL'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'NOx_em_anthro_WAS'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NOx-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'NOx_em_anthro_SHI'  2005
+    NO 0.62608694d0   # Convert from NO2 to NO: 30/46 * 0.96
+   NO2 0.04d0         # 0.04 as NO2
+    xxx 0 To close this data set
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'CO_em_anthro_AGR'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'CO_em_anthro_ENE'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'CO_em_anthro_IND'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'CO_em_anthro_TRA'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'CO_em_anthro_RCO'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'CO_em_anthro_SOL'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'CO_em_anthro_WAS'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/CO-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'CO_em_anthro_SHI'  2005
+    CO 1.d0
+    xxx 0 To close this data set
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'SO2_em_anthro_AGR'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'SO2_em_anthro_ENE'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'SO2_em_anthro_IND'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'SO2_em_anthro_TRA'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'SO2_em_anthro_RCO'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'SO2_em_anthro_SOL'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'SO2_em_anthro_WAS'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/SO2-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'SO2_em_anthro_SHI'  2005
+    SO2 0.975d0      # 97.5% as SO2, 2.5% as SO4 # Indata is kg(SO2)
+    SO4 0.0375d0     # 0.025 * 96/64
+    xxx 0 To close this data set
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  AGR   2    0    0    0   'NH3_em_anthro_AGR'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  ENE   2    0    0    0   'NH3_em_anthro_ENE'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  IND   2    0    0    0   'NH3_em_anthro_IND'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  TRA   2    0    0    0   'NH3_em_anthro_TRA'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  RCO   2    0    0    0   'NH3_em_anthro_RCO'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SLV   2    0    0    0   'NH3_em_anthro_SOL'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  WAS   2    0    0    0   'NH3_em_anthro_WAS'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/NH3-em-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18_gn_200001-201412_CICERO.nc'
+  460    1.0000d+00  HLF   99  9999  SHI   2    0    0    0   'NH3_em_anthro_SHI'  2005
+    NH3 1.d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_AGR'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_ENE'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_IND'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_TRA'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_RCO'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_SOL'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_WAS'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC02-ethane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC02_ethane_em_speciated_VOC_anthro_SHI'  2005
+    C2H6 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_AGR'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_ENE'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_IND'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_TRA'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_RCO'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_SOL'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_WAS'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC03-propane-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC03_propane_em_speciated_VOC_anthro_SHI'  2005
+    C3H8 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_AGR'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_ENE'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_IND'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_TRA'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_RCO'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_SOL'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_WAS'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC04-butanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC04_butanes_em_speciated_VOC_anthro_SHI'  2005
+    C4H10 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_AGR'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_ENE'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_IND'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_TRA'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_RCO'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_SOL'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_WAS'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC05-pentanes-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC05_pentanes_em_speciated_VOC_anthro_SHI'  2005
+    C4H10 0.80555555d0    # Change from pentanes to butanes
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_AGR'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_ENE'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_IND'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_TRA'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_RCO'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_SOL'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_WAS'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC06-hexanes-pl-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC06_hexanes_pl_em_speciated_VOC_anthro_SHI'  2005
+    C6H14 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_AGR'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_ENE'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_IND'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_TRA'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_RCO'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_SOL'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_WAS'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC07-ethene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC07_ethene_em_speciated_VOC_anthro_SHI'  2005
+    C2H4 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_AGR'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_ENE'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_IND'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_TRA'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_RCO'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_SOL'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_WAS'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC08-propene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC08_propene_em_speciated_VOC_anthro_SHI'  2005
+    C3H6 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_AGR'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_ENE'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_IND'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_TRA'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_RCO'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_SOL'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_WAS'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC13-benzene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC13_benzene_em_speciated_VOC_anthro_SHI'  2005
+    C6HXR 1.0000d0
+    Benzene 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_AGR'  2005
+    C6HXR 1.1500d0        # For non-SOA. Mass of toluene (92g7mol) converted to xylene (106g/mol)
+    Tolmatic 1.0000d0     # For SOA
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_ENE'  2005
+    C6HXR 1.1500d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_IND'  2005
+    C6HXR 1.1500d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_TRA'  2005
+    C6HXR 1.1500d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_RCO'  2005
+    C6HXR 1.1500d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_SOL'  2005
+    C6HXR 1.1500d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_WAS'  2005
+    C6HXR 1.1500d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC14-toluene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC14_toluene_em_speciated_VOC_anthro_SHI'  2005
+    C6HXR 1.1500d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_AGR'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_ENE'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_IND'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_TRA'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_RCO'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_SOL'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_WAS'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC15-xylene-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC15_xylene_em_speciated_VOC_anthro_SHI'  2005
+    C6HXR 1.0000d0
+    C6HXR_SOA 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_AGR'  2005
+    C6HXR 0.8833d0              # For non-SOA. Input 120g/mol converted to 106g/mol
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_ENE'  2005
+    C6HXR 0.8833d0
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_IND'  2005
+    C6HXR 0.8833d0
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_TRA'  2005
+    C6HXR 0.8833d0
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_RCO'  2005
+    C6HXR 0.8833d0
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_SOL'  2005
+    C6HXR 0.8833d0
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_WAS'  2005
+    C6HXR 0.8833d0
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC16-trimethylb-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC16_trimethylb_em_speciated_VOC_anthro_SHI'  2005
+    C6HXR 0.8833d0
+    C6HXR_SOA 0.8833d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_AGR'  2005
+    C6HXR 1.0000d0              # For non-SOA
+    Tolmatic 1.0000d0           # For SOA
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_ENE'  2005
+    C6HXR 1.0000d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_IND'  2005
+    C6HXR 1.0000d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_TRA'  2005
+    C6HXR 1.0000d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_RCO'  2005
+    C6HXR 1.0000d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_SOL'  2005
+    C6HXR 1.0000d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_WAS'  2005
+    C6HXR 1.0000d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC17-other-arom-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC17_other_arom_em_speciated_VOC_anthro_SHI'  2005
+    C6HXR 1.0000d0
+    Tolmatic 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_AGR'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_ENE'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_IND'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_TRA'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_RCO'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_SOL'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_WAS'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC21-methanal-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC21_methanal_em_speciated_VOC_anthro_SHI'  2005
+    CH2O 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_AGR'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_ENE'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_IND'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_TRA'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_RCO'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_SOL'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_WAS'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC22-other-alka-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC22_other_alka_em_speciated_VOC_anthro_SHI'  2005
+    CH3CHO 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_AGR'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_ENE'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_IND'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_TRA'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_RCO'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_SOL'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_WAS'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/VOC23-ketones-em-speciated-VOC-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'VOC23_ketones_em_speciated_VOC_anthro_SHI'  2005
+    ACETONE 1.0000d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_AGR'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_ENE'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_IND'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_TRA'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_RCO'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_SOL'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_WAS'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'BC_em_FOSSIL_FUEL_anthro_SHI'  2005
+    bcFF1fob 0.8d0
+    bcFF1fil 0.2d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  AGR   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_AGR'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  ENE   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_ENE'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  IND   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_IND'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  TRA   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_TRA'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  RCO   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_RCO'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SLV   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_SOL'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  WAS   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_WAS'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/BC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460    1.d0  HLF   99  9999  SHI   2    0    0    0   'BC_em_SOLID_BIOFUEL_anthro_SHI'  2005
+    bcBF1fob 0.8d0
+    bcBF1fil 0.2d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  AGR   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_AGR'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  ENE   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_ENE'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  IND   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_IND'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  TRA   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_TRA'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  RCO   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_RCO'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  SLV   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_SOL'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  WAS   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_WAS'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-FOSSIL-FUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  SHI   2    0    0    0   'OC_em_FOSSIL_FUEL_anthro_SHI'  2005
+    omFF1fob 0.5d0
+    omFF1fil 0.5d0
+    xxx 0 To close this data set
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  AGR   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_AGR'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  ENE   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_ENE'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  IND   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_IND'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  TRA   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_TRA'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  RCO   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_RCO'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  SLV   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_SOL'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  WAS   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_WAS'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/CEDS0517/CEDS_CICERO/OC-em-SOLID-BIOFUEL-anthro_input4MIPs_emissions_CMIP_CEDS-2017-05-18-supplemental-data_gn_200001-201412_CICERO.nc'
+  460   1.6d0  HLF   99  9999  SHI   2    0    0    0   'OC_em_SOLID_BIOFUEL_anthro_SHI'  2005
+    omBF1fob 0.5d0
+    omBF1fil 0.5d0
+    xxx 0 To close this data set
+
+
+
+
+
+
+
+
+
+
+
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.co.nc'
+  601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
+    CO 1.d0         # Oceanic emissions not included in MEGAN
+    xxx 0 To close this data set
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c2h4.nc'
+  601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
+    C2H4 1.d0         # Oceanic emissions not included in MEGAN
+    xxx 0 To close this data set
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c2h6.nc'
+  601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
+    C2H6 1.d0         # Oceanic emissions not included in MEGAN
+    xxx 0 To close this data set
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c3h6.nc'
+  601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
+    C3H6 1.d0         # Oceanic emissions not included in MEGAN
+    xxx 0 To close this data set
+'/work/projects/cicero/ctm_input/EMIS/POET/oceans.c3h8.nc'
+  601    1.0000d+00  1x1   99  9999  OCE   1    1    0    0   'oceans'  9999
+    C3H8 1.d0         # Oceanic emissions not included in MEGAN
+    xxx 0 To close this data set
+
+
+'/work/projects/cicero/ctm_input/EMIS/NH3/NH3geia1997.nc'
+  601    1.0000d+00  1x1   99  9999  NAT   0    0    0    0   'emiss_wilan'  9999
+    NH3  1.d0
+    xxx 0 To close this data set
+'/work/projects/cicero/ctm_input/EMIS/NH3/NH3geia1997.nc'
+  601    1.0000d+00  1x1   99  9999  OCE   0    0    0    0   'emiss_oce'  9999
+    NH3  1.d0
+    xxx 0 To close this data set
+
+'/work/projects/cicero/ctm_input/EMIS/SULFUR/H2Ssol.1x1'
+  551    1.0000d+00  1x1   99  9999  NAT   1    1    0    0   'H2S_soil'  9999
+    H2S 1.d0
+    xxx 0 To close this data set
+
+
+'end2D' 'end2D' -------------------------------------------------------------
+-3D-- Emissions 3-D ---------------------------------------------------------
+filename / description
+  ID     SCALE       RES MONTH YEAR  CAT TYPE UNIT DIURN DATASET_NAME SCENYEAR
+
+'end3D' 'end3D' -------------------------------------------------------------
+-STV- Used for short time variations; only one species per field ------------
+format(char)/name for 2d-variable/tracer info
+
+'/work/projects/cicero/ctm_input/EMIS/SULFUR/DMSconc_Kettle2.1x1'
+  551    1.0000d+00  1x1   99  9999  NAT   2   -1    0   'DMSseaconc'  9999
+    DMS     # Unit is nmol*m2/L, handeled by read-in
+
+'/work/projects/cicero/ctm_input/EMIS/SULFUR/contineous_volc.1x1'  
+  554    1.0000d+00  1x1   99  9999  NAT   2   -1    0   '---' 9999
+    SO2     # Unit is kg/year, changed to kg/s in read-in
+
+'Indata_CTM3/oceanemis/'
+  555    1.0000d+00  HLF   99  9999  OCN   0   -1    0   '---'  9999
+  ---   #This section just turns on the OC oceanic emissions
+
+'DEAD_Mineral_Dust_Mobilisation_Dataset_Name'
+  556    2.74925d-04  HLF   99  9999  NAT   0   -1    0   'mbl_bsn_fct'  9999
+  ---   #This section sets mobilisation map name and fudge factor for DUST
+
+'Indata_CTM3/MEGAN/'
+  557    1.00000d+00  HLF   99  9999  BIO   0   -1    0   '---'  9999
+  ---   #This section defines the use of MEGAN and sets path to MEGAN datasets
+
+-END- -END-  ----------------------------------------------------------------
+
+-BBB- Used for biomass burning - may list several species -------------------
+filename / description
+  ID     SCALE       RES MONTH YEAR  CAT TYPE UNIT DIURN DATASET_NAME
+'/work/projects/cicero/ctm_input/EMIS/GFEDv4/'
+  572    1.0000d-00  HLF   99  9999  NAT   0   -1    0   'biomass_burning'
+  #CTMname    GFEDname        Scaling    Part.factor (SAVA/BORF/TEMF/DEFO/PEAT/AGRI)
+   'CO'       'CO'             1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'NO'       'NOx'            0.9000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'NO2'      'NOx'            0.1533d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'CH4'      'CH4'            0.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'C2H4'     'C2H4'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'C2H6'     'C2H6'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'C3H6'     'C3H6'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'C4H10'    'NMHC'           0.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'C6H14'    'Higher_Alkanes' 1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'C6HXR'    'Toluene_lump'   1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'Tolmatic' 'Toluene_lump'   1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'CH2O'     'CH2O'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'CH3CHO'   'C2H4O'          1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'ISOPRENE' 'C5H8'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'C3H8'     'C3H8'           1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'ACETONE'  'C3H6O'          1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'NH3'      'NH3'            1.0000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'SO2'      'SO2'            0.9750d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'SO4'      'SO2'            0.0375d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 1.00d0
+   'bcBB1fob' 'BC'             0.8000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'bcBB1fil' 'BC'             0.2000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'omBB1fob' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   'omBB1fil' 'OC'             1.3000d0   1.00d0 1.00d0 1.00d0 1.00d0 1.00d0 0.00d0
+   '---'      '---'            0.0000d0   0.00d0 0.00d0 0.00d0 0.00d0 0.00d0 0.00d0
+'endFF' 'endFF'  -------------------------------------------------------------
+
+
+==============================================================================
+DESCRIPTION OF FILE SETTINGS
+==============================================================================
+----- Variables to set above -----
+ID:    ID number to control read-in, connected to the file structure
+SCALE: Dataset scaling factor. No scaling when 1.d0.
+RES:   Resolution of input data (character)
+       1x1 = 1x1 degree, HLF = half; 0.5x0.5, ZP1 = zero point 1; 0.1:0.1, QRT=0.25x0.25
+MONTH: Month which the emissions apply for (99 = all months)
+YEAR:  Year which the emissions apply for (9999 = all years)
+CAT:   Category of the emissions (for diagnostics)
+TYPE:  Read into ETYP
+       0: Use data as is
+       1: Data is per cm2, multiply with area (m2)*1.d4
+       2: Data is per m2, multiply with area (m2)
+UNIT:  Read into EUNIT
+       0: kg/s (or kg/area/s when ETYP=1,2)
+       1: molec/s (or molec/area/s when ETYP=1,2)
+       2: kg/y (or kg/area/y when ETYP=1,2)
+       3: kg/month (or kg/area/month when ETYP=1,2)
+DIURN: Flag for diurnal variation, local hour or based on 2D field.
+       0: No diurnal variation
+       1: RETRO variations (TNO)
+       2: +50% from 8am to 7pm, -50% from 8pm to 7am (e.g. for BCOC)
+       3: Scale with both sunlight and temperature
+       4: Scale with sunlight
+       5: Scale with heating degree day (HDD)
+VERT:  Distribute 2D emissions on a few layers
+       Alt 0-16/16-41/41-77/77-128
+       1: 0.250/0.125/0.125/0.500  (typical power/industrial combustion)
+       2: 0.600/0.200/0.200/0.000  (typical residential heating)
+       3: 0.300/0.400/0.300/0.000  (typical ships)
+DATASET_NAME: Name of dataset (e.g. in netCDF files).
+SPECIES: The name of the species to use the listed dataset.
+SCALING: Separate scaling factor for the listed species.
+         Used in addition to SCALE above, which applies for the dataset.
+           Normal usage:
+         If the units of the input data on file is other than molecules
+         per time and/or area, you have to scale the data to correct for
+         differences in molecular mass.
+         If input is molecules, you should *not* scale with molecular mass.
+
+         If you specify a category not on file, the program will stop.
+
+
+EDGAR category definitios:
+http://edgar.jrc.ec.europa.eu/methodology.php
Index: OSLO/bcoc_oslo.f90
===================================================================
--- OSLO/bcoc_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/bcoc_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -950,9 +950,10 @@
     use cmn_ctm, only: JMON, MPBLKJB, MPBLKJE, MPBLKIB, MPBLKIE, &
          YDGRD, PLAND
     use cmn_chem, only: TNAME
-    use cmn_met, only: PRECLS, PRECCNV, MO_LENGTH, USTR, SFT, CI, SD, CLDFR
+    use cmn_met, only: PRECLS, PRECCNV, MO_LENGTH, USTR, SFT, CI, SD, CLDFR, &
+         EMEP_PAR
     use cmn_sfc, only: LANDUSE_IDX, landSurfTypeFrac, NVGPAR, LAI
-    use utilities_oslo, only: landfrac2emep
+    use utilities_oslo, only: landfrac2emep, set_vegetation_height
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -967,7 +968,7 @@
     real(r8) :: SAI1, MOL, USR, RAIN, T2M, &
          a1L, a1W, a1I, a1Lfor, amol, Vtot, WETFRAC, fice, snowD, &
          focean
-
+    real(r8) :: tempVEGH
     integer, parameter :: NLCAT=10
     real(r8),dimension(NLCAT) :: FL, VD, VEGH, fsnowC
 
@@ -989,35 +990,26 @@
     !//  9. Urban
     !// 10. Ice+snow (strictly, EMEP has this as category 9 and urban as 10)
     !// Vegetation heights
-    VEGH(1)  = 20._r8
-    VEGH(2)  =  0.4_r8
-    VEGH(3)  =  0.7_r8
-    VEGH(4)  =  0.4_r8
-    VEGH(5)  =  0.5_r8
-    VEGH(6)  =  0._r8
-    VEGH(7)  =  0._r8
-    VEGH(8)  =  0._r8
-    VEGH(9)  =  0.05_r8
-    VEGH(10) =  0._r8
+    VEGH(1)  = 0._r8 !// Will be modified below 
+    tempVEGH = (sum(EMEP_PAR(20,1:4))+EMEP_PAR(20,10))/5._r8
+    VEGH(2)  = sum(EMEP_PAR(20,5:7))/3._r8
+    VEGH(3)  = EMEP_PAR(20,8)
+    VEGH(4)  = EMEP_PAR(20,9)
+    VEGH(5)  = EMEP_PAR(20,11)
+    VEGH(6)  = EMEP_PAR(20,12)
+    VEGH(7)  = EMEP_PAR(20,13)
+    VEGH(8)  = EMEP_PAR(20,14)
+    VEGH(9)  = EMEP_PAR(20,16)
+    VEGH(10) = 0._r8
 
 
     !// Loop over latitude (J is global, JJ is block)
     do J = MPBLKJB(MP),MPBLKJE(MP)
       JJ    = J - MPBLKJB(MP) + 1
-
-      !// MODIFY forest vegetation height poleward of 60 latitude
-      if (YDGRD(J) .ge. -60._r8 .and. YDGRD(J) .le. 60._r8) then
-         !// Forest vegetation height
-         VEGH(1) = 20._r8
-      else if (abs(YDGRD(J)) .gt. 60._r8 .and. abs(YDGRD(J)) .lt. 75._r8) then
-         !// From 60-75 latitude, interpolate linearly from 20m to 6m
-         VEGH(1) = (75._r8 - abs(YDGRD(J)))/15._r8 * 20._r8 &
-                   + (abs(YDGRD(J)) - 60._r8)/15._r8 * 6._r8
-      else
-         !// High-latitude forest
-         VEGH(1) = 6._r8
-      end if
-
+      
+      !// Set latitude dependent vegetation height for forests
+      call set_vegetation_height(tempVEGH,YDGRD(J),VEGH(1))
+      
       !// Loop over longitude (I is global, II is block)
       do I = MPBLKIB(MP),MPBLKIE(MP)
         II    = I - MPBLKIB(MP) + 1
Index: OSLO/diagnostics_general.f90
===================================================================
--- OSLO/diagnostics_general.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/diagnostics_general.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -723,7 +723,8 @@
     !// --------------------------------------------------------------------
     use diagnostics_scavenging, only: scav_diag_collect_daily, &
          scav_diag_2fileB
-    use emissions_megan, only: megan_report
+    use cmn_ctm, only: LDLYSCAV
+    !use emissions_megan, only: megan_report
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -738,10 +739,12 @@
     call scav_diag_collect_daily(DDAY)
 
     !// Daily output for wet deposition maps
-    call scav_diag_2fileB(DDYEAR,DDMON,DDDATE,NDAY)
+    if (LDLYSCAV(2)) then
+       call scav_diag_2fileB(DDYEAR,DDMON,DDDATE,NDAY)
+    end if
 
     !// Print MEGAN report (can be added temporarily if needed)
-    call megan_report(NDAY, NDAYI)
+    !call megan_report(NDAY, NDAYI)
 
     !// Collect total emissions this day
     call tnd_emis_daily(DDAY)
@@ -762,16 +765,18 @@
     !// Ole Amund Sovde, February 2010
     !// --------------------------------------------------------------------
     use cmn_size, only: LBCOC, LOSLOCTROP, LOSLOCSTRAT
+    use cmn_sfc, only: LDEPEMEP2012, VGSTO3
     use bcoc_oslo, only: bcsnow_nmet_output, bcsnow_nmet_output_nc
     use ch4routines, only: reportsfcch4
     use satelliteprofiles_mls, only: satprofs_mls_master
     use verticalprofiles_stations2, only: vprofs_master
-    use atom, only: atom_master
+    !use atom, only: atom_master
     use caribic2, only: caribic2_master
     use hippo, only: hippo_master
     use troccinox_fal, only: troccifal_master
     use troccinox_geo, only: troccigeo_master
     use troccinox_ban, only: trocciban_master
+    use diagnostics_scavenging, only: scav_diag_put_gsto
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -803,7 +808,8 @@
     if (LBCOC) &
          call hippo_master(JYEAR,JMON,JDATE,NDAY,NMET,NOPS,NDAYI,LNEWM)
 
-!         call atom_master(JYEAR,JMON,JDATE,NDAY,NMET,NOPS,NDAYI,LNEWM)
+    !if (LBCOC) &
+         !call atom_master(JYEAR,JMON,JDATE,NDAY,NMET,NOPS,NDAYI,LNEWM)
 
     !// Process flight data for troccinox
     !if (LOSLOCTROP .or. LOSLOCSTRAT) then
@@ -818,6 +824,9 @@
     !// Snapshots on theta levels (mode=1 is NH)
     !call write_snapshot_the(nday,nmet,nops,1)
 
+    !// Snapshot from stomatal conductance
+    if (LDEPEMEP2012) call scav_diag_put_gsto(NMET,VGSTO3)
+
     !// --------------------------------------------------------------------
   end subroutine nops_diag
   !// ----------------------------------------------------------------------
@@ -832,6 +841,8 @@
     !// Ole Amund Sovde, March 2010
     !// --------------------------------------------------------------------
     use cmn_size, only: IDBLK, JDBLK, NPAR, LPAR
+    use cmn_sfc, only: LDEPEMEP2012, VGSTO3
+    use diagnostics_scavenging, only: scav_diag_put_fsto
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -843,8 +854,12 @@
     !// Dobson columns
     if (NOPS.eq.1. .and. NSUB.eq.1. .and. CCYC.eq.1) then
        call du_columns(BTT,NMET,MP)
+      
     end if
-
+    if (NSUB.eq.1. .and. CCYC.eq.1) then
+       !// Snapshot from stomatal flux
+       if (LDEPEMEP2012) call scav_diag_put_fsto(BTT,NMET,VGSTO3,MP)
+    end if
     !// --------------------------------------------------------------------
   end subroutine mp_diag
   !// ----------------------------------------------------------------------
Index: OSLO/DUMMIES/soa_oslo.f90
===================================================================
--- OSLO/DUMMIES/soa_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/DUMMIES/soa_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -19,7 +19,7 @@
   !// ----------------------------------------------------------------------
   private
   public soa_init, soa_setdrydep, SOA_v9_separate, soa_diag_drydep, &
-       soa_diag_separate, soa_diag2file_nc4, soa_nopsdiag, &
+       soa_diag_separate, soa_diag2file, soa_nopsdiag, &
        ndep_soa, soa_deps, soa_diag_lsscav, soa_diag_soagas
   !// ----------------------------------------------------------------------
 
@@ -162,7 +162,7 @@
 
 
   !// ----------------------------------------------------------------------
-  subroutine soa_diag2file_nc4(NDAY,NDAYI)
+  subroutine soa_diag2file(NDAY,NDAYI)
     !// --------------------------------------------------------------------
     !// DUMMY.
     !//
@@ -177,7 +177,7 @@
     return
 
     !// --------------------------------------------------------------------
-  end subroutine soa_diag2file_nc4
+  end subroutine soa_diag2file
   !// ----------------------------------------------------------------------
 
 
Index: OSLO/chem_oslo_rates.f90
===================================================================
--- OSLO/chem_oslo_rates.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/chem_oslo_rates.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -1036,8 +1036,7 @@
 
     PR42HET(:,:) = 0._r8
 
-    if (NDGRD .eq. 1 .and. &
-         (trim(HnativeRES).eq.'T159' .or. trim(HnativeRES).eq.'T42') ) then
+    if (NDGRD .eq. 1) then
        !// Simulation is done in native resolution
        filename = './tables/r42het_'//trim(HnativeRES)//'.dat'
 
@@ -1101,11 +1100,9 @@
 
     end if
 
-    !// Only set up for LPAR=60 and LPAR=30. Why? Because:
     !cmga20feb03--v   ... only a temporary fix!!! mga 29AUG2003
-    if (LPAR .eq. 60) then
-      do J = 1, JPAR
-        do L = 1, LPAR
+    do J = 1, JPAR
+       do L = 1, LPAR
 
           Select Case(L)
 
@@ -1141,57 +1138,14 @@
              P42H(L) = 0._r8
           End Select
 
-        end do
-        do L = 1, LPARW !// Not degraded
+       end do
+       do L = 1, LPARW !// Not degraded
           LL = LMMAP(L) !// Degraded 
           PR42HET(LL,J) = PR42HET(LL,J) + P42H(L) * XLMMAP(L)
-        end do
-      end do
-    else if (LPAR .eq. 30) then
-      !// NorESM vertical grid
-      do J = 1, JPAR
-        do L = 1, LPAR
+       end do
+    end do
 
-          Select Case(L)
 
-          Case(01)
-             P42H(L) = R42HET_TMP(J,01)
-          Case(02:04)
-             P42H(L) = R42HET_TMP(J,02)
-          Case(05)
-             P42H(L) = R42HET_TMP(J,04)
-          Case(06:07)
-             P42H(L) = R42HET_TMP(J,05)
-          Case(08)
-             P42H(L) = R42HET_TMP(J,06)
-          Case(09)
-             P42H(L) = R42HET_TMP(J,07)
-          Case(10)
-             P42H(L) = R42HET_TMP(J,08)
-          Case(11)
-             P42H(L) = R42HET_TMP(J,09)
-          Case(12)
-             P42H(L) = R42HET_TMP(J,10)
-          Case(13)
-             P42H(L) = R42HET_TMP(J,11)
-          Case(14:15)
-             P42H(L) = R42HET_TMP(J,12)
-          Case(16:17)
-             P42H(L) = R42HET_TMP(J,13)
-          Case(18:20)
-             P42H(L) = R42HET_TMP(J,14)
-          Case DEFAULT
-             P42H(L) = 0._r8
-          End Select
-
-        end do
-        do L = 1, LPARW !// Not degraded
-          LL = LMMAP(L) !// Degraded 
-          PR42HET(LL,J) = PR42HET(LL,J) + P42H(L) * XLMMAP(L)
-        end do
-      end do
-    end if
-
     !// --------------------------------------------------------------------
   end subroutine set_pr42het
   !// ----------------------------------------------------------------------
Index: OSLO/utilities_oslo.f90
===================================================================
--- OSLO/utilities_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/utilities_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -31,10 +31,16 @@
   !//   subroutine tpauseb_o3
   !//   subroutine SZA_PN
   !//   subroutine stringUpCase
+  !//   subroutine GROWSEASON
+  !//   subroutine MAPPED_GROWSEASON
   !//
+  !// Stefanie Falk, March - August 2018
+  !//   Moved GROWSEAON to utilities.
+  !//   Created mapping of daily preprocessed growseason.
   !// Amund Sovde Haslerud, September 2017
   !//   Some updates to use different tropopause definitions.
   !// Ole Amund Sovde, November 2015, October 2008
+  !// 
   !// ----------------------------------------------------------------------
   use cmn_precision, only: r8
   !// ----------------------------------------------------------------------
@@ -61,7 +67,7 @@
     !//
     !// Can consider only putting tropospheric components into ZC_LOCAL for
     !// tropospheric chemistry (stratospheric chemistry will also need some
-    !// tropospheric components), but I doubut it will be any faster.
+    !// tropospheric components), but I doubt it will be any faster.
     !//
     !// Ole Amund Sovde, October 2008
     !// --------------------------------------------------------------------
@@ -1218,7 +1224,206 @@
     !// --------------------------------------------------------------------
   end subroutine landfrac2emep
   !// ----------------------------------------------------------------------
+!// ----------------------------------------------------------------------
+  subroutine set_vegetation_height(start_height,lat, out_height)
+    !// --------------------------------------------------------------------
+    !// MODIFY forest vegetation height dependent on latitude.
+    !//
+    !// Based on the modification polwards from 60deg North 
+    !// in Simpson et al. 2012.
+    !// Extended southward to the tropics and usage on southern hemesphere.
+    !//
+    !// Additional ESTIMATION: 
+    !// Average Tropical forest is about 2-times higher (e.g. 40m) than 
+    !// midlatitude forest. Decrease height linearly to 20m at 40deg.
+    !// Constant height thereafter till 60deg. 
+    !// Valide for both, northern and southern, hemisphere.
+    !//
+    !// Not sure if this is realistic, though.
+    !//
+    !// Used two times in drydeposition_oslo.f90 and one time in
+    !// bcoc_oslo.f90.
+    !//
+    !// Stefanie Falk, March 2018
+    !// --------------------------------------------------------------------
+    implicit none
+    !// --------------------------------------------------------------------
+    real(r8), intent(in) :: start_height, lat
+    real(r8), intent(out) :: out_height
+    !// Locals
+    real(r8) :: rate
+    !// --------------------------------------------------------------------
+    character(len=*), parameter :: subr = 'get_vegetation_height'
+    !// --------------------------------------------------------------------
+    rate = 0.05_r8
 
+    if (abs(lat) .le. 10._r8) then
+       out_height = start_height*2._r8
+    else if (abs(lat) .le. 40._r8) then
+       out_height = (1._r8-(abs(lat)-10._r8)*rate/3._r8)*start_height*2._r8
+    else if (abs(lat) .le. 60._r8) then
+       !// Forest vegetation height
+       out_height = start_height
+    else if (abs(lat) .lt. 74._r8) then
+       !// From 60-74 latitude, linearly decreasing with rate
+       out_height = (1._r8-(abs(lat)-60._r8)*rate)*start_height
+    else
+       !// High-latitude forest
+       out_height = start_height*3._r8/10._r8
+    end if
+
+    if (out_height .lt. 0._r8) then
+       write(6,'(a,i5)') f90file//':'//subr// &
+            ': There is something wrong with your vegetation height!'
+       write(6,'(a)') 'Start (m): '
+       write(6,*) start_height
+       write(6,'(a)') 'Stop (m): '
+       write(6,*), out_height
+       stop
+    end if
+    !// --------------------------------------------------------------------
+  end subroutine set_vegetation_height
   !// ----------------------------------------------------------------------
+  !// ----------------------------------------------------------------------
+  subroutine MAPPED_GROWSEASON ( JDAY, I, J, GDAY, GLEN )
+    !// --------------------------------------------------------------------
+    !  DESCRIPTION
+    !     This function uses a preprocessed map of grow season GDAY and GLEN.
+    !     The preprocessed data was created using the 5 days/5 degC
+    !     criterum to estimate the begin and end of growing season
+    !     from the OpenIFS meteorological data of the same year
+    !     for latitudes between 45 and 85deg north.
+    !     All others are basically the same as computed with GROWSEASON.
+    !
+    !// Stefanie Falk, August 2018
+    !//   Based on GROWSEASON (below).
+    !//   Enable usage of preprocessed GDAY/GLEN
+    !// --------------------------------------------------------------------
+    use cmn_sfc, only: GDAY_MAP, GLEN_MAP
+    !// --------------------------------------------------------------------
+    implicit none
+    !// --------------------------------------------------------------------
+    integer, intent(in)  :: JDAY
+    integer, intent(in)  :: I, J
+    integer, intent(out) :: GDAY, GLEN
+    !// --------------------------------------------------------------------
+    character(len=*), parameter :: subr = 'MAPPED_GROWSEASON'
+    !// --------------------------------------------------------------------
+    GLEN = GLEN_MAP(I,J)
+    GDAY = GDAY_MAP(I,J,JDAY)
+
+  end subroutine MAPPED_GROWSEASON
+  !// ----------------------------------------------------------------------
+
+  !// ----------------------------------------------------------------------
+  subroutine GROWSEASON ( JDAY, LAT, GDAY, GLEN )
+    !// --------------------------------------------------------------------
+    !  DESCRIPTION
+    !    This function computes the day of the growing season
+    !    corresponding to the given day of year.
+    !
+    !  HISTORY:
+    !    07/21/11 : Imported from SMOKE-BEIS v3.14 and modified  (Tan)
+    !               Variation of growing season depends on latitude
+    !               (Guenther)
+    !//
+    !// Amund Sovde Haslerud, October 2017
+    !//   Based on MEGANv2.10 code, modified for Oslo CTM3
+    !// --------------------------------------------------------------------
+    use cmn_ctm, only: LYEAR
+    !// --------------------------------------------------------------------
+    implicit none
+    !// --------------------------------------------------------------------
+    integer, intent(in)  :: JDAY
+    real(r8), intent(in) :: LAT
+    integer, intent(out) :: GDAY, GLEN
+    !// Locals
+    integer  :: &
+         GSEASON_START, GSEASON_END, &
+         MAY31,NOV1,DEC31
+    !// --------------------------------------------------------------------
+    character(len=*), parameter :: subr = 'GROWSEASON'
+    !// --------------------------------------------------------------------
+           
+    !// Days of year for important dates, taking leap year into account
+    if (LYEAR) then
+       MAY31 = 152
+       NOV1  = 306
+       DEC31 = 366
+    else
+       MAY31 = 151
+       NOV1  = 305
+       DEC31 = 365
+    end if
+    
+    if ( LAT .le. 23.0_r8 .and. LAT .ge. -23.0_r8 ) then
+       ! tropical regions, year round
+       GSEASON_START = 1
+       GSEASON_END = DEC31
+          
+       GDAY = JDAY - GSEASON_START + 1
+       GLEN = GSEASON_END - GSEASON_START + 1
+          
+    else if ( LAT .lt. -23.0_r8 ) then
+       ! southern hemisphere
+       if ( LAT .lt. -60.0_r8 ) then
+          ! antarctic start = 0 end = 0, no growing
+          GDAY = 0
+          GLEN = 0
+       else
+          ! southern hemisphere temperate, NOV, DEC, JAN-MAY
+          if (JDAY .ge. NOV1 .AND. JDAY .le. DEC31 ) THEN
+             GSEASON_START = NOV1
+             GSEASON_END   = DEC31
+             
+             GDAY = JDAY - GSEASON_START + 1
+             !// Total length of growing season (Nov-May)
+             GLEN = DEC31-NOV1 + 1 + MAY31
+          else if (JDAY .ge. 1 .and. JDAY .le. MAY31) then
+             GSEASON_START = 1
+             GSEASON_END   = MAY31
+             !// Add Nov+Dec
+             GDAY = JDAY - GSEASON_START + 1 + 61
+             GLEN = 61 + GSEASON_END - GSEASON_START + 1
+             !// Total length of growing season (Nov-May)
+             GLEN = DEC31-NOV1 + 1 + MAY31
+          else
+             GDAY = 0
+             GLEN = 0
+          end if
+          
+       end if
+
+    else if ( LAT .gt. 23._r8 ) then
+
+       ! northern hemisphere
+       if ( LAT .gt. 65.0_r8 ) then
+          ! arctic start = 0 end = 0, no growing season
+          GDAY = 0
+          GLEN = 0
+       else
+          ! northern hemisphere temperate
+          ! start= (lat-23)*4.5            189
+          ! end = 365 -((lat-23)*3.3)      226
+          
+          GSEASON_START = INT( (LAT - 23.0_r8) * 4.5_r8 )
+          GSEASON_END   = DEC31 - INT( (LAT - 23.0_r8) * 3.3_r8 )
+          
+          if (JDAY .ge. GSEASON_START .and. JDAY .le. GSEASON_END) then
+             GDAY = JDAY - GSEASON_START + 1
+          else
+             GDAY = 0
+          end if
+          GLEN = GSEASON_END - GSEASON_START + 1
+       end if
+    else
+       write(6,'(a,es16.6)') f90file//':'//subr//': Invalid LAT ',LAT
+       stop
+    end if
+    
+    !// --------------------------------------------------------------------
+  end subroutine GROWSEASON
+  !// ----------------------------------------------------------------------
+  !// ----------------------------------------------------------------------
 end module utilities_oslo
 !//=========================================================================
Index: OSLO/emisutils_oslo.f90
===================================================================
--- OSLO/emisutils_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/emisutils_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -31,7 +31,6 @@
   !//   subroutine read_bcoc_bond_2d
   !//   subroutine read_aerocom_2d
   !//   subroutine gfed4_rd
-  !//   subroutine gfed4_init
   !//   subroutine gfed4_rd_novert
   !//   subroutine gfed4_rd_novert_daily
   !//   subroutine read_ceds_cicero
@@ -2449,105 +2448,6 @@
 
 
   !// ----------------------------------------------------------------------
-  subroutine read_retrobbh_noresm(INFILE,efnr,IHLF,JHLF,LMAX,BBH,LPARW,LMMAP)
-    !// --------------------------------------------------------------------
-    !// Read biomass burning height distribution, matching NorESM
-    !// vertical resolution.
-    !//
-    !// Amund Sovde Haslerud, February 2018
-    !// --------------------------------------------------------------------
-    use ncutils, only: get_netcdf_var_1d, get_netcdf_var_3d
-    !// --------------------------------------------------------------------
-    implicit none
-    !// --------------------------------------------------------------------
-    integer, intent(in)       :: EFNR,IHLF,JHLF,LMAX,LPARW,LMMAP(LPARW)
-    character(len=*), intent(in) :: INFILE
-    real(r8), intent(out)       :: BBH(IHLF,JHLF,LMAX)
-
-    integer, parameter :: LHLF=13 !// Levels of input data
-    integer :: I,J, nLon, nLat, nLev
-    real(r8) :: BFRAC(IHLF,JHLF,LHLF),BBFRAC(IHLF,JHLF,LHLF)
-    character(len=60) :: FIELDNAME
-    real(r8), allocatable, dimension(:) :: inLon, inLat, inLev
-    !// --------------------------------------------------------------------
-    character(len=*), parameter :: subr = 'read_retrobbh'
-    !// --------------------------------------------------------------------
-    FIELDNAME = 'altitude_fraction'
-
-    !call readnc_field(BBFRAC,FIELDNAME,LONG,LAT,LEVEL,INFILE,IHLF,JHLF,LHLF)
-
-    !// Check resolution (latitude/longitude)
-    !// This routine allocates inLon/inLat
-    call get_netcdf_var_1d( infile, 'lon',  inLon  )
-    call get_netcdf_var_1d( infile, 'lat',  inLat  )
-    call get_netcdf_var_1d( infile, 'level',  inLev  )
-
-    nLon  = SIZE( inLon  )
-    nLat  = SIZE( inLat  )
-    nLev  = SIZE( inLev  )
-
-    deallocate( inLon, inLat, inLev )
-
-    if (nLon .ne. IHLF .or. nLat.ne.JHLF .or. nLev.ne.LHLF) then
-       write(6,'(a,3i5)') f90file//':'//subr// &
-            ': wrong resolution ', nLon, nLat, nLev
-       stop
-    end if
-
-    !// Get data, should be resolution 720x360x13
-    call get_netcdf_var_3d(infile, fieldname, BBFRAC, nLon, nLat, nLev)
-
-
-    !// Fit array to CTM grid
-    do I = 1, IHLF/2
-       BFRAC(IHLF/2+I,:,:)=BBFRAC(I,:,:)
-    end do
-    do I = (IHLF/2)+1, IHLF
-       BFRAC(I-IHLF/2,:,:)=BBFRAC(I,:,:)         
-    end do
-    do J = 1, JHLF
-       BBFRAC(:,JHLF-J+1,:)=BFRAC(:,J,:)
-    end do
-
-    !// Initialize output field
-    BBH(:,:,:)=0._r8
-
-    !// Do vertical adjustments
-    BBH(:,:,LMMAP( 1)) = BBH(:,:,LMMAP( 1)) + 0.10_r8*BBFRAC(:,:,1)
-    BBH(:,:,LMMAP( 2)) = BBH(:,:,LMMAP( 2)) + 0.21_r8*BBFRAC(:,:,1)
-    BBH(:,:,LMMAP( 3)) = BBH(:,:,LMMAP( 3)) + 0.40_r8*BBFRAC(:,:,1)
-    BBH(:,:,LMMAP( 4)) = BBH(:,:,LMMAP( 4)) + 0.29_r8*BBFRAC(:,:,1)
-    BBH(:,:,LMMAP( 4)) = BBH(:,:,LMMAP( 4)) + 0.29_r8*BBFRAC(:,:,2) !1.29
-    BBH(:,:,LMMAP( 5)) = BBH(:,:,LMMAP( 5)) + 0.71_r8*BBFRAC(:,:,2)
-    BBH(:,:,LMMAP( 5)) = BBH(:,:,LMMAP( 5)) + 0.06_r8*BBFRAC(:,:,3) !2.06
-    BBH(:,:,LMMAP( 6)) = BBH(:,:,LMMAP( 6)) + 0.94_r8*BBFRAC(:,:,3)
-    BBH(:,:,LMMAP( 6)) = BBH(:,:,LMMAP( 6)) + 0.02_r8*BBFRAC(:,:,4) !3.02
-    BBH(:,:,LMMAP( 7)) = BBH(:,:,LMMAP( 7)) + 0.98_r8*BBFRAC(:,:,4)
-    BBH(:,:,LMMAP( 8)) = BBH(:,:,LMMAP( 8)) + 0.16_r8*BBFRAC(:,:,5) !4.16
-    BBH(:,:,LMMAP( 8)) = BBH(:,:,LMMAP( 8)) + 0.84_r8*BBFRAC(:,:,5)
-    BBH(:,:,LMMAP( 8)) = BBH(:,:,LMMAP( 8)) + 0.29_r8*BBFRAC(:,:,6) !5.29
-    BBH(:,:,LMMAP( 9)) = BBH(:,:,LMMAP( 9)) + 0.71_r8*BBFRAC(:,:,6)
-    BBH(:,:,LMMAP( 9)) = BBH(:,:,LMMAP( 9)) + 0.42_r8*BBFRAC(:,:,7) !6.42
-    BBH(:,:,LMMAP(10)) = BBH(:,:,LMMAP(10)) + 0.48_r8*BBFRAC(:,:,7)
-    BBH(:,:,LMMAP(10)) = BBH(:,:,LMMAP(10)) + 0.56_r8*BBFRAC(:,:,8) !7.56
-    BBH(:,:,LMMAP(11)) = BBH(:,:,LMMAP(11)) + 0.44_r8*BBFRAC(:,:,8)
-    BBH(:,:,LMMAP(11)) = BBH(:,:,LMMAP(11)) + 0.69_r8*BBFRAC(:,:,9) !8.69
-    BBH(:,:,LMMAP(12)) = BBH(:,:,LMMAP(12)) + 0.31_r8*BBFRAC(:,:,9)
-    BBH(:,:,LMMAP(12)) = BBH(:,:,LMMAP(12)) + 0.82_r8*BBFRAC(:,:,10)!9.82
-    BBH(:,:,LMMAP(13)) = BBH(:,:,LMMAP(13)) + 0.18_r8*BBFRAC(:,:,10)
-    BBH(:,:,LMMAP(13)) = BBH(:,:,LMMAP(13)) + 0.96_r8*BBFRAC(:,:,11)!10.96
-    BBH(:,:,LMMAP(14)) = BBH(:,:,LMMAP(14)) + 0.04_r8*BBFRAC(:,:,11)
-    BBH(:,:,LMMAP(14)) = BBH(:,:,LMMAP(14)) + 1.00_r8*BBFRAC(:,:,12)
-    BBH(:,:,LMMAP(14)) = BBH(:,:,LMMAP(14)) + 0.09_r8*BBFRAC(:,:,13)!12.09
-    BBH(:,:,LMMAP(15)) = BBH(:,:,LMMAP(15)) + 0.91_r8*BBFRAC(:,:,13)
-
-    !// --------------------------------------------------------------------
-  end subroutine read_retrobbh_noresm
-  !// ----------------------------------------------------------------------
-
-
-
-  !// ----------------------------------------------------------------------
   subroutine read_bcoc_bond_2d(R8XY,INFILE,EFNR,IRES,JRES,MRES,NSETS)
     !// --------------------------------------------------------------------
     !// Read annual 2D data for BCOC (produced by Tami Bond), and put into
@@ -3512,8 +3412,7 @@
     use regridding, only: E_GRID
     use cmn_oslo, only: EPAR_FIR, NEFIR, EPAR_FIR_LM, ECOMP_FIR, EMIS_FIR, &
          FF_PATH, FF_YEAR, METHANEMIS, &
-         FF_CNAMES, FF_BNAMES, FF_SCALE, FF_PARTITIONS, EPAR_NPARTS, &
-         GFED4_NC, GFED4_NP, GFED4_EF, GFED4_NM
+         FF_CNAMES, FF_BNAMES, FF_SCALE, FF_PARTITIONS, EPAR_NPARTS
     use ncutils, only: get_netcdf_var_1d, get_netcdf_var_2d
     !// ------------------------------------------------------------------
     implicit none
@@ -3551,7 +3450,13 @@
     character(len=120) :: INFILE
     real(r8) :: tscale, scalefac
 
+    !// GFED4 emission factors
+    character(len=16) :: VAR
+    real(r8) :: f1,f2,f3,f4,f5,f6
+    integer, parameter :: NG4 = 41
     integer :: GFED4_N
+    real(r8) :: GFED4_EF(NPARTS,NG4)
+    character(len=16) :: GFED4_NM(NG4)
 
     real(r8), allocatable, dimension(:) :: QXBEDGE, QYBEDGE
     !// --------------------------------------------------------------------
@@ -3579,9 +3484,27 @@
        inquire(efnr,opened=file_status)
     end do
     
-    !// Get emission factors for all GFED4 species - done in gfed4_init
+    !// Get emission factors for all GFED4 species
+    infile = trim(FF_PATH)//'GFED4_Emission_Factors.txt'
+    open(efnr,file=infile,form='formatted',action='read')
+    do I = 1, 17
+       read(efnr,*) ! Reading header
+    end do
+    do I = 1, NG4
+       !// Read emission factors
+       read(efnr,*) VAR,f1,f2,f3,f4,f5,f6
+       GFED4_EF(1:6,I) = (/ f1,f2,f3,f4,f5,f6 /)
+       GFED4_NM(I) = VAR
+    end do
+    close(efnr)
 
+    write(6,'(a)') 'GFED4 emission factors'
+    write(6,'(a16,6a9)') 'Component',CPARTS
+    do I = 1, NG4
+       write(6,'(a16,6f9.3)')GFED4_NM(I),GFED4_EF(1:6,I)
+    end do
 
+
     !// Read DM from partitions
     !// ------------------------------------------------------------------
     !// Month to read
@@ -3646,7 +3569,7 @@
     !// Read DM for six categories; save data on 0.5x0.5 degree
     !// For each species, add all partitions together in 0.5x0.5.
     !// Finally convert to model resolution.
-    do N = 1, GFED4_NP
+    do N = 1, NPARTS
 
        !// Emission variable, expected units: kg/m2/s for each month
        !// GFED4 on netcdf has been converted to start at 0E,90S
@@ -3686,7 +3609,7 @@
 
        !// Find the GFED4 component number, if available.
        GFED4_N = -1
-       do I = 1, GFED4_NC
+       do I = 1, NG4
           if (trim(GFED4_NM(I)) .eq. trim(COMP)) then
              GFED4_N = I
              exit
@@ -3698,7 +3621,7 @@
 
        !// Sum up partitions for this species
        R8Q(:,:) = 0._r8
-       do N = 1, GFED4_NP
+       do N = 1, NPARTS
 
           if (partitions(N) .eq. 0) cycle
           !// Emission factors are g/kgDM, so we convert to kg, and also
@@ -3841,6 +3764,8 @@
     real(r8) :: tscale, scalefac
 
     !// GFED4 emission factors
+    character(len=16) :: VAR
+    real(r8) :: f1,f2,f3,f4,f5,f6
     integer :: GFED4_N
 
     real(r8), allocatable, dimension(:) :: QXBEDGE, QYBEDGE
Index: OSLO/soa_oslo.f90
===================================================================
--- OSLO/soa_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/soa_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -21,7 +21,6 @@
   !//   subroutine soa_diag_separate
   !//   subroutine soa_nopsdiag
   !//   subroutine soa_diag_lsscav
-  !//   subroutine soa_diag2file_nc4
   !//
   !// This module also contains some comprehensive diagnostics for SOA,
   !// to keep track of what is produced and lost of all SOA.
@@ -100,7 +99,7 @@
   save !// All variables are to be saved.
   private
   public soa_init, soa_setdrydep, SOA_v9_separate, soa_diag_drydep, &
-       soa_diag_separate, soa_diag2file_nc4, soa_diag2file, soa_nopsdiag, &
+       soa_diag_separate, soa_diag2file, soa_nopsdiag, &
        ndep_soa, soa_deps, soa_diag_lsscav, soa_diag_soagas
   !// ----------------------------------------------------------------------
 
@@ -1166,9 +1165,6 @@
     character(len=4)  :: cyear
     !// --------------------------------------------------------------------
 
-    write(6,'(a)') f90file//': should not use soa_diag2file, use soa_diag2file_nc4'
-    stop
-
     !// Open result file
     !// Find non-used file number for input file
     fnr_ok = .true.
@@ -1764,1048 +1760,6 @@
   !// ----------------------------------------------------------------------
 
 
-
   !// ----------------------------------------------------------------------
-  subroutine soa_diag2file_nc4(NDAY,NDAYI)
-    !// --------------------------------------------------------------------
-    !// Put out SOA diagnoses to two netCDF4 files.
-    !// Called from p-main.
-    !//
-    !// IMPORTANT:
-    !//   Controlled by BUDGET calendar!
-    !//
-    !// File 1: soa_budgets_YYYYMMDD_YYYYMMDD.nc
-    !//       3D values for all SOA/SOAGAS species
-    !//   For SOA (aerosols), the following are written (unit [g]):
-    !//   - Accumulated production by separation routine from NDAY0 to NDAY
-    !//   - Accumulated evaporation by separation routine from NDAY0 to NDAY
-    !//   - Accumulated dry deposition from NDAY0 to NDAY
-    !//   - Accumulated large scale wet scavenging from NDAY0 to NDAY
-    !//   - Accumulated convective wet scavenging from NDAY0 to NDAY
-    !//   For SOAGAS (gas species), the following are written (unit [g]):
-    !//   - Accumulated chemical production from NDAY0 to NDAY
-    !//   - Accumulated production by separationfrom NDAY0 to NDAY
-    !//   - Accumulated condensation by separation from NDAY0 to NDAY
-    !//   - Accumulated large scale wet scavenging from NDAY0 to NDAY
-    !//   - Accumulated convective wet scavenging from NDAY0 to NDAY
-    !//
-    !//   Instantaneous burden is not written to file - you should either
-    !//   include it, or use monthly averages.
-    !//
-    !// File 2: soa_dailybudgets_YYYY.nc
-    !//       Daily global totals of the same variables.
-    !//
-    !// Amund Sovde Haslerud, January 2018
-    !//   Writes to netCDF4.
-    !// Amund Sovde, June 2014, July 2012
-    !// --------------------------------------------------------------------
-    use cmn_precision, only: r4
-    use cmn_size, only: TNAMELEN
-    use cmn_ctm, only: STT, MPBLK, MPBLKJB, MPBLKJE, MPBLKIB, MPBLKIE, &
-         JDATE, JMON, JYEAR, JDATE, &
-         XDGRD, YDGRD, XDEDG, YDEDG, ETAA, ETAB, &
-         ZGRD, ZEDG, ETAA, ETAB
-    use cmn_chem, only: TNAME
-    use cmn_diag, only: NTND, NTND_CNSCAV, STTTND, STTTN0, TLDIAG, NDAY0, &
-         JDATE0, JMON0, JYEAR0, nc4deflate_global, nc4shuffle_global
-    use cmn_oslo, only: CONVWASHOUT, trsp_idx, RESULTDIR
-    use netcdf
-    use ncutils, only: handle_error
-    !// --------------------------------------------------------------------
-    implicit none
-    !// --------------------------------------------------------------------
-    !// Input
-    integer, intent(in) :: NDAY, NDAYI
-    !// Locals
-    integer :: TRNR,I,J,II,JJ,L,N,MP, ifnr
-    real(r8) :: tot_prod, tot_evap, tot_ddep, tot_lscav, tot_cscav, tot_burden
-    real(r8) :: tot_SepProdGas, tot_SepCondGas
-    real(r8) :: SCAV3D(IPAR,JPAR,LPAR,NDEP_SOA)
-    !// For file stuff
-    integer, dimension(6) :: start_time, end_time
-    character(len=8) :: datestamp, datestamp0
-    character(len=80) :: filename
-    character(len=4)  :: cyear
-
-    !// netCDF variables
-    !//---------------------------------------------------------------------
-    integer :: &
-         status, &          !Status for netcdf file 0=OK
-         ncid, &            !file id for output netcdf file
-         lon_dim_id, &      !Dimension id for longitude
-         lon_id, &          !Variable id for longitude
-         lat_dim_id, &      !Dimension id for latitude
-         lat_id, &          !Variable id for latitude
-         lev_dim_id, &      !Dimension id for level
-         lev_id, &          !Variable id for level
-         ilon_dim_id, &      !Dimension id for longitude interstices
-         ilon_id, &          !Variable id for longitude interstices
-         ilat_dim_id, &      !Dimension id for latitude interstices
-         ilat_id, &          !Variable id for latitude interstices
-         ilev_dim_id, &     !Dimension id for level interstices
-         ilev_id, &         !Variable id for level interstices
-         ihya_dim_id, &     !Dimension id for hybrid A on interstices
-         ihya_id, &         !Variable id for hybrid A on interstices
-         ihyb_dim_id, &     !Dimension id for hybrid B on interstices
-         ihyb_id, &         !Variable id for hybrid B on interstices
-         naer_dim_id, &     !Dimension id for NDEP_SOA
-         ngas_dim_id, &     !Dimension id for NGAS_SOA
-         days_dim_id, &     !Dimension id for days=366
-         date_size_dim_id, & !Dimension id for date sizes
-         soa_burden_id, &
-         soa_prod_id, soa_evap_id, soa_ddep_id, soa_lsscav_id, soa_cnvscav_id, &
-         soagas_prod_id, soagas_sepprod_id, soagas_sepcond_id, &
-         soagas_lsscav_id, soagas_cnvscav_id, soagas_burden_id, &
-         start_time_id, end_time_id, & !IDs for start/end dates for average
-         start_day_id, end_day_id      !IDs for start/end day (NDAY)
-    !// --------------------------------------------------------------------
-    integer, parameter :: nc4deflate = nc4deflate_global
-    integer, parameter :: nc4shuffle = nc4shuffle_global
-    !// --------------------------------------------------------------------
-    character(len=*), parameter :: subr = 'soa_diag2file_nc4'
-    !// --------------------------------------------------------------------
-
-
-    !//---------------------------------------------------------------------
-    !// Write netcdf4 file.
-    !//---------------------------------------------------------------------
-    !// File name is xxx_STARTDATE-ENDDATE.nc, where STARTDATE is taken
-    !// from JYEAR1,JMON1,JDATE1,00UTC and ENDDATE is taken from current
-    !// time, which is JYEAR,JMON,JDATE,00UTC (already updated by calendar).
-    !// Format of the dates are YYYYMMDDHHMM, where HHMM always is 0000.
-    !//---------------------------------------------------------------------
-    !// Start of budgets period at 00:00UTC
-    start_time = (/JYEAR0,JMON0,JDATE0,0,0,0/)
-    write(datestamp0(1:8),'(i4.4,2i2.2)') JYEAR0,JMON0,JDATE0
-    !// End of average period at 00:00UTC
-    end_time = (/JYEAR,JMON,JDATE,0,0,0/)
-    write(datestamp(1:8),'(i4.4,2i2.2)') JYEAR,JMON,JDATE
-
-    !//---------------------------------------------------------------------
-    !// File name SOA (aerosols)
-    filename = trim(RESULTDIR)//'soa_budgets_'//datestamp0//'_'//datestamp//'.nc'
-    !// Open netCDF4 file for writing
-    status = nf90_create(path=filename, cmode=nf90_netcdf4, ncid=ncid)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': in creating file')
-    !//---------------------------------------------------------------------
-
-
-
-    !//File headers
-    status=nf90_put_att(ncid,nf90_global,'title','Oslo CTM3 SOA budgets')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': file header')
-
-    !// Define lat/lon/lev
-    status = nf90_def_dim(ncid,"lat",JPAR,lat_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define lat dim')
-    status = nf90_def_dim(ncid,"lon",IPAR,lon_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define lon dim')
-    status = nf90_def_dim(ncid,"lev",LPAR,lev_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define lev dim')
-
-    !// Define ilat/ilon/ilev
-    status = nf90_def_dim(ncid,"ilat",JPAR+1,ilat_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define ilat dim')
-    status = nf90_def_dim(ncid,"ilon",IPAR+1,ilon_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//':define ilon dim')
-    status = nf90_def_dim(ncid,"ilev",LPAR+1,ilev_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define ilev dim')
-
-    !// Define NAER_SOA=NDEP_SOA and NGAS_SOA
-    status = nf90_def_dim(ncid,"NAER_SOA",NDEP_SOA,naer_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define NAER_SOA dim')
-    status = nf90_def_dim(ncid,"NGAS_SOA",NGAS_SOA,ngas_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define NGAS_SOA dim')
-
-    !// Define size of date stamps
-    status = nf90_def_dim(ncid,"date_size",size(start_time),date_size_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define date_size dim')
-
-    !//---------------------------------------------------------------------
-
-    !// Defining the lon variable
-    status = nf90_def_var(ncid,"lon",nf90_double,lon_dim_id,lon_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define lon variable')
-    !// Attributes
-    status = nf90_put_att(ncid,lon_id,'units','degrees east')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units lon')
-    status = nf90_put_att(ncid,lon_id,'description','Value at grid box center.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description lon')
-
-    !// Defining the lat variable
-    status = nf90_def_var(ncid,"lat",nf90_double,lat_dim_id,lat_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define lat variable')
-    !// Attributes
-    status = nf90_put_att(ncid,lat_id,'units','degrees north')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units lat')
-    status = nf90_put_att(ncid,lat_id,'description','Value at grid box center.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description lat')
-
-    !// Defining the lev variable
-    status = nf90_def_var(ncid,"lev",nf90_double,lev_dim_id,lev_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define lev variable')
-    !// Attributes
-    status = nf90_put_att(ncid,lev_id,'units','hPa')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units lev')
-    status = nf90_put_att(ncid,lev_id,'description', &
-         'Pressure at mass-weighted grid box center (mean of pressures at upper and lower edges), assuming surface at 1000hPa.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description lev')
-
-
-    !// Defining ilon variable (lon on interstices)
-    status = nf90_def_var(ncid,"ilon",nf90_double,ilon_dim_id,ilon_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define ilon variable')
-    !// Attributes
-    status = nf90_put_att(ncid,ilon_id,'units','degrees east')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units ilon')
-    status = nf90_put_att(ncid,ilon_id,'description','Value at eastern edge of grid box.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description ilon')
-
-    !// Defining ilat variable (lat on interstices)
-    status = nf90_def_var(ncid,"ilat",nf90_double,ilat_dim_id,ilat_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define ilat variable')
-    !// Attributes
-    status = nf90_put_att(ncid,ilat_id,'units','degrees north')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units ilat')
-    status = nf90_put_att(ncid,ilat_id,'description','Value at southern edge of grid box.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description ilat')
-
-    !// Defining ilev variable (lev on interstices)
-    status = nf90_def_var(ncid,"ilev",nf90_double,ilev_dim_id,ilev_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define ilev variable')
-    !// Attributes
-    status = nf90_put_att(ncid,ilev_id,'units','hPa')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units ilev')
-    status = nf90_put_att(ncid,ilev_id,'description', &
-         'Pressure at lower edge of grid box, assuming surface at 1000hPa.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description ilev')
-
-    !// Defining hybrid sigma coordinate A
-    status = nf90_def_var(ncid,"ihya",nf90_double,ilev_dim_id,ihya_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define ihya variable')
-    !// Attributes
-    status = nf90_put_att(ncid,ihya_id,'units','hPa')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units ihya')
-    status = nf90_put_att(ncid,ihya_id,'description', 'Sigma hybrid coordinate A.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description ihya')
-    status = nf90_put_att(ncid,ihya_id,'usage','p_box_bottom(L) = ihya(L) + ihyb(L)*p_surface')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute usage ihya')
-
-    !// Defining hybrid sigma coordinate B
-    status = nf90_def_var(ncid,"ihyb",nf90_double,ilev_dim_id,ihyb_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define ihyb variable')
-    !// Attributes
-    status = nf90_put_att(ncid,ihyb_id,'units','1')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units ihyb')
-    status = nf90_put_att(ncid,ihyb_id,'description', 'Sigma hybrid coordinate B.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description ihyb')
-    status = nf90_put_att(ncid,ihyb_id,'usage','p_box_bottom(L) = ihya(L) + ihyb(L)*p_surface')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute usage ihyb')
-
-
-
-    !// Start time for accumulating data - START_TIME
-    status = nf90_def_var(ncid,"START_TIME",nf90_int,date_size_dim_id,start_time_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define START_TIME variable')
-    status = nf90_put_att(ncid,start_time_id,'description', &
-         'Start date [YYYY,MM,DD,hh,mm,ss] for accumulating data.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description START_TIME')
-
-    !// End time for accumulating data - END_TIME
-    status = nf90_def_var(ncid,"END_TIME",nf90_int,date_size_dim_id,end_time_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define END_TIME variable')
-    status = nf90_put_att(ncid,end_time_id,'description', &
-         'End date [YYYY,MM,DD,hh,mm,ss] for accumulating data.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description END_TIME')
-
-    !// Start day for accumulating data - START_DAY (NDAY)
-    status = nf90_def_var(ncid,"START_DAY",nf90_int,start_day_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define START_DAY variable')
-    status = nf90_put_att(ncid,start_day_id,'description', &
-         'Start day for accumulating data (model counter NDAY).')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description START_DAY')
-
-    !// End day for accumulating data - END_DAY
-    status = nf90_def_var(ncid,"END_DAY",nf90_int,end_day_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define END_DAY variable')
-    status = nf90_put_att(ncid,end_day_id,'description', &
-         'End day for accumulating data (model counter NDAY).')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description END_DAY')
-
-
-    !// Define aerosol names
-    !// Define gas names
-
-
-    !// Define aerosol budgets
-    status = nf90_def_var(ncid,"SOA_PROD",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soa_prod_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_PROD variable')
-    status = nf90_def_var_deflate(ncid,soa_prod_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_PROD variable')
-    status = nf90_put_att(ncid,soa_prod_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_PROD')
-    status = nf90_put_att(ncid,soa_prod_id,'long_name','SOA production by separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_PROD')
-
-    status = nf90_def_var(ncid,"SOA_EVAP",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soa_evap_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_EVAP variable')
-    status = nf90_def_var_deflate(ncid,soa_evap_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_EVAP variable')
-    status = nf90_put_att(ncid,soa_evap_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_EVAP')
-    status = nf90_put_att(ncid,soa_evap_id,'long_name','SOA evaporation by separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_EVAP')
-
-    status = nf90_def_var(ncid,"SOA_DDEP",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soa_ddep_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_DDEP variable')
-    status = nf90_def_var_deflate(ncid,soa_ddep_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_DDEP variable')
-    status = nf90_put_att(ncid,soa_ddep_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_DDEP')
-    status = nf90_put_att(ncid,soa_ddep_id,'long_name','SOA dry deposition')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_DDEP')
-
-    status = nf90_def_var(ncid,"SOA_LSSCAV",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soa_lsscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_LSSCAV variable')
-    status = nf90_def_var_deflate(ncid,soa_lsscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_LSSCAV variable')
-    status = nf90_put_att(ncid,soa_lsscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_LSSCAV')
-    status = nf90_put_att(ncid,soa_lsscav_id,'long_name','SOA scavenged by large scale precipitation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_LSSCAV')
-
-    status = nf90_def_var(ncid,"SOA_CNVSCAV",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soa_cnvscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_CNVSCAV variable')
-    status = nf90_def_var_deflate(ncid,soa_cnvscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_CNVSCAV variable')
-    status = nf90_put_att(ncid,soa_cnvscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_CNVSCAV')
-    status = nf90_put_att(ncid,soa_cnvscav_id,'long_name','SOA scavenged by convective precipitation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_CNVSCAV')
-
-
-    !// Define gas budgets
-    !// Produced in chemistry
-    status = nf90_def_var(ncid,"SOAGAS_PROD",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soagas_prod_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_PROD variable')
-    status = nf90_def_var_deflate(ncid,soagas_prod_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_PROD variable')
-    status = nf90_put_att(ncid,soagas_prod_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_PROD')
-    status = nf90_put_att(ncid,soagas_prod_id,'long_name','SOAGAS chemical production')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_PROD')
-
-    !// Produced in SOA_separate
-    status = nf90_def_var(ncid,"SOAGAS_SEPPROD",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soagas_sepprod_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_SEPPROD variable')
-    status = nf90_def_var_deflate(ncid,soagas_sepprod_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_SEPPROD variable')
-    status = nf90_put_att(ncid,soagas_sepprod_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_SEPPROD')
-    status = nf90_put_att(ncid,soagas_sepprod_id,'long_name','SOAGAS production in separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_SEPPROD')
-
-    !// Condensed in SOA_separate
-    status = nf90_def_var(ncid,"SOAGAS_SEPCOND",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soagas_sepcond_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_SEPCOND variable')
-    status = nf90_def_var_deflate(ncid,soagas_sepcond_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_SEPCOND variable')
-    status = nf90_put_att(ncid,soagas_sepcond_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_SEPCOND')
-    status = nf90_put_att(ncid,soagas_sepcond_id,'long_name','SOAGAS condensation in separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_SEPCOND')
-
-    status = nf90_def_var(ncid,"SOAGAS_LSSCAV",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soagas_lsscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_LSSCAV variable')
-    status = nf90_def_var_deflate(ncid,soagas_lsscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_LSSCAV variable')
-    status = nf90_put_att(ncid,soagas_lsscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_LSSCAV')
-    status = nf90_put_att(ncid,soagas_lsscav_id,'long_name','SOAGAS scavenged by large scale precipitation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_LSSCAV')
-
-    status = nf90_def_var(ncid,"SOAGAS_CNVSCAV",nf90_float, &
-         (/lon_dim_id, lat_dim_id, lev_dim_id, naer_dim_id/), soagas_cnvscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_CNVSCAV variable')
-    status = nf90_def_var_deflate(ncid,soagas_cnvscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_CNVSCAV variable')
-    status = nf90_put_att(ncid,soagas_cnvscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_CNVSCAV')
-    status = nf90_put_att(ncid,soagas_cnvscav_id,'long_name','SOAGAS scavenged by convective precipitation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_CNVSCAV')
-
-
-    !//---------------------------------------------------------------------
-    !// End definition mode
-    status = nf90_enddef(ncid)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': end defmode')
-    !//---------------------------------------------------------------------
-
-    !// Putting the lon/lat/lev variables
-    status = nf90_put_var(ncid,lon_id,XDGRD)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting lon')
-    status = nf90_put_var(ncid,lat_id,YDGRD)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting lat')
-    status = nf90_put_var(ncid,lev_id,ZGRD)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting lev')
-
-    status = nf90_put_var(ncid,ilon_id,XDEDG)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting ilon')
-    status = nf90_put_var(ncid,ilat_id,YDEDG)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting ilat')
-    status = nf90_put_var(ncid,ilev_id,ZEDG)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting ilev')
-
-    status = nf90_put_var(ncid,ihya_id,ETAA)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting ihya')
-    status = nf90_put_var(ncid,ihyb_id,ETAB)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting ihyb')
-
-    !// Start time
-    status = nf90_put_var(ncid,start_time_id,start_time)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting START_TIME')
-    !// End time
-    status = nf90_put_var(ncid,end_time_id,end_time)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting END_TIME')
-
-    !// Start day (NDAY counter)
-    status = nf90_put_var(ncid,start_day_id,NDAY0)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting START_DAY')
-    !// End day (NDAY counter)
-    status = nf90_put_var(ncid,end_day_id,NDAY-1)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting END_DAY')
-
-
-    !//---------------------------------------------------------------------
-    !// Put out SOA
-    !//---------------------------------------------------------------------
-
-    !// Production from SOA_separate [kg]
-    status = nf90_put_var(ncid,soa_prod_id,TOTAL_SOA_PROD)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_PROD')
-
-    !// Evaporation from SOA_separate [kg]
-    status = nf90_put_var(ncid,soa_evap_id,TOTAL_SOA_EVAP)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_EVAP')
-
-    !// Loss due to dry deposition
-    status = nf90_put_var(ncid,soa_ddep_id,TOTAL_SOA_DDEP)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_DDEP')
-
-    !// Large scale wet scav loss
-    status = nf90_put_var(ncid,soa_lsscav_id,TOTAL_SOA_LSSCAV)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_LSSCAV')
-
-    !// Convective wet scav loss
-    !// Even though wet loss is diagnosed using the CTM3 core diagnostic
-    !// arrays, namely the real*4 STTTND, we do a separate diagnotic here in
-    !// real*8. For convective scavenging, the CTM3 diagnose CONVWASHOUT is
-    !// used. This means that SOA 3D diagnose is tied to BUDGET calendar
-    !// in LxxTyy-file.
-    SCAV3D(:,:,:,:) = 0._r8
-    if (NTND_CNSCAV .gt. 0) then
-       do MP = 1, MPBLK
-          do J = MPBLKJB(MP),MPBLKJE(MP)
-             JJ    = J - MPBLKJB(MP) + 1
-             do I = MPBLKIB(MP),MPBLKIE(MP)
-                II    = I - MPBLKIB(MP) + 1
-                do N = 1, ndep_soa
-                   TRNR = trsp_idx(SOA_DEPS(N))
-                   do L = 1, LPAR
-                      SCAV3D(I,J,L,N) = &
-                           + CONVWASHOUT(L,TRNR,II,JJ,MP) * 1000._r8 !// kg -> g
-                   end do
-                end do
-             end do
-          end do
-       end do
-    end if
-
-    status = nf90_put_var(ncid,soa_cnvscav_id,SCAV3D)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_CNVSCAV')
-
-
-    !//---------------------------------------------------------------------
-
-    !// Print out total production and loss and life time
-    !// Set totals for each process
-    tot_prod = sum(TOTAL_SOA_PROD)
-    tot_evap = sum(TOTAL_SOA_EVAP)
-    tot_ddep = sum(TOTAL_SOA_DDEP)
-    tot_lscav = sum(TOTAL_SOA_LSSCAV)
-    tot_cscav = 0._r8
-    if (NTND_CNSCAV .gt. 0) then
-       do N = 1, ndep_soa
-          TRNR = trsp_idx(SOA_DEPS(N))
-          tot_cscav = tot_cscav + STTTN0(TRNR,NTND_CNSCAV) * 1000._r8 !// kg -> g
-       end do
-    end if
-
-    !// Burden [g] (instantaneous values)
-    SCAV3D(:,:,:,:) = 0._r8
-    do N = 1, ndep_soa
-       TRNR = trsp_idx(SOA_DEPS(N))
-       SCAV3D(:,:,:,N) = STT(:,:,:,TRNR) * 1000._r8
-    end do
-    tot_burden = sum(SCAV3D)
-
-    write(6,'(a,5es11.3,f5.1)') '* SOA AVG P/E/D/L/C/life:', &
-         tot_prod, tot_evap, tot_ddep, tot_lscav, tot_cscav, &
-         -tot_burden / (tot_ddep + tot_lscav + tot_cscav) &
-           * real(NDAY-NDAY0+1, r8)
-    !//---------------------------------------------------------------------
-
-
-
-
-    !//---------------------------------------------------------------------
-    !// Put out SOAGAS
-    !//---------------------------------------------------------------------
-
-    !//---------------------------------------------------------------------
-    !// Production in chemistry [kg]
-    status = nf90_put_var(ncid,soagas_prod_id,TOTAL_SOAG_PROD)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_PROD')
-
-    !// Production from SOAGAS_separate [kg]
-    status = nf90_put_var(ncid,soagas_sepprod_id,TOTAL_SOAG_SEPPROD)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_SEPPROD')
-
-    !// Evaporation from SOAGAS_separate [kg]
-    status = nf90_put_var(ncid,soagas_sepcond_id,TOTAL_SOAG_SEPCOND)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_SEPCOND')
-
-    !// Large scale wet scav loss
-    status = nf90_put_var(ncid,soagas_lsscav_id,TOTAL_SOAG_LSSCAV)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_LSSCAV')
-
-    !// Add convective wet scav loss to 3D loss
-    SCAV3D(:,:,:,:) = 0._r8
-    if (NTND_CNSCAV .gt. 0) then
-       do MP = 1, MPBLK
-          do J = MPBLKJB(MP),MPBLKJE(MP)
-             JJ    = J - MPBLKJB(MP) + 1
-             do I = MPBLKIB(MP),MPBLKIE(MP)
-                II    = I - MPBLKIB(MP) + 1
-                do N = 1, ngas_soa
-                   TRNR = trsp_idx(SOA_GAS(N))
-                   do L = 1, LPAR
-                      SCAV3D(I,J,L,N) = &
-                           + CONVWASHOUT(L,TRNR,II,JJ,MP) * 1000._r8 !// kg -> g
-                   end do
-                end do
-             end do
-          end do
-       end do
-    end if
-    status = nf90_put_var(ncid,soagas_cnvscav_id,SCAV3D)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_CNVSCAV')
-
-
-    !// --------------------------------------------------------------------
-    !// Even though wet loss is diagnosed using the CTM3 core diagnostic
-    !// arrays, namely the real*4 STTTND, we do a separate diagnotic here
-    !// real*8. For convective scavenging, the CTM3 diagnose CONVWASHOUT is
-    !// used. This means that SOA 3D diagnose is tied to BUDGET calendar
-    !// in LxxTyy-file.
-    tot_prod = sum(TOTAL_SOAG_PROD)
-    tot_SepProdGas = sum(TOTAL_SOAG_SEPPROD)
-    tot_SepCondGas = sum(TOTAL_SOAG_SEPCOND)
-    tot_lscav = sum(TOTAL_SOAG_LSSCAV)
-
-    !// Add convective wet scav loss to 3D loss
-    tot_cscav = 0._r8
-    if (NTND_CNSCAV .gt. 0) then
-       do N = 1, ngas_soa
-          TRNR = trsp_idx(SOA_GAS(N))
-          tot_cscav = tot_cscav + STTTN0(TRNR,NTND_CNSCAV) * 1000._r8 !// kg -> g
-       end do
-    end if
-
-    !// Burden [g] (instantaneous values)
-    SCAV3D(:,:,:,:) = 0._r8
-    do N = 1, ngas_soa
-       TRNR = trsp_idx(SOA_GAS(N))
-       SCAV3D(:,:,:,N) = STT(:,:,:,TRNR) * 1000._r8
-    end do
-    tot_burden = sum(SCAV3D)
-
-
-    !// Print out total production and loss and lifetime
-    write(6,'(a,5es11.3,f5.1)') '* SOAG AVG P/SP/SC/L/C/life:', &
-         tot_prod, tot_sepprodgas, tot_sepcondgas, tot_lscav, tot_cscav, &
-         -tot_burden / (tot_sepcondGas + tot_lscav + tot_cscav) &
-           * real(NDAY-NDAY0+1, r8)
-    !// --------------------------------------------------------------------
-
-
-    !//---------------------------------------------------------------------
-    !// close netcdf file
-    status = nf90_close(ncid)
-    if (status .ne. nf90_noerr) &
-         call handle_error(status,'close file: '//trim(filename))
-    write(6,'(a)') f90file//':'//subr//': wrote file '//trim(filename)
-    write(6,'(a71)') '--------------------------------------------'// &
-         '---------------------------'
-    !//---------------------------------------------------------------------
-
-
-    !// --------------------------------------------------------------------
-    !// Re-initialise diagnoses SOA
-    TOTAL_SOA_DDEP(:,:,:) = 0._r8
-    TOTAL_SOA_PROD(:,:,:,:) = 0._r8
-    TOTAL_SOA_EVAP(:,:,:,:) = 0._r8
-    TOTAL_SOA_LSSCAV(:,:,:,:) = 0._r8
-    !// Reset old values for nopsdiag
-    oldProd(:) = 0._r8
-    oldEvap(:) = 0._r8
-    oldDDep(:) = 0._r8
-    !// Must reset oldLscv and oldCscv also!
-    !// After this routine is completed, p-main will call TBGT_G to
-    !// reset STTTND and STTTN0.
-    oldLscv(:) = 0._r8
-    oldCscv(:) = 0._r8
-    !//---------------------------------------------------------------------
-    !// Re-initialise diagnoses SOAGAS
-    TOTAL_SOAG_PROD(:,:,:,:) = 0._r8
-    TOTAL_SOAG_SEPPROD(:,:,:,:) = 0._r8
-    TOTAL_SOAG_SEPCOND(:,:,:,:) = 0._r8
-    TOTAL_SOA_LSSCAV(:,:,:,:) = 0._r8
-    !// Reset old values for nopsdiag
-    oldProdGas(:) = 0._r8
-    oldSepProdGas(:) = 0._r8
-    oldSepCondGas(:) = 0._r8
-    !// Must reset oldLscv and oldCscv also!
-    !// After this routine is completed, p-main will call TBGT_G to
-    !// reset STTTND and STTTN0.
-    oldLscvGas(:) = 0._r8
-    oldCscvGas(:) = 0._r8
-    !// --------------------------------------------------------------------
-
-
-
-
-
-
-    !//---------------------------------------------------------------------
-    !// Write daily accumulated data to netCDF4 file
-    !// This routine is called after JDAY/JMON/JYEAR have been updated
-    if (JDATE.eq.1 .and. JMON.eq.1) then
-       write(cyear,'(i4.4)') JYEAR-1 !// Has been updated to next year
-    else
-       write(cyear,'(i4.4)') JYEAR   !// Current year
-    end if
-    filename = 'soa_dailybudgets_'//cyear//'.nc'
-    !// Open netCDF4 file for writing
-    status = nf90_create(path=filename, cmode=nf90_netcdf4, ncid=ncid)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': in creating file')
-    !//---------------------------------------------------------------------
-
-    !//File headers
-    status=nf90_put_att(ncid,nf90_global,'title','Oslo CTM3 SOA daily global budgets')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': file header')
-
-    !// Define NAER_SOA=NDEP_SOA and NGAS_SOA
-    status = nf90_def_dim(ncid,"NAER_SOA",NDEP_SOA,naer_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define NAER_SOA dim')
-    status = nf90_def_dim(ncid,"NGAS_SOA",NGAS_SOA,ngas_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define NGAS_SOA dim')
-
-    status = nf90_def_dim(ncid,"days",366,days_dim_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define days dim')
-
-    !//---------------------------------------------------------------------
-    
-
-    status = nf90_def_var(ncid,"SOA_burden",nf90_float, &
-         (/naer_dim_id, days_dim_id/), soa_burden_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_burden variable')
-    status = nf90_def_var_deflate(ncid,soa_burden_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_burden variable')
-    status = nf90_put_att(ncid,soa_burden_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_burden')
-    status = nf90_put_att(ncid,soa_burden_id,'long_name','SOA daily global burden')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_burden')
-
-    status = nf90_def_var(ncid,"SOA_prod",nf90_float, &
-         (/naer_dim_id, days_dim_id/), soa_prod_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_prod variable')
-    status = nf90_def_var_deflate(ncid,soa_prod_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_prod variable')
-    status = nf90_put_att(ncid,soa_prod_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_prod')
-    status = nf90_put_att(ncid,soa_prod_id,'long_name','SOA daily global production by separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_prod')
-
-    status = nf90_def_var(ncid,"SOA_evap",nf90_float, &
-         (/naer_dim_id, days_dim_id/), soa_evap_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_evap variable')
-    status = nf90_def_var_deflate(ncid,soa_evap_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_evap variable')
-    status = nf90_put_att(ncid,soa_evap_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_evap')
-    status = nf90_put_att(ncid,soa_evap_id,'long_name','SOA daily global evaporation by separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_evap')
-
-    status = nf90_def_var(ncid,"SOA_ddep",nf90_float, &
-         (/naer_dim_id, days_dim_id/), soa_ddep_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_ddep variable')
-    status = nf90_def_var_deflate(ncid,soa_ddep_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_ddep variable')
-    status = nf90_put_att(ncid,soa_ddep_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_ddep')
-    status = nf90_put_att(ncid,soa_ddep_id,'long_name','SOA daily global drydeposition')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_ddep')
-
-    status = nf90_def_var(ncid,"SOA_lsscav",nf90_float, &
-         (/naer_dim_id, days_dim_id/), soa_lsscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_lsscav variable')
-    status = nf90_def_var_deflate(ncid,soa_lsscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_lsscav variable')
-    status = nf90_put_att(ncid,soa_lsscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_lsscav')
-    status = nf90_put_att(ncid,soa_lsscav_id,'long_name','SOA daily global lsscav')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_lsscav')
-
-    status = nf90_def_var(ncid,"SOA_cnvscav",nf90_float, &
-         (/naer_dim_id, days_dim_id/), soa_cnvscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOA_cnvscav variable')
-    status = nf90_def_var_deflate(ncid,soa_cnvscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOA_cnvscav variable')
-    status = nf90_put_att(ncid,soa_cnvscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOA_cnvscav')
-    status = nf90_put_att(ncid,soa_cnvscav_id,'long_name','SOA daily global cnvscav')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOA_cnvscav')
-
-
-
-
-    status = nf90_def_var(ncid,"SOAGAS_burden",nf90_float, &
-         (/ngas_dim_id, days_dim_id/), soagas_burden_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_burden variable')
-    status = nf90_def_var_deflate(ncid,soagas_burden_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_burden variable')
-    status = nf90_put_att(ncid,soagas_burden_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_burden')
-    status = nf90_put_att(ncid,soagas_burden_id,'long_name','SOAGAS daily global burden')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_burden')
-
-    status = nf90_def_var(ncid,"SOAGAS_prod",nf90_float, &
-         (/ngas_dim_id, days_dim_id/), soagas_prod_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_prod variable')
-    status = nf90_def_var_deflate(ncid,soagas_prod_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_prod variable')
-    status = nf90_put_att(ncid,soagas_prod_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_prod')
-    status = nf90_put_att(ncid,soagas_prod_id,'long_name','SOAGAS daily global produced in chemistry')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_prod')
-
-    status = nf90_def_var(ncid,"SOAGAS_sepprod",nf90_float, &
-         (/ngas_dim_id, days_dim_id/), soagas_sepprod_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_sepprod variable')
-    status = nf90_def_var_deflate(ncid,soagas_sepprod_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_sepprod variable')
-    status = nf90_put_att(ncid,soagas_sepprod_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_sepprod')
-    status = nf90_put_att(ncid,soagas_sepprod_id,'long_name','SOAGAS daily global prod in separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_sepprod')
-
-    status = nf90_def_var(ncid,"SOAGAS_sepcond",nf90_float, &
-         (/ngas_dim_id, days_dim_id/), soagas_sepcond_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_sepcond variable')
-    status = nf90_def_var_deflate(ncid,soagas_sepcond_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_sepcond variable')
-    status = nf90_put_att(ncid,soagas_sepcond_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_sepcond')
-    status = nf90_put_att(ncid,soagas_sepcond_id,'long_name','SOAGAS daily global condensed in separation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_sepcond')
-
-
-    status = nf90_def_var(ncid,"SOAGAS_lsscav",nf90_float, &
-         (/ngas_dim_id, days_dim_id/), soagas_lsscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_lsscav variable')
-    status = nf90_def_var_deflate(ncid,soagas_lsscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_lsscav variable')
-    status = nf90_put_att(ncid,soagas_lsscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_lsscav')
-    status = nf90_put_att(ncid,soagas_lsscav_id,'long_name','SOAGAS daily global scavenged by large scale precipitation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_lsscav')
-
-    status = nf90_def_var(ncid,"SOAGAS_cnvscav",nf90_float, &
-         (/ngas_dim_id, days_dim_id/), soagas_cnvscav_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SOAGAS_cnvscav variable')
-    status = nf90_def_var_deflate(ncid,soagas_cnvscav_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SOAGAS_cnvscav variable')
-    status = nf90_put_att(ncid,soagas_cnvscav_id,'units','g')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute unit SOAGAS_cnvscav')
-    status = nf90_put_att(ncid,soagas_cnvscav_id,'long_name','SOAGAS daily global scavenged by convective precipitation')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute long_name SOAGAS_cnvscav')
-
-    !//---------------------------------------------------------------------
-    !// End definition mode
-    status = nf90_enddef(ncid)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': end defmode')
-    !//---------------------------------------------------------------------
-
-    !// Burden [g]
-    status = nf90_put_var(ncid,soa_burden_id,dailyBrdn)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_burden')
-
-    status = nf90_put_var(ncid,soa_prod_id,dailyProd)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_prod')
-
-    status = nf90_put_var(ncid,soa_evap_id,dailyEvap)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_evap')
-
-    status = nf90_put_var(ncid,soa_ddep_id,dailyDdep)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_ddep')
-
-    status = nf90_put_var(ncid,soa_lsscav_id,dailyLscv)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_lsscav')
-
-    status = nf90_put_var(ncid,soa_cnvscav_id,dailyCscv)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOA_cnvscav')
-
-
-
-    !// SOAGAS
-    status = nf90_put_var(ncid,soagas_burden_id,dailyBrdnGas)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_burden')
-
-    status = nf90_put_var(ncid,soagas_prod_id,dailyProdGas)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_prod')
-
-    status = nf90_put_var(ncid,soagas_sepprod_id,dailySepProdGas)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_sepprod')
-
-    status = nf90_put_var(ncid,soagas_sepcond_id,dailySepCondGas)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_sepcond')
-
-    status = nf90_put_var(ncid,soagas_lsscav_id,dailyLscvGas)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_lsscav')
-
-    status = nf90_put_var(ncid,soagas_cnvscav_id,dailyCscvGas)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SOAGAS_cnvscav')
-
-    !//---------------------------------------------------------------------
-    !// close netcdf file
-    status = nf90_close(ncid)
-    if (status .ne. nf90_noerr) &
-         call handle_error(status,'close file: '//trim(filename))
-    write(6,'(a)') f90file//':'//subr//': wrote file '//trim(filename)
-    write(6,'(a71)') '--------------------------------------------'// &
-         '---------------------------'
-    !//---------------------------------------------------------------------
-
-
-    !// Reset if new year
-    !// Note that this will fail if diagnostics are not done 1Jan.
-    if (JDATE.eq.1 .and. JMON.eq.1) then
-       dailyProd(:,:) = 0._r8
-       dailyEvap(:,:) = 0._r8
-       dailyDDep(:,:) = 0._r8
-       dailyLscv(:,:) = 0._r8
-       dailyCscv(:,:) = 0._r8
-       dailyBrdn(:,:) = 0._r8
-
-       dailyProdGas(:,:) = 0._r8
-       dailySepProdGas(:,:) = 0._r8
-       dailySepCondGas(:,:) = 0._r8
-       dailyLscvGas(:,:) = 0._r8
-       dailyCscvGas(:,:) = 0._r8
-       dailyBrdnGas(:,:) = 0._r8
-    end if
-
-
-    !// --------------------------------------------------------------------
-  end subroutine soa_diag2file_nc4
-  !// ----------------------------------------------------------------------
-
-
-
-  !// ----------------------------------------------------------------------
 end module soa_oslo
 !//=========================================================================
Index: OSLO/ncutils.f90
===================================================================
--- OSLO/ncutils.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/ncutils.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -42,8 +42,7 @@
 
   !// ----------------------------------------------------------------------
   subroutine readnc_3d_from4d(INFILE, DIMNAME1, DIM1, DIMNAME2, DIM2, &
-       DIMNAME3, DIM3, DIMNAME4, GET4ENTRY, GETFIELDNAME, R8XYZ, &
-       SILENT)
+       DIMNAME3, DIM3, DIMNAME4, GET4ENTRY, GETFIELDNAME, R8XYZ)
     !// --------------------------------------------------------------------
     !// Read netCDF file containing 4D fields (DIM1,DIM2,DIM3,DIM4), and
     !// returns 3D-field for DIM4-entry TSTEP. Typically, we have
@@ -71,7 +70,6 @@
                                               !// No need for DIM4
     integer,intent(in)          :: GET4ENTRY  !// Entry to get from dimension4
     character(len=*), intent(in)   :: getfieldname  !// Name of field to get
-    integer, optional, intent(in)  :: SILENT !// non-zero: Do not print info
 
     !// Output
     real(r8), intent(out)        :: R8XYZ(DIM1,DIM2,DIM3)
@@ -184,10 +182,7 @@
     if (status /= NF90_NOERR) call handle_error(status, &
          subr//':'//trim(infile)//':'//trim(getfieldname)//':get_var')
 
-    if (present(SILENT)) then
-       if (SILENT.eq.1) &
-            write(6,'(a)') f90file//':'//subr//': Got variable '//trim(getfieldname)
-    end if
+    write(6,'(a)') f90file//':'//subr//': Got variable '//trim(getfieldname)
 
     !// Close file
     status=nf90_close(ncid)
@@ -202,7 +197,7 @@
 
   !// ----------------------------------------------------------------------
   subroutine readnc_2d_from3d(INFILE, DIMNAME1, DIM1, DIMNAME2, DIM2, &
-       DIMNAME3, GET3ENTRY, GETFIELDNAME, R8XY, SILENT)
+       DIMNAME3, GET3ENTRY, GETFIELDNAME, R8XY)
     !// --------------------------------------------------------------------
     !// Read netCDF file containing 4D fields (DIM1,DIM2,DIM3), and
     !// returns 2D-field for DIM3-entry TSTEP. Typically, we have
@@ -227,7 +222,6 @@
 
     integer, intent(in)          :: GET3ENTRY  !// Entry to get from dimension3
     character(len=*), intent(in) :: getfieldname  !// Name of field to get
-    integer, optional, intent(in):: SILENT !// non-zero: Do not print info
 
     !// Output
     real(r8), intent(out)        :: R8XY(DIM1,DIM2)
@@ -324,12 +318,8 @@
     if (status /= NF90_NOERR) call handle_error(status, &
          subr//':'//trim(infile)//':'//trim(getfieldname)//':get_var')
 
-    if (present(SILENT)) then
-       if (SILENT.eq.1) &
-            write(6,'(a)') f90file//':'//subr//': Got variable '//trim(getfieldname)
-    end if
+    write(6,'(a)') f90file//':'//subr//': Got variable '//trim(getfieldname)
 
-
     !// Close file
     status=nf90_close(ncid)
     if (status /= NF90_NOERR) call handle_error(status, &
Index: OSLO/pchemc_ij.f90
===================================================================
--- OSLO/pchemc_ij.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/pchemc_ij.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -182,7 +182,7 @@
          M_O3,  M_PANX,  M_CO,   M_H2O2, M_HO2,  &
          M_O3P, M_O1D,   M_OH,   M_CH4, &
          M_C2H4,  M_C2H6,   M_C3H6,  M_C3H8, M_C4H10, M_ARAD, &
-         M_CH2O,  M_CH3OH, M_CH3CHO, M_HCOHCO, M_RCOHCO, &
+         M_CH2O,  M_CH3CHO, M_HCOHCO, M_RCOHCO, &
          M_ISOPREN, M_ISOR1, M_ISOK,   M_ISOR2, &
          M_C6H14,  M_C6HXR, &
          M_CH3CO, &
@@ -615,8 +615,8 @@
         M_C3H7O2 = ZC(49,L)
         M_ACETON = ZC(50,L)
         M_CH3COD = ZC(51,L) !// CH3COD = CH3COCH2(O2)  
-        M_CH3OH  = ZC(52,L)
 
+
         !// Sulphur chemistry
         M_DMS    = ZC(71,L)
         M_SO2    = ZC(72,L)
@@ -1044,7 +1044,6 @@
                + k_ch3o2_isor2 * M_ISOR2   &
              ) * M_CH3O2 &
              + 0.03_r8 * k_o3_c3h6 * M_C3H6 * M_O3 &
-             + 0.15_r8 * k_oh_ch3oh * M_CH3OH * M_OH &
              + DCH3O2H * M_CH3O2H
         if (.not. LOLD_H2OTREATMENT) PROD = PROD &
              + k_od_ch4_b * M_O1D * M_CH4 !O(1D) + CH4 -> (CH3O/CH2OH + H)
@@ -1085,7 +1084,6 @@
                k_no2_oh_m * M_NO2       &!OH + NO2 -M-> HNO3
                + k_oh_c2h4_m * M_C2H4    &!OH + C2H4 -> (HOCH2CH2) --> CH3 + HCHO
                + k_oh_ch2o * M_CH2O    &!OH + HCHO -> 
-               + k_oh_ch3oh * M_CH3OH  &!OH + CH3OH -> CH3O/CH2OH + H2O -> CH2O + HO2
                + (k_oh_co_a + k_oh_co_b) * M_CO      &!OH + CO   -> HO2 (CO2)
                + k_oh_ch4 * M_CH4     &!OH + CH4  -> CH3 + H2O
                + k_oh_h2o2 * M_H2O2    &!OH + H2O2 -> HO2 + H2O
@@ -1190,7 +1188,6 @@
           RLIM2 = &
                (k_oh_co_a + k_oh_co_b) * M_CO        &!OH + CO   -> HO2 (CO2)
                + k_oh_h2o2 * M_H2O2    &!OH + H2O2 -> HO2 + H2O
-               + 0.85_r8 * k_oh_ch3oh * M_CH3OH &!OH + CH3OH -> CH2OH + H2O -> CH2O + HO2
                + k_o3_oh * M_O3      &!OH + O3   -> HO2 + O2
                + k_oh_hcohco_m_c * M_HCOHCO &!OH + HCOHCO -O2-> 2CO + HO2
                + k_oh_ho2no2 * M_HO2NO2  &!HO2NO2 + OH -> NO2 + H2O + O2
@@ -1591,7 +1588,6 @@
                    + k_ch3o2_c6h13o2 * M_C6H13O2 &
                  ) * M_CH3O2 &
                + 0.03_r8 * k_o3_c3h6 * M_C3H6 * M_O3 &
-               + 0.15_r8 * k_oh_ch3oh * M_CH3OH * M_OH &
                + k_ch3o2_ch3x_a * M_CH3O2 * M_CH3X &
                + DCH3O2H * M_CH3O2H &
                + (k_ch3o2_isor1 * M_ISOR1 &
@@ -1624,7 +1620,6 @@
                + k_ch3o_o2 * M_CH3O * M_O2 &
                + k_cho_o2 * M_CHO * M_O2 &
                + k_oh_h2o2 * M_OH * M_H2O2 &
-               + 0.85_r8 * k_oh_ch3oh * M_CH3OH &!OH + CH3OH -> CH2OH + H2O -> CH2O + HO2
                + k_o3_oh * M_OH * M_O3 &
                + 0.25_r8 * k_o3_c3h6 * M_C3H6 * M_O3 &
                + k_no_c4h9o2 * M_C4H9O2 * M_NO * fa_no_c4h9o2 * fb_no_c4h9o2 &
@@ -2480,7 +2475,6 @@
              + k_oh_pan * M_OH * M_PAN &
              + k_oh_ch3o2h_b * M_OH * M_CH3O2H &
              + k_ch3o2_ch3xx * M_CH3O2 * M_CH3XX &
-             + 0.85_r8 * k_oh_ch3oh * M_CH3OH * M_OH &
              + POLLX(13)
         if (.not. LOLD_H2OTREATMENT) PROD = PROD &
              + k_od_ch4_c * M_O1D * M_CH4 !O(1D) + CH4 -> H2 + CH2O
@@ -2516,12 +2510,6 @@
         call QSSA(27,'HCHO',DTCH,QLIN,ST,PROD,LOSS,ZC(13,L))
 
 
-        !//..CH3OH-----------------------------------------------------------
-        PROD = POLLX(52)
-        LOSS = k_oh_ch3oh * M_OH
-        call QSSA(27,'CH3OH',DTCH,QLIN,ST,PROD,LOSS,ZC(52,L))
-
-
         !//..CH3CHO----------------------------------------------------------
         PROD = &
              ( k_no_ch3xx * M_NO &
Index: OSLO/stratchem_oslo.f90
===================================================================
--- OSLO/stratchem_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/stratchem_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -22,8 +22,6 @@
   !// ----------------------------------------------------------------------
   implicit none
   !// ----------------------------------------------------------------------
-  character(len=*), parameter, private :: f90file = 'stratchem_oslo.f90'
-  !// ----------------------------------------------------------------------
 
 contains
 
@@ -524,8 +522,6 @@
     !// 3. Put into STT_2d_* arrays
     !// 4. Scale and re-make sums if necessary
     !// ------------------------------------------------------------------
-    character(len=*), parameter :: subr = 'read_oslo2d2'
-    !// --------------------------------------------------------------------
 
     !// Only do this every month
     if (.not. LNEW_MONTH) return
@@ -534,7 +530,7 @@
     write(YEAR,'(I4)') MYEAR
     write(MON,'(I2.2)') JMON
 
-    write(6,'(a)') f90file//':'//subr//': Updating boundary conditions'
+    write(6,'(a)') '* Updating boundary conditions'
 
     !// Find file number to use
     ifnr = get_free_fileid()
@@ -579,8 +575,7 @@
     filename='Indata_CTM3/2d_data/sr'//YEAR
     open(ifnr,FILE=filename,form='formatted',STATUS='OLD',iostat=ierr)
     if (ierr.ne.0) then
-       write(6,'(a)') f90file//':'//subr// &
-            ': No 2D file: '//trim(filename)
+       print*,'*** No 2D file in stratchem_oslo.f90:'//trim(filename)
        stop
     end if
     write(6,'(a)') '  Reading '//trim(filename)
@@ -733,12 +728,8 @@
     else if(LPARW.eq.60) then
       !// Use next to uppermost level (i.e. 25)
       LEV2D = L2D - 1
-    else if (LPARW.eq.30) then
-      !// NorESM L30
-      LEV2D = 16
     else
-      write(6,'(a,i5)') f90file//':'//subr// &
-           ': Wrong resolution: ',LPARW
+      print*,'Wrong resolution in oc_read_oslo2d2',LPARW
       stop
     end if
 
Index: OSLO/chem_oslo.f90
===================================================================
--- OSLO/chem_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/chem_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -155,7 +155,7 @@
     real(r8), dimension(nchemdiag,TRACER_ID_MAX,LPAR) :: CHEMPROD
     real(r8), dimension(LPAR) :: DTCHEMLOSS
     real(r8), dimension(TRACER_ID_MAX) :: drydepDIAG
-    logical,parameter       :: LM7=.false.
+    logical,  parameter       :: LM7=.false.
     real(r8), dimension(LPAR) :: CIWC, CLWC, CFR !// cloud parameters
     real(r8), dimension(LPAR) :: COUNTnegO3
 
@@ -266,15 +266,15 @@
 
          !// Treat emissions/deposition as production/loss terms in chemistry?
          if (LEMISDEP_INCHEM) then
-           !// Get emissions (incl. all emis.; surface, lightning, etc.)
-           !// Routine sets EMISX, conversion from kg/s to molec/cm3/s
-           !// is carried out.
-           call getEMISX(BEMIS(:,:,II,JJ),DV,I,J,II,JJ,1,LMTP, &
-                LPAR, MP, NPAR, TRACER_ID_MAX, IDMTC, TMASS, EMISX)
-           !// Get dry deposition from VDEP, convert from m/s to 1/s
-           call getVDEP_oslo(I,J,VDEP_OC,VDEP,DV(1)/AREAXY(I,J), &
-                TRACER_ID_MAX,IDMTC,IPAR,JPAR,NPAR)
-        end if
+            !// Get emissions (incl. all emis.; surface, lightning, etc.)
+            !// Routine sets EMISX, conversion from kg/s to molec/cm3/s
+            !// is carried out.
+            call getEMISX(BEMIS(:,:,II,JJ),DV,I,J,II,JJ,1,LMTP, &
+                 LPAR, MP, NPAR, TRACER_ID_MAX, IDMTC, TMASS, EMISX)
+            !// Get dry deposition from VDEP, convert from m/s to 1/s
+            call getVDEP_oslo(I,J,VDEP_OC,VDEP,DV(1)/AREAXY(I,J), &
+                 TRACER_ID_MAX,IDMTC,IPAR,JPAR,NPAR)
+         end if
 
         !// Set local arrays (ZC_LOCAL); given in [kg/gridbox]
         call gotoZC_IJ(ZC_LOCAL,BTT,XSTT,I,J,II,JJ,1,LMTP, &
Index: OSLO/cmn_oslo.f90
===================================================================
--- OSLO/cmn_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/cmn_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -243,7 +243,7 @@
   !// Forest fires - only some layers
   integer :: FF_TYPE, FF_YEAR, NEFIR ! Type, year, # of components emitted
   character(len=120) :: FF_PATH
-  integer, parameter :: EPAR_FIR = 24    !// Number of components
+  integer, parameter :: EPAR_FIR = 23    !// Number of components
   integer, parameter :: EPAR_FIR_LM = 33 !// Number of layers
   integer,dimension(EPAR_FIR) :: ECOMP_FIR
   !// Emission array used in model
@@ -307,7 +307,12 @@
   real(r8), dimension(NPAR,IDBLK,JDBLK,MPBLK) :: &
        SCAV_MAP_WLS, SCAV_MAP_WCN, SCAV_MAP_DRY
 
-
+  !//--- Diagnose stomatal ozone uptake ------------------------------------
+  !// Stomatal conductance: daily average
+  real(r8), dimension(IPAR,JPAR) :: GSTO3_AVG
+  !// Stomatal flux: daily average
+  real(r8), dimension(IPAR,JPAR) :: FSTO3_AVG
+  
   !// --- Help variables ---------------------------------------------------
   !// Days of month
   integer, dimension(12) :: DINM
Index: OSLO/pchemc_str_ij.f90
===================================================================
--- OSLO/pchemc_str_ij.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/pchemc_str_ij.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -251,7 +251,6 @@
          J_HCl,     J_H2O,     J_BrCl, &
          !// Components (extracted from ZC_LOCAL array)
          M_O3,        M_HNO3,     M_CO,      M_CH2O,      M_H2O2, &
-         M_CH3OH, &
          M_CH3O2H,    M_HO2NO2,   M_HO2,     M_CH3O2,     M_O3P, &
          M_O1D,       M_OH,       M_NO3,     M_N2O5,      M_NO, &
          M_NO2,       M_CH4,      M_MCF,     M_HCFC22,    M_CFC11, &
@@ -555,7 +554,6 @@
         M_NO      = ZC_LOCAL(43,L)
         M_NO2     = ZC_LOCAL(44,L)
         M_CH4     = ZC_LOCAL(46,L)
-        M_CH3OH   = ZC_LOCAL(52,L)
         M_MCF     = ZC_LOCAL(101,L)
         M_HCFC22  = ZC_LOCAL(102,L)
         M_CFC11   = ZC_LOCAL(103,L)
@@ -1296,7 +1294,6 @@
                    + k_ho2_cl_a * M_HO2        &! Cl + HO2  -> HCl + O2
                    + k_cl_h2 * M_H2         &! Cl + H2   -> HCl + H
                    + k_cl_h2o2 * M_H2O2       &! Cl + H2O2 -> HCl + HO2
-                   + k_cl_ch3oh * M_CH3OH     &! Cl + CH3OH -> HCl + CH2OH
                    + k_cl_ch2o * M_CH2O )     &! Cl + H2CO -> HCl + HCO
                    * M_Cl                    &! Cl to HCl TRANSFORMATION
                  + k_oh_clo_b * M_OH * M_ClO  &! OH + ClO  -> HCl + O2
@@ -1592,9 +1589,7 @@
                + J_CH3O2H * M_CH3O2H          &! CH3O2H + hv -> CH2O + OH + H (->HO2)
                + ( k_od_ch4_b  &! O(1D) + CH4 -> (CH3O/CH2OH + H)  -O2-> CH2O + HO2 + H
                  + k_od_ch4_c ) * M_O1D * M_CH4 &! O(1D) + CH4 -> H2 + CH2O
-               + k_oh_ch3o2h_b * M_CH3O2H * M_OH &! OH + CH3OOH -> CH2O + OH + H2O (30%)
-               + k_oh_ch3oh * M_CH3OH * M_OH &! OH + CH3OH -> CH3O/CH2OH + H2O -> CH2O + HO2
-               + k_cl_ch3oh * M_CH3OH * M_Cl  ! Cl + CH3OH -> HCl + CH2OH -O2-> CH2O + HO2
+               + k_oh_ch3o2h_b * M_CH3O2H * M_OH ! OH + CH3OOH -> CH2O + OH + H2O (30%)
 
         LOSS = J_CH2O_a               &! CH2O + hv   -> H + CHO
                + J_CH2O_b             &! CH2O + hv   -> H2 + CO
@@ -1622,14 +1617,6 @@
 
         call QSSA(233,'strat',DTS,EULER,STEADYST,PROD,LOSS,M_CH2O)
 
-        !// Integrate CH3OH
-        PROD = EMISX(52,L)
-        LOSS = k_oh_ch3oh * M_OH &! OH + CH3OH -> CH3O/CH2OH + H2O -> CH2O + HO2
-             + k_cl_ch3oh * M_Cl  ! Cl + CH3OH -> HCl + CH2OH -O2-> CH2O + HO2
-
-        call QSSA(301,'strat',DTS,EULER,STEADYST,PROD,LOSS,M_CH3OH)
-
-
         !// HYDROGEN
         !// Integrate the sum of H, OH and HO2:
         HOX = M_H + M_OH + M_HO2
@@ -1761,7 +1748,6 @@
 
         LOSS = k_oh_ch4 * M_CH4            &! OH + CH4  -> CH3 + H2O
                + k_oh_ch2o * M_CH2O         &! OH + CH2O -> H2O + HCO
-               + k_oh_ch3oh * M_CH3OH       &! OH + CH3OH -> CH3O/CH2OH + H2O -> CH2O + HO2
                + k_oh_hno3 * M_HNO3         &! OH + HNO3 -> H2O + NO3
                !//HNO2: + k_oh_hno2 * M_HNO2
                + k_oh_h2o2 * M_H2O2         &! OH + H2O2 -> H2O + HO2
@@ -1811,8 +1797,6 @@
                + J_CH3O2H * M_CH3O2H       &! CH3O2H + hv -> CH2O + OH + H (->HO2)
                + J_CH2O_a * M_CH2O         &! CH2O + hv   -> H + CHO
                + k_oh_h2o2 * M_OH * M_H2O2  &! OH + H2O2   -> H2O +HO2
-               + k_oh_ch3oh * M_CH3OH * M_OH &! OH + CH3OH -> CH3O/CH2OH + H2O -> CH2O + HO2
-               + k_cl_ch3oh * M_CH3OH * M_Cl &! Cl + CH3OH -> HCl + CH2OH -O2-> CH2O + HO2
                + k_o2_h_m * M_O2 * M_H     &! O2 + H    -M-> HO2
                + k_o3_oh * M_O3 * HOY      &! O3 + OH     -> HO2 + O2
                + ( J_HO2NO2_b              &! HO2NO2 + hv   -> HO2 + NO2
@@ -1913,8 +1897,7 @@
                   + k_oh_ch3br * M_OH * M_CH3Br   &! OH + CH3Br   -> CH2Br + H2O
                   + LC_spsECPARBK * M_HOCl       &! HOCl + HCl(sad) -> Cl2 + H2O
                   + LC_spsGCPARBK * M_HOBr       &! HOBr + HCl(sad) -> BrCl + H2O
-                  + k_h_ho2_b * M_H * M_HO2      &! H + HO2      -> O + H2O
-                  + k_oh_ch3oh * M_CH3OH * M_OH ! OH + CH3OH -> CH3O/CH2OH + H2O
+                  + k_h_ho2_b * M_H * M_HO2       ! H + HO2      -> O + H2O
 
            LOSS = k_od_h2o * M_O1D             &! O(1D) + H2O  -> OH + OH
                   + J_H2O                     &! H2O + hv     -> H + OH
Index: OSLO/diagnostics_scavenging.f90
===================================================================
--- OSLO/diagnostics_scavenging.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/diagnostics_scavenging.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -22,13 +22,20 @@
   !//   subroutine scav_diag_collect_daily
   !//   subroutine scav_diag_2fileA
   !//   subroutine scav_diag_2fileB
+  !//   subroutine scav_diag_put_gsto
+  !//   subroutine scav_diag_put_fsto
+  !//   subroutine scav_diag_nmet_output_nc
   !//
+  !// Stefanie Falk, July 2018
+  !//   Added output and computation of daily stomatal conductance and flux.
+  !//   Added output of stomatal conductance and flux each timestep (NMETxNOPS).
   !// Ole Amund Sovde, April 2015
   !// ----------------------------------------------------------------------
   use cmn_precision, only: r8
   use cmn_size, only: IPAR, JPAR, LPAR, NPAR, MPBLK, IDBLK, JDBLK
   use cmn_oslo, only: SCAV_LS, SCAV_CN, SCAV_DD, SCAV_BRD, SCAV_DIAG, &
-       SCAV_MAP_WLS, SCAV_MAP_WCN, SCAV_MAP_DRY
+       SCAV_MAP_WLS, SCAV_MAP_WCN, SCAV_MAP_DRY, GSTO3_AVG, FSTO3_AVG
+  use cmn_sfc, only: VGSTO3
   !// ----------------------------------------------------------------------
   implicit none
   !// ----------------------------------------------------------------------
@@ -38,7 +45,8 @@
   private
   public scav_diag_init, scav_diag_put_ddep, scav_diag_brd, scav_diag_ls, &
        scav_diag_cn, scav_diag_collect_daily, &
-       scav_diag_2fileA, scav_diag_2fileB
+       scav_diag_2fileA, scav_diag_2fileB, &
+       scav_diag_put_gsto, scav_diag_put_fsto, scav_diag_nmet_output_nc
   !// ----------------------------------------------------------------------
 
 contains
@@ -65,7 +73,9 @@
     SCAV_MAP_WLS(:,:,:,:) = 0._r8
     SCAV_MAP_WCN(:,:,:,:) = 0._r8
     SCAV_MAP_DRY(:,:,:,:) = 0._r8
-
+    !// Stomatal uptake
+    GSTO3_AVG(:,:) = 0._r8
+    FSTO3_AVG(:,:) = 0._r8
     !// --------------------------------------------------------------------
   end subroutine scav_diag_init
   !// ----------------------------------------------------------------------
@@ -326,6 +336,11 @@
        TD = KDAY
     end if
 
+    !// Daily average of stomatal conductance -> devide by (NROPSM*NRMETD)
+    GSTO3_AVG = GSTO3_AVG / (NROPSM*NRMETD)
+    !// Daily average of stomatal flux -> devide by (NROPSM*NRMETD)
+    FSTO3_AVG = FSTO3_AVG / (NROPSM*NRMETD)
+
     !// Previous day
     if (KDAY .eq. 1) then
        !// End of last year
@@ -374,8 +389,397 @@
   end subroutine scav_diag_collect_daily
   !// ----------------------------------------------------------------------
 
+  !// ----------------------------------------------------------------------
+  subroutine scav_diag_put_gsto(NMET,VGSTO3)
+    !// --------------------------------------------------------------------
+    !// Compute the daily average stomatal uptake from VGstO3.
+    !//
+    !// VGstO3 is in units of mmol m-2s-1.
+    !//
+    !// Stefanie Falk, July 2018
+    !// --------------------------------------------------------------------
+    
+    !// --------------------------------------------------------------------
+    implicit none
+    !// --------------------------------------------------------------------
+    !// Input
+    real(r8), dimension(IPAR,JPAR), intent(in) :: VGSTO3
+    integer,intent(in) :: NMET
+    
+    !// --------------------------------------------------------------------
+    !// Collect totals
+    !// average will be calculated in scav_diag_collect_daily
+    GSTO3_AVG = GSTO3_AVG + VGSTO3
+    !// --------------------------------------------------------------------
+  end subroutine scav_diag_put_gsto
+  !// ----------------------------------------------------------------------
 
+!// ----------------------------------------------------------------------
+  subroutine scav_diag_put_fsto(BTT,NMET,VGSTO3,MP)
+    !// --------------------------------------------------------------------
+    !// Compute the daily average stomatal uptake from FGstO3.
+    !//
+    !// FGstO3 is in units of mmol m-2s-1, but it will be changed 
+    !// to nmol m-2s-1 when written to output file.
+    !//
+    !// Stefanie Falk, July 2018
+    !// --------------------------------------------------------------------
+    !use cmn_size, only: IDBLK, JDBLK, NPAR, LPAR
+    use cmn_ctm, only: MPBLKIB, MPBLKIE, MPBLKJB, MPBLKJE
+    use cmn_oslo, only: AIRMOLEC_IJ, DV_IJ
+    use cmn_chem, only: TMASS
+    use cmn_parameters, only: AVOGNR
+    !// --------------------------------------------------------------------
+    implicit none
+    !// --------------------------------------------------------------------
+    !// Input
+    real(r8), dimension(IPAR,JPAR), intent(in) :: VGSTO3
+    integer,  intent(in) :: NMET, MP
+    real(r8), intent(in)  :: BTT(LPAR,NPAR,IDBLK,JDBLK)
+    !// For looping
+    integer :: I, J, II, JJ
+    real(r8) :: RDUM, VMR_O3
+    !// Local
+    real(r8), dimension(IPAR,JPAR) :: fsto3_tmp
+    !// --------------------------------------------------------------------
+    
+    !// Initialize fsto3_tmp
+    fsto3_tmp(:,:) = 0._r8 
+    !// Loop over latitude (J is global, JJ is block)
+    do J = MPBLKJB(MP), MPBLKJE(MP)
+       JJ    = J - MPBLKJB(MP) + 1
+
+       !// Loop over longitude (I is global, II is block)
+       do I = MPBLKIB(MP), MPBLKIE(MP)
+          II    = I - MPBLKIB(MP) + 1
+          !// DV_IJ and AIRMOLEC_IJ are zero during the first call(?)
+          !// Prevent NAN-spread
+          if ( DV_IJ(1,II,JJ,MP) .eq. 0._r8 .or. AIRMOLEC_IJ(1,II,JJ,MP).eq. 0._r8 ) then
+             fsto3_tmp(I,J) = 0._r8
+          else
+             !// Convert O3 [kg/gridbox] to [molec/cm3]
+             RDUM =  1.e-3_r8 * AVOGNR / TMASS(1) / DV_IJ(1,II,JJ,MP)
+             !// Compute stomatal flux by multiplying conductance with 
+             !// VMR_O3 at ground level
+             VMR_O3 = (BTT(1,1,II,JJ)*RDUM)/AIRMOLEC_IJ(1,II,JJ,MP)
+             !// fsto3_tmp(I,J) units [mmol m-2 s-1]
+             fsto3_tmp(I,J) = VGSTO3(I,J)*VMR_O3
+          end if
+       end do !// do I = MPBLKIB(MP), MPBLKIE(MP)
+    end do !// do J = MPBLKJB(MP), MPBLKJE(MP)
+    !// --------------------------------------------------------------------
+    !// Collect totals
+    !// average will be calculated in scav_diag_collect_daily
+    FSTO3_AVG = FSTO3_AVG + fsto3_tmp
+   
+    !// --------------------------------------------------------------------
+  end subroutine scav_diag_put_fsto
   !// ----------------------------------------------------------------------
+  
+  !// ----------------------------------------------------------------------
+  subroutine scav_diag_nmet_output_nc(JYEAR,JMONTH,JDATE,NDAY,NMET,NOPS)
+    !// --------------------------------------------------------------------
+    !// Called from pmain before the calendar update.
+    !//
+    !// Write values of FSTO3 and GSTO3 at each NMET x NOPS
+    !// to netcdf file.
+    !//
+    !// FSTO3_AVG and GSTO3_AVG are accumulated. 
+    !// Both will be to deaccumulate before they are written to file.
+    !// FSTO3_AVG and GSTO3_AVG are in units of mmol m-2 s-1.
+    !//
+    !// Stefanie Falk, July 2018
+    !// --------------------------------------------------------------------
+    use netcdf
+    use cmn_diag, only: nc4deflate_global, nc4shuffle_global
+    use cmn_ctm, only: XDGRD, YDGRD, ZGRD, NRMETD
+    use cmn_met, only: MYEAR
+    use cmn_sfc, only: LDEPEMEP2012
+    use ncutils, only: handle_error
+    !// --------------------------------------------------------------------
+    implicit none
+    !// --------------------------------------------------------------------
+    !// Input
+    integer, intent(in) :: JYEAR, JMONTH, JDATE, NDAY, NMET, NOPS
+    !// Locals
+    character(len=80) :: filename
+    character(len=3)  :: cday          !Name of start day in character
+    character(len=2)  :: cmonth        !Name of start month in character
+    character(len=4)  :: cyear         !Name of start year in character
+    !// Dimensions ID and counters
+    integer :: lat_dim_id              !Dimension ID for latitude
+    integer :: lon_dim_id              !Dimension ID for longitude
+    integer :: time_dim_id             !Dimension ID for time
+    integer :: lat_id                  !Variable ID for latitude
+    integer :: lon_id                  !Variable ID for longitude
+    integer :: time_id                 !Variable ID for time
+    integer :: dim_lon_lat_time(3)     !Dimension ID for processes
+    integer :: srt_lon_lat_time(3)     !Start array for lon/lat/time
+    integer :: cnt_lon_lat_time(3)     !Counting array for lon/lat/time
+    integer :: srt_time(1)             !starting point for time array
+    integer :: gsto3_inst_id           !Variable ID for stomatal conductance
+    integer :: fsto3_inst_id           !Variable ID for stomatal flux
+  
+    !// Other locals
+    integer :: ncid                    !File ID for nc file
+    integer :: status                  !Error status for nc file
+    integer :: nlons                   !Number of longitudes found in file
+    integer :: nlats                   !Number of latitudes found in file
+    integer :: nsteps                  !Number of steps found in file 
+    character(len=80) :: time_label    !Label for variable "time"
+    real(r8)  :: time                  !Time in this timestep
+    integer :: nbr_steps               !Step number
+
+    real(r8), save, dimension(IPAR,JPAR) :: GSTO3_priv=0._r8, FSTO3_priv=0._r8
+    real(r8), dimension(IPAR,JPAR,1) :: GSTO3_inst, FSTO3_inst
+    
+    !// --------------------------------------------------------------------
+    integer, parameter :: nc4deflate = nc4deflate_global
+    integer, parameter :: nc4shuffle = nc4shuffle_global
+    !// --------------------------------------------------------------------
+    character(len=*), parameter :: subr = 'scav_diag_nmet_output_nc'
+    !//---------------------------------------------------------------------
+    !// No need to initialize if new dry deposition scheme is not used
+    if (.not.LDEPEMEP2012) return
+    
+    !// Time step
+    nbr_steps = NOPS + (NMET-1)* 24 / NRMETD !3
+    
+    !// Initialize and reset GSTO3_priv and FSTO_priv every first timestep
+    if ((nbr_steps.eq.1)) then
+       GSTO3_priv=0._r8
+       FSTO3_priv=0._r8
+
+    end if
+
+    !//---------------------------------------------------------------------
+    !// Deaccumulate GSTO3_AVG and FSTO_AVG
+    write(6,'(a)') f90file//':'//subr// ': Deaccumulating stomatal fields'
+  
+    GSTO3_inst(:,:,1) = GSTO3_AVG-GSTO3_priv
+    FSTO3_inst(:,:,1) = FSTO3_AVG-FSTO3_priv
+    !// Save previous step
+    GSTO3_priv = GSTO3_AVG
+    FSTO3_priv = FSTO3_AVG
+
+    !// Output
+    !// [mmol m-2 s-1] -> [nmol m-2 s-1]
+    FSTO3_inst = FSTO3_inst*1.e6_r8
+   
+    !//---------------------------------------------------------------------
+
+    !// Filename
+    write(cday(1:3),'(i3.3)') NDAY
+    write(cyear(1:4),'(i4.4)') MYEAR
+    filename = 'scavenging_daily_stomata_'//cyear//'_'//cday//'.nc'
+    
+    if (nbr_steps .eq. 1) then
+       !First time this is done. Need to define variables
+       write(6,'(a71)') '--------------------------------------------'// &
+            '---------------------------'
+       write(6,'(a)') f90file//':'//subr// &
+            ' Will write data to netCDF every 1 hour'
+       !// Create file
+       write(6,*)'creating file: ',filename,status
+       !// Use nf90_netcdf4 to create netcdf4:
+       status=nf90_create(path=filename,cmode=nf90_netcdf4,ncid=ncid)
+       if (status/=nf90_noerr) call handle_error(status,'in creating file')
+
+       !//File headers
+       status=nf90_put_att(ncid,nf90_global,'title','1h output of stomata conductance/flux from Oslo CTM3')
+       if (status/=nf90_noerr) call handle_error(status,f90file//':'//subr//': file header')
+       status=nf90_put_att(ncid,nf90_global,'Modelinfo1','Oslo CTM3 is a 3D Chemical Transport Model')
+       if (status/=nf90_noerr) call handle_error(status,f90file//':'//subr//': modelifo1')
+       status=nf90_put_att(ncid,nf90_global,'Modelinfo2','Oslo CTM3 is driven by ECMWF meteorological data')
+       if (status/=nf90_noerr) call handle_error(status,f90file//':'//subr//': modelinfo2')
+       status=nf90_put_att(ncid,nf90_global,'contactinfo','For errors, contact CICERO')
+       if (status/=nf90_noerr) call handle_error(status,f90file//':'//subr//': contactinfo')
+
+       !// Define sizes
+       !// Define dimensions (JM, IM, time)
+       status = nf90_def_dim(ncid,"lat",JPAR,lat_dim_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define lat dim')
+       status = nf90_def_dim(ncid,"lon",IPAR,lon_dim_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define lon dim')
+       !// Defining dimension time of length unlimited
+       status = nf90_def_dim(ncid,"time",nf90_unlimited,time_dim_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define time dim')
+
+       !// Defining the combined id for a field (lon /lat /time)
+       dim_lon_lat_time(1)=lon_dim_id
+       dim_lon_lat_time(2)=lat_dim_id
+       dim_lon_lat_time(3)=time_dim_id
+
+       !// Defining the lon/lat/time-variable
+       status = nf90_def_var(ncid,"lon",nf90_float,lon_dim_id,lon_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define lon variable')
+       status = nf90_def_var(ncid,"lat",nf90_float,lat_dim_id,lat_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define lat variable')
+       status = nf90_def_var(ncid,"time",nf90_float,time_dim_id,time_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define time variable')
+
+       !// Putting attributes to /lon/lat variables
+       status = nf90_put_att(ncid,lon_id,'units','degree_east')
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute units lon')
+       status = nf90_put_att(ncid,lat_id,'units','degree_north')
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute units lat')
+      
+       !// Putting attributes to time variable
+       time_label='hours since yyyy-mm-dd 00:00:00'
+       write(time_label(13:23),'(i4.4,a1,i2.2,a1,i2.2)') &
+            MYEAR,'-',JMONTH,'-',JDATE
+       status = nf90_put_att(ncid,time_id,'units',time_label)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute units time')
+
+       !// Daily average of stomatal conductance
+       status = nf90_def_var(ncid,'GstO3_inst', &
+            nf90_double, dim_lon_lat_time, gsto3_inst_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define variable GstO3_inst ')
+       status = nf90_def_var_deflate(ncid, gsto3_inst_id, &
+            nc4shuffle, 1, nc4deflate)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define deflate variable GstO3_inst ')
+       status = nf90_put_att(ncid, gsto3_inst_id,'unit','mmol m-2 s-1')
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute unit GstO3_inst ')
+
+       !// Daily average of stomatal flux
+       status = nf90_def_var(ncid,'FstO3_inst', &
+            nf90_double, dim_lon_lat_time, fsto3_inst_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define variable FstO3_inst ')
+       status = nf90_def_var_deflate(ncid, fsto3_inst_id, &
+            nc4shuffle, 1, nc4deflate)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define deflate variable FstO3_inst ')
+       status = nf90_put_att(ncid, fsto3_inst_id,'unit','nmol m-2 s-1')
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute unit FstO3_inst ')
+
+       !//---------------------------------------------------------------------
+       !// End definition mode
+       status = nf90_enddef(ncid)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': end defmode')
+       !//---------------------------------------------------------------------
+       !// Putting the lon/lat variables
+       status = nf90_put_var(ncid,lon_id,XDGRD)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting lon')
+       status = nf90_put_var(ncid,lat_id,YDGRD)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting lat')
+       
+    else                                      !// THE FILE HAS BEEN USED BEFORE
+       !// Open the existing file
+       status = nf90_open(filename, nf90_write, ncid)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': open existing file')
+
+       !// Inquire dimension ids
+       status = nf90_inq_dimid(ncid,"lat",lat_dim_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': getting lat')
+       status = nf90_inq_dimid(ncid,"lon",lon_dim_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': getting lon')
+       status = nf90_inq_dimid(ncid,"time",time_dim_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': getting time')
+
+       !// Inquire dimensions
+       status = nf90_Inquire_Dimension(ncid,lat_dim_id,len=nlats)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': inq lat dim')
+       if (nlats/=JPAR) then
+          write(6,*) f90file//':'//subr//': reports JM = ',nlats, JPAR
+          stop
+       end if
+       status = nf90_Inquire_Dimension(ncid,lon_dim_id,len=nlons)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': inq lon dim')
+       if (nlons/=IPAR) then
+          write(6,*) f90file//':'//subr//': reports IM = ',nlons,IPAR
+          stop
+       end if
+       status = nf90_Inquire_Dimension(ncid,time_dim_id,len=nsteps)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': inq time dim')
+       if (nsteps.lt.0) then
+          write(6,*) f90file//':'//subr//': reports already added nsteps = ',nsteps
+          stop
+       end if
+
+       !// Check variable id
+       status = nf90_inq_varid(ncid,'GstO3_inst',gsto3_inst_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': inq tracer varid')
+       status = nf90_inq_varid(ncid,'FstO3_inst',fsto3_inst_id)
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': inq tracer varid')
+
+       !// Get variable id for time
+       status = nf90_inq_varid(ncid,"time",time_id) 
+       if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': inq time varid')
+    end if
+    
+    !// PUT THE VARIABLES TO FILE
+    !// --------------------------------------------------------------------
+
+    !// For the tracer fields:
+    !// Defining how far to count for each time a data set is added
+    cnt_lon_lat_time = (/IPAR , JPAR , 1/)
+    !// Defining where to start adding the new time step
+    srt_lon_lat_time = (/1, 1, nbr_steps/)
+
+    !// Start value for new time step
+    srt_time(1) = nbr_steps
+    time = nbr_steps-1
+
+    status = nf90_put_var(ncid,time_id,time,start=srt_time)
+    if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting time')
+
+    !// Put variable tracer field
+    status = nf90_put_var(ncid, &               !File id
+         gsto3_inst_id, &                       !field_id for netCDF file (should match id set in def_var) 
+         gsto3_inst, &                          !Tracer field (REAL4)
+         start=srt_lon_lat_time, &              !starting point for writing
+         count=cnt_lon_lat_time )               !Counts how many bytes written
+    if (status/=nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting GstO3_inst data')
+    status = nf90_put_var(ncid, &               !File id
+         fsto3_inst_id, &                       !field_id for netCDF file (should match id set in def_var) 
+         fsto3_inst, &                          !Tracer field (REAL4)
+         start=srt_lon_lat_time, &              !starting point for writing
+         count=cnt_lon_lat_time )               !Counts how many bytes written
+    if (status/=nf90_noerr) call handle_error(status, &
+         f90file//':'//subr//': putting FstO3_inst data')
+
+    !// close netcdf file
+    status = nf90_close(ncid)
+    if (status/=nf90_noerr) call handle_error(status,'close file')
+
+    write(6,'(a71)') '--------------------------------------------'// &
+         '---------------------------'
+    
+
+    !// --------------------------------------------------------------------
+  end subroutine scav_diag_nmet_output_nc
+  !// ----------------------------------------------------------------------
+
+  !// ----------------------------------------------------------------------
   subroutine scav_diag_2fileA(YEAR,MONTH,DAY,NDAY)
     !// --------------------------------------------------------------------
     !// Called from pmain AFTER calendar update.
@@ -397,6 +801,7 @@
     use cmn_met, only: METTYPE, metCYCLE, metREVNR, MET_ROOT, MPATH1
     use cmn_diag, only: JDO_T, RUNTITLE, metTypeInfo, resolutionInfo, &
          nc4deflate_global, nc4shuffle_global
+    use cmn_ctm, only: LDLYSCAV
     use utilities, only: get_free_fileid
     use cmn_oslo, only: chem_idx, DINM
     use netcdf
@@ -417,24 +822,28 @@
     !//---------------------------------------------------------------------
     !// netCDF variables
     integer :: &
-         status, &          !Status for netcdf file 0=OK
-         ncid, &            !file id for output netcdf file
-         ncomps_dim_id, &   !Dimension id for NPAR
-         days_dim_id, &     !Dimension id for days
-         days_id, &     !Dimension id for days of year (1:366)
+         status, &                 !Status for netcdf file 0=OK
+         ncid, &                   !file id for output netcdf file
+         ncomps_dim_id, &          !Dimension id for NPAR
+         days_dim_id, &            !Dimension id for days
+         days_id, &                !Dimension id for days of year (1:366)
          tracer_name_len_dim_id, & !Dimension id for tname charater length
-         tracer_idx_id, &   !ID for all tracer number
+         tracer_idx_id, &          !ID for all tracer number
          dim_ncomps_days_id(2), &
-         version_id, &      !ID for file version number
-         tracer_molw_id, &  !ID for all tracer molecular weights
-         tracer_name_id, &  !ID for all tracer names
-         native_lon_id, &   !Variable id for native longitude size
-         native_lat_id, &   !Variable id for native latitude size
-         native_lev_id, &   !Variable id for native level size
-         lon_id, &          !Variable id for longitude
-         lat_id, &          !Variable id for latitude
-         lev_id, &          !Variable id for longitude interstices
-         scav_ls_id, scav_cnv_id, scav_dry_id, scav_brd_id
+         version_id, &             !ID for file version number
+         tracer_molw_id, &         !ID for all tracer molecular weights
+         tracer_name_id, &         !ID for all tracer names
+         native_lon_id, &          !Variable id for native longitude size
+         native_lat_id, &          !Variable id for native latitude size
+         native_lev_id, &          !Variable id for native level size
+         lon_id, &                 !Variable id for longitude
+         lat_id, &                 !Variable id for latitude
+         lev_id, &                 !Variable id for longitude interstices
+         scav_ls_id, &
+         scav_cnv_id, &
+         scav_dry_id, & 
+         scav_brd_id
+         
     character(len=TNAMELEN), dimension(NPAR) :: tracer_name
     real(r8), dimension(NPAR) :: tracer_molw
     integer, dimension(NPAR) :: tracer_idx
@@ -657,66 +1066,69 @@
 
     !// LS, CNV, DRY and BRD
     !// Totals wet scavenged, large scale (r8), deflate netcdf4
-    status = nf90_def_var(ncid,"SCAV_LS",nf90_double,dim_ncomps_days_id,scav_ls_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SCAV_LS variable')
-    status = nf90_def_var_deflate(ncid,scav_ls_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SCAV_LS variable')
-    status = nf90_put_att(ncid,scav_ls_id,'units','kg(tracer)')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units SCAV_LS')
-    status = nf90_put_att(ncid,scav_ls_id,'description', &
+    if (LDLYSCAV(4)) then
+       status = nf90_def_var(ncid,"SCAV_LS",nf90_double,dim_ncomps_days_id,scav_ls_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define SCAV_LS variable')
+       status = nf90_def_var_deflate(ncid,scav_ls_id,nc4shuffle,1,nc4deflate)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define deflate SCAV_LS variable')
+       status = nf90_put_att(ncid,scav_ls_id,'units','kg(tracer)')
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute units SCAV_LS')
+       status = nf90_put_att(ncid,scav_ls_id,'description', &
             'Daily total mass scavenged by large scale scavenging.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description SCAV_LS')
-
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute description SCAV_LS')
+    end if
     !// Totals wet scavenged, convective (r8), deflate netcdf4
-    status = nf90_def_var(ncid,"SCAV_CNV",nf90_double,dim_ncomps_days_id,scav_cnv_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SCAV_CNV variable')
-    status = nf90_def_var_deflate(ncid,scav_cnv_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SCAV_CNV variable')
-    status = nf90_put_att(ncid,scav_cnv_id,'units','kg(tracer)')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units SCAV_CNV')
-    status = nf90_put_att(ncid,scav_cnv_id,'description', &
+    if (LDLYSCAV(5)) then
+       status = nf90_def_var(ncid,"SCAV_CNV",nf90_double,dim_ncomps_days_id,scav_cnv_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define SCAV_CNV variable')
+       status = nf90_def_var_deflate(ncid,scav_cnv_id,nc4shuffle,1,nc4deflate)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define deflate SCAV_CNV variable')
+       status = nf90_put_att(ncid,scav_cnv_id,'units','kg(tracer)')
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute units SCAV_CNV')
+       status = nf90_put_att(ncid,scav_cnv_id,'description', &
             'Daily total mass scavenged by convectivescavenging.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description SCAV_CNV')
-
-    !// Totals wet scavenged, convective (r8), deflate netcdf4
-    status = nf90_def_var(ncid,"SCAV_DRY",nf90_double,dim_ncomps_days_id,scav_dry_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SCAV_DRY variable')
-    status = nf90_def_var_deflate(ncid,scav_dry_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SCAV_DRY variable')
-    status = nf90_put_att(ncid,scav_dry_id,'units','kg(tracer)')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units SCAV_DRY')
-    status = nf90_put_att(ncid,scav_dry_id,'description', &
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute description SCAV_CNV')
+    end if
+    if (LDLYSCAV(6)) then
+       !// Totals wet scavenged, convective (r8), deflate netcdf4
+       status = nf90_def_var(ncid,"SCAV_DRY",nf90_double,dim_ncomps_days_id,scav_dry_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define SCAV_DRY variable')
+       status = nf90_def_var_deflate(ncid,scav_dry_id,nc4shuffle,1,nc4deflate)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define deflate SCAV_DRY variable')
+       status = nf90_put_att(ncid,scav_dry_id,'units','kg(tracer)')
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute units SCAV_DRY')
+       status = nf90_put_att(ncid,scav_dry_id,'description', &
             'Daily total mass scavenged by dry deposition.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description SCAV_DRY')
-
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute description SCAV_DRY')
+    end if
     !// Average burdens (r8), deflate netcdf4
-    status = nf90_def_var(ncid,"SCAV_BRD",nf90_double,dim_ncomps_days_id,scav_brd_id)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define SCAV_BRD variable')
-    status = nf90_def_var_deflate(ncid,scav_brd_id,nc4shuffle,1,nc4deflate)
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': define deflate SCAV_BRD variable')
-    status = nf90_put_att(ncid,scav_brd_id,'units','kg(tracer)')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute units SCAV_BRD')
-    status = nf90_put_att(ncid,scav_brd_id,'description', &
+    if (LDLYSCAV(3)) then
+       status = nf90_def_var(ncid,"SCAV_BRD",nf90_double,dim_ncomps_days_id,scav_brd_id)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define SCAV_BRD variable')
+       status = nf90_def_var_deflate(ncid,scav_brd_id,nc4shuffle,1,nc4deflate)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': define deflate SCAV_BRD variable')
+       status = nf90_put_att(ncid,scav_brd_id,'units','kg(tracer)')
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute units SCAV_BRD')
+       status = nf90_put_att(ncid,scav_brd_id,'description', &
             'Daily average total mass (burden) of tracer.')
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': attribute description SCAV_BRD')
-
-
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': attribute description SCAV_BRD')
+    end if
     !//---------------------------------------------------------------------
     !// End definition mode
     status = nf90_enddef(ncid)
@@ -775,25 +1187,30 @@
          f90file//':'//subr//': putting tracer_name')
 
     !// Scavenged LS
-    status = nf90_put_var(ncid,scav_ls_id,SCAV_OUT(:,1,:))
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SCAV_LS')
-
+    if (LDLYSCAV(4)) then
+       status = nf90_put_var(ncid,scav_ls_id,SCAV_OUT(:,1,:))
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting SCAV_LS')
+    end if
     !// Scavenged CNV
-    status = nf90_put_var(ncid,scav_cnv_id,SCAV_OUT(:,2,:))
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SCAV_CNV')
-
+    if (LDLYSCAV(5)) then
+       status = nf90_put_var(ncid,scav_cnv_id,SCAV_OUT(:,2,:))
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting SCAV_CNV')
+    end if
     !// Scavenged DRY
-    status = nf90_put_var(ncid,scav_dry_id,SCAV_OUT(:,3,:))
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SCAV_DRY')
-
+    if (LDLYSCAV(6)) then
+       status = nf90_put_var(ncid,scav_dry_id,SCAV_OUT(:,3,:))
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting SCAV_DRY')
+    end if
     !// Burden average BRD
-    status = nf90_put_var(ncid,scav_brd_id,SCAV_OUT(:,4,:))
-    if (status .ne. nf90_noerr) call handle_error(status, &
-         f90file//':'//subr//': putting SCAV_BRD')
-
+    if (LDLYSCAV(3)) then
+       status = nf90_put_var(ncid,scav_brd_id,SCAV_OUT(:,4,:))
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting SCAV_BRD')
+    end if
+    
     !//---------------------------------------------------------------------
     !// close netcdf file
     status = nf90_close(ncid)
@@ -818,8 +1235,8 @@
     SCAV_CN(:,:) = 0._r8
     SCAV_DD(:,:) = 0._r8
     SCAV_BRD(:,:) = 0._r8
+    
 
-
     !// I think it is correct that SCAV_DIAG is only initialised
     !// at model start, and not at the beginning of each year.
 
@@ -841,13 +1258,14 @@
     !// --------------------------------------------------------------------
     use cmn_size, only: IPARW, JPARW, LPARW, TNAMELEN
     use cmn_ctm, only: NROPSM, NRMETD, MPBLKIB, MPBLKIE, MPBLKJB, MPBLKJE, &
-         XDGRD, YDGRD, XDEDG, YDEDG, AREAXY
+         XDGRD, YDGRD, XDEDG, YDEDG, AREAXY, LDLYSCAV
     use cmn_chem, only: TNAME, TMASS
     use cmn_met, only: METTYPE, metCYCLE, metREVNR, MET_ROOT, MPATH1
     use cmn_diag, only: RUNTITLE, metTypeInfo, resolutionInfo, &
          nc4deflate_global, nc4shuffle_global
     use utilities, only: get_free_fileid
     use cmn_oslo, only: chem_idx
+    use cmn_sfc, only: LDEPEMEP2012
     use netcdf
     use ncutils, only: handle_error
     !// --------------------------------------------------------------------
@@ -864,33 +1282,42 @@
     integer, parameter :: version = 3
     !//---------------------------------------------------------------------
     !// netCDF variables
-    integer :: &
-         status, &          !Status for netcdf file 0=OK
-         ncid, &            !file id for output netcdf file
-         lon_dim_id, &      !Dimension id for longitude
-         lon_id, &          !Variable id for longitude
-         lat_dim_id, &      !Dimension id for latitude
-         lat_id, &          !Variable id for latitude
-         ilon_dim_id, &      !Dimension id for longitude interstices
-         ilon_id, &          !Variable id for longitude interstices
-         ilat_dim_id, &      !Dimension id for latitude interstices
-         ilat_id, &          !Variable id for latitude interstices
-         ncomps_dim_id, &   !Dimension id for NPAR
-         tracer_name_len_dim_id, & !Dimension id for tname charater length
-         tracer_idx_id, &   !ID for all tracer number
-         dim_lon_lat_id(2), &
-         version_id, &      !ID for file version number
-         tracer_molw_id, &  !ID for all tracer molecular weights
-         tracer_name_id, &  !ID for all tracer names
-         native_lon_id, &   !Variable id for native longitude size
-         native_lat_id, &   !Variable id for native latitude size
-         native_lev_id, &   !Variable id for native level size
-         current_lon_id, &  !Variable id for simulation longitude size
-         current_lat_id, &  !Variable id for simulation latitude size
-         current_lev_id, &  !Variable id for simulation level size
-         areaxy_id, &       !Variable id for grid area
-         date_year_id, date_month_id, date_day_id, &
-         scav_ls_id(NPAR), scav_cnv_id(NPAR), scav_dry_id(NPAR)
+    !// Dimensions ID and counters
+    integer :: lon_dim_id             !Dimension ID for longitude
+    integer :: lat_dim_id             !Dimension ID for latitude
+    integer :: ilon_dim_id            !Dimension ID for longitude interstices
+    integer :: ilat_dim_id            !Dimension ID for latitude interstices
+    integer :: ncomps_dim_id          !Dimension ID for NPAR
+    integer :: tracer_name_len_dim_id !Dimension ID for tname charater length
+    integer :: lon_id                 !Variable ID for longitude
+    integer :: lat_id                 !Variable ID for latitude
+    integer :: ilon_id                !Variable ID for longitude interstices
+    integer :: ilat_id                !Variable ID for latitude interstices
+    integer :: tracer_idx_id          !ID for all tracer number
+    integer :: dim_lon_lat_id(2)
+    integer :: version_id             !ID for file version number
+    integer :: tracer_molw_id         !ID for all tracer molecular weights
+    integer :: tracer_name_id         !ID for all tracer names
+    integer :: native_lon_id          !Variable ID for native longitude size
+    integer :: native_lat_id          !Variable ID for native latitude size
+    integer :: native_lev_id          !Variable ID for native level size
+    integer :: current_lon_id         !Variable ID for simulation longitude size
+    integer :: current_lat_id         !Variable ID for simulation latitude size
+    integer :: current_lev_id         !Variable ID for simulation level size
+    integer :: areaxy_id              !Variable ID for grid area
+    integer :: date_year_id           !Variable ID for year
+    integer :: date_month_id          !Variable ID for month
+    integer :: date_day_id            !Variable ID for day
+    integer :: scav_ls_id(NPAR), &
+         scav_cnv_id(NPAR), &
+         scav_dry_id(NPAR)
+    integer :: gsto3_avg_id, &
+         fsto3_avg_id
+
+    !// Other locals
+    integer :: status                 !Status for netcdf file 0=OK
+    integer :: ncid                   !file id for output netcdf file
+
     character(len=TNAMELEN), dimension(NPAR) :: tracer_name
     real(r8), dimension(NPAR) :: tracer_molw
     integer, dimension(NPAR) :: tracer_idx
@@ -1153,51 +1580,83 @@
 
     !// Each component
     !// Name convention? ls_O3/cnv_O3/dry_O3?
-    do N = 1, NPAR
-       !// SCAV_LS
-       status = nf90_def_var(ncid,'ls_'//trim(TNAME(N)), &
-            nf90_double, dim_lon_lat_id, scav_ls_id(N))
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': define SCAV_LS variable '//trim(TNAME(N)))
-       status = nf90_def_var_deflate(ncid, scav_ls_id(N), &
-            nc4shuffle, 1, nc4deflate)
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': define deflate SCAV_LS variable '//trim(TNAME(N)))
-       status = nf90_put_att(ncid,scav_ls_id(N),'unit','kg(tracer)')
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': attribute unit SCAV_LS '//trim(TNAME(N)))
-    end do
+    !// SCAV_LS
+    if (LDLYSCAV(4)) then
+       do N = 1, NPAR
+          status = nf90_def_var(ncid,'ls_'//trim(TNAME(N)), &
+               nf90_double, dim_lon_lat_id, scav_ls_id(N))
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': define SCAV_LS variable '//trim(TNAME(N)))
+          status = nf90_def_var_deflate(ncid, scav_ls_id(N), &
+               nc4shuffle, 1, nc4deflate)
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': define deflate SCAV_LS variable '//trim(TNAME(N)))
+          status = nf90_put_att(ncid,scav_ls_id(N),'unit','kg(tracer)')
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': attribute unit SCAV_LS '//trim(TNAME(N)))
+       end do
+    end if
+    
+    !// SCAV_CNV
+    if (LDLYSCAV(5)) then
+       do N = 1, NPAR
+          status = nf90_def_var(ncid,'cnv_'//trim(tname(N)), &
+               nf90_double, dim_lon_lat_id, scav_cnv_id(N))
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': define SCAV_CNV variable '//trim(TNAME(N)))
+          status = nf90_def_var_deflate(ncid, scav_cnv_id(N), &
+               nc4shuffle, 1, nc4deflate)
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': define deflate SCAV_CNV variable '//trim(TNAME(N)))
+          status = nf90_put_att(ncid, scav_cnv_id(N), 'unit', 'kg(tracer)')
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': attribute unit SCAV_CNV '//trim(TNAME(N)))
+       end do
+    end if
 
-    do N = 1, NPAR
-       !// SCAV_CNV
-       status = nf90_def_var(ncid,'cnv_'//trim(tname(N)), &
-            nf90_double, dim_lon_lat_id, scav_cnv_id(N))
+    !// SCAV_DRY
+    if (LDLYSCAV(6)) then
+       do N = 1, NPAR
+          status = nf90_def_var(ncid,'dry_'//trim(tname(N)), &
+               nf90_double, dim_lon_lat_id, scav_dry_id(N))
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': define SCAV_DRY variable '//trim(TNAME(N)))
+          status = nf90_def_var_deflate(ncid, scav_dry_id(N), &
+               nc4shuffle, 1, nc4deflate)
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': define deflate SCAV_DRY variable '//trim(TNAME(N)))
+          status = nf90_put_att(ncid,scav_dry_id(N),'unit','kg(tracer)')
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': attribute unit SCAV_DRY '//trim(TNAME(N)))
+       end do
+    end if
+
+    !// Daily average of stomatal conductance
+    if(LDEPEMEP2012 .and. LDLYSCAV(7)) then
+       status = nf90_def_var(ncid,'GstO3_avg', &
+            nf90_double, dim_lon_lat_id, gsto3_avg_id)
        if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': define SCAV_CNV variable '//trim(TNAME(N)))
-       status = nf90_def_var_deflate(ncid, scav_cnv_id(N), &
+            f90file//':'//subr//': define variable GstO3_avg ')
+       status = nf90_def_var_deflate(ncid, gsto3_avg_id, &
             nc4shuffle, 1, nc4deflate)
        if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': define deflate SCAV_CNV variable '//trim(TNAME(N)))
-       status = nf90_put_att(ncid, scav_cnv_id(N), 'unit', 'kg(tracer)')
+            f90file//':'//subr//': define deflate variable GstO3_avg ')
+       status = nf90_put_att(ncid, gsto3_avg_id,'unit','mmol m-2 s-1')
        if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': attribute unit SCAV_CNV '//trim(TNAME(N)))
-    end do
-
-    do N = 1, NPAR
-       !// SCAV_DRY
-       status = nf90_def_var(ncid,'dry_'//trim(tname(N)), &
-            nf90_double, dim_lon_lat_id, scav_dry_id(N))
+            f90file//':'//subr//': attribute unit GstO3_avg ')
+       !// Daily average of stomatal flux
+       status = nf90_def_var(ncid,'FstO3_avg', &
+            nf90_double, dim_lon_lat_id, fsto3_avg_id)
        if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': define SCAV_DRY variable '//trim(TNAME(N)))
-       status = nf90_def_var_deflate(ncid, scav_dry_id(N), &
+            f90file//':'//subr//': define variable FstO3_avg ')
+       status = nf90_def_var_deflate(ncid, fsto3_avg_id, &
             nc4shuffle, 1, nc4deflate)
        if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': define deflate SCAV_DRY variable '//trim(TNAME(N)))
-       status = nf90_put_att(ncid,scav_dry_id(N),'unit','kg(tracer)')
+            f90file//':'//subr//': define deflate variable FstO3_avg ')
+       status = nf90_put_att(ncid, fsto3_avg_id,'unit','nmol m-2 s-1')
        if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': attribute unit SCAV_DRY '//trim(TNAME(N)))
-    end do
-
+            f90file//':'//subr//': attribute unit FstO3_avg ')
+    end if
     !//---------------------------------------------------------------------
     !// End definition mode
     status = nf90_enddef(ncid)
@@ -1279,62 +1738,78 @@
          f90file//':'//subr//': putting AREAXY')
 
     !// Scavenged LS: SCAV_MAP_WLS
-    do MP = 1, MPBLK
-      do J = MPBLKJB(MP), MPBLKJE(MP)
-        JJ    = J - MPBLKJB(MP) + 1
-        do I = MPBLKIB(MP), MPBLKIE(MP)
-          II    = I - MPBLKIB(MP) + 1
-          do N = 1, NPAR
-            RDUM(I,J,N) = SCAV_MAP_WLS(N,II,JJ,MP)
+    if (LDLYSCAV(4)) then
+       do MP = 1, MPBLK
+          do J = MPBLKJB(MP), MPBLKJE(MP)
+             JJ    = J - MPBLKJB(MP) + 1
+             do I = MPBLKIB(MP), MPBLKIE(MP)
+                II    = I - MPBLKIB(MP) + 1
+                do N = 1, NPAR
+                   RDUM(I,J,N) = SCAV_MAP_WLS(N,II,JJ,MP)
+                end do
+             end do
           end do
-        end do
-      end do
-    end do
+       end do
+       
+       do N = 1, NPAR
+          status = nf90_put_var(ncid,scav_ls_id(N),RDUM(:,:,N))
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': putting SCAV_MAP_LS')
+       end do
+    end if
 
-    do N = 1, NPAR
-       status = nf90_put_var(ncid,scav_ls_id(N),RDUM(:,:,N))
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': putting SCAV_MAP_LS')
-    end do
-
     !// Scavenged CNV: SCAV_MAP_WCN
-    do MP = 1, MPBLK
-      do J = MPBLKJB(MP), MPBLKJE(MP)
-        JJ    = J - MPBLKJB(MP) + 1
-        do I = MPBLKIB(MP), MPBLKIE(MP)
-          II    = I - MPBLKIB(MP) + 1
-          do N = 1, NPAR
-            RDUM(I,J,N) = SCAV_MAP_WCN(N,II,JJ,MP)
+    if (LDLYSCAV(5)) then
+       do MP = 1, MPBLK
+          do J = MPBLKJB(MP), MPBLKJE(MP)
+             JJ    = J - MPBLKJB(MP) + 1
+             do I = MPBLKIB(MP), MPBLKIE(MP)
+                II    = I - MPBLKIB(MP) + 1
+                do N = 1, NPAR
+                   RDUM(I,J,N) = SCAV_MAP_WCN(N,II,JJ,MP)
+                end do
+             end do
           end do
-        end do
-      end do
-    end do
-
-    do N = 1, NPAR
-       status = nf90_put_var(ncid,scav_cnv_id(N),RDUM(:,:,N))
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': putting SCAV_MAP_CNV')
-    end do
-
+       end do
+       
+       do N = 1, NPAR
+          status = nf90_put_var(ncid,scav_cnv_id(N),RDUM(:,:,N))
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': putting SCAV_MAP_CNV')
+       end do
+    end if
+    
     !// Scavenged DRY: SCAV_MAP_DRY
-    do MP = 1, MPBLK
-      do J = MPBLKJB(MP), MPBLKJE(MP)
-        JJ    = J - MPBLKJB(MP) + 1
-        do I = MPBLKIB(MP), MPBLKIE(MP)
-          II    = I - MPBLKIB(MP) + 1
-          do N = 1, NPAR
-            RDUM(I,J,N) = SCAV_MAP_DRY(N,II,JJ,MP)
+    if (LDLYSCAV(6)) then
+       do MP = 1, MPBLK
+          do J = MPBLKJB(MP), MPBLKJE(MP)
+             JJ    = J - MPBLKJB(MP) + 1
+             do I = MPBLKIB(MP), MPBLKIE(MP)
+                II    = I - MPBLKIB(MP) + 1
+                do N = 1, NPAR
+                   RDUM(I,J,N) = SCAV_MAP_DRY(N,II,JJ,MP)
+                end do
+             end do
           end do
-        end do
-      end do
-    end do
+       end do
+       
+       do N = 1, NPAR
+          status = nf90_put_var(ncid,scav_dry_id(N),RDUM(:,:,N))
+          if (status .ne. nf90_noerr) call handle_error(status, &
+               f90file//':'//subr//': putting SCAV_MAP_DRY')
+       end do
+    end if
 
-    do N = 1, NPAR
-       status = nf90_put_var(ncid,scav_dry_id(N),RDUM(:,:,N))
+    !// Stomatal conductance
+    if(LDEPEMEP2012 .and. LDLYSCAV(7)) then
+       status = nf90_put_var(ncid,gsto3_avg_id,GSTO3_AVG)
        if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': putting SCAV_MAP_DRY')
-    end do
-
+            f90file//':'//subr//': putting GstO3_avg')
+       !// [mmol m-2 s-1] -> [nmol m-2 s-1]
+       status = nf90_put_var(ncid,fsto3_avg_id,FSTO3_AVG*1.e6_r8)
+       if (status .ne. nf90_noerr) call handle_error(status, &
+            f90file//':'//subr//': putting Fsto3_avg')
+    end if
     !//---------------------------------------------------------------------
     !// close netcdf file
     status = nf90_close(ncid)
@@ -1347,7 +1822,8 @@
     SCAV_MAP_WLS(:,:,:,:) = 0._r8
     SCAV_MAP_WCN(:,:,:,:) = 0._r8
     SCAV_MAP_DRY(:,:,:,:) = 0._r8
-
+    GSTO3_AVG(:,:) = 0._r8
+    FSTO3_AVG(:,:) = 0._r8
     !// --------------------------------------------------------------------
   end subroutine scav_diag_2fileB
   !// ----------------------------------------------------------------------
Index: OSLO/DEAD_COLUMN/dsttibds.F90_old
===================================================================
--- OSLO/DEAD_COLUMN/dsttibds.F90_old	(.../ctm3f90)	(revision 243)
+++ OSLO/DEAD_COLUMN/dsttibds.F90_old	(.../branches/brOzoNorClim)	(revision 243)
@@ -1,403 +0,0 @@
-! $Header: /mn/hox/ozon/ctm2_model/ctm2_src/dst_dst/dsttibds.F90,v 1.1 2003/04/15 14:41:36 alfgr Exp $
-
-! Purpose: Read time-invariant boundary data sets into dust model 
-! These routines depend heavily on netCDF I/O
-
-! use dsttibds ! [mdl] Time-invariant boundary data sets
-
-! params.h needed for resolution tokens
-!//CTM3 rather uses pmgrid module
-!#include <params_dust.h> /* Preprocessor tokens */ 
-
-module dsttibds ! [mdl] Time-invariant boundary data sets
-  use pmgrid, only: PCNST, PLON, PLAT, PLEV, PLOND, IPARW, JPARW, &
-       XDGRD, YDGRD, XDEDG, YDEDG, AREAXY, IMAP, JMAP, IDGRD, JDGRD
-  use dead_precision ! [mdl] Precision r8, i8, ...
-  implicit none
-  save ! [stt] Changes to common variables are sticky
-
-!//CTM3
-  !// Read-in is done in native CTM resolution, so I have updated this
-  !// routine accordingly.
-  !// Amund Sovde, February 2015
-  
-!//CTM3 rather uses pmgrid module
-  !integer,parameter::pcnst= PCNST ! [nbr] number of advected constituents
-  !integer,parameter::plon= PLON ! [nbr] number of longitudes
-  !integer,parameter::plat= PLAT ! [nbr] number of latitudes
-  !integer,parameter::plev= PLEV ! [nbr] number of vertical levels
-  !integer,parameter::plond= plon ! [nbr] slt extended domain longitude
-  
-contains 
-  
-  subroutine dst_tibds_ini( &
-       fl_in, &                ! I file name
-       mbl_name)               ! I mobilisation name
-    ! Initialize time invariant land surface characteristics
-    ! dst_tibds_ini() is called by CCM:control/initext(), MATCH:src/inirun()
-    use netcdf ! [mdl] netCDF interface
-    use nf90_utl ! [mdl] netCDF utilities
-    use dstsfc ! [mdl] 2-D surface fields on PLON x PLAT grid
-    use dstgrd,only:bln_nbr ! [mdl] Dust grid sizes
-    use regridding, only: E_GRID
-    implicit none
-#ifdef SCCM
-    ! The SCCM header file latlon.h contains two floats, datalat and datalon, 
-    ! which specify the lat and lon of the SCCM profile.
-#include <latlon.h>
-#endif /* not SCCM */
-    ! Parameters
-    !integer,parameter::lat_nbr_max=plat ! NB: This must change to enable SCCM to work
-    !integer,parameter::lon_nbr_max=plon
-    ! Input
-    character(len=*),intent(in)::fl_in    ! netCDF input file
-    character(len=*),intent(in)::mbl_name ! mobilisation name
-    ! Output
-    ! Input/Output
-    ! Local
-    integer area_id           ! [enm] Dimension ID for area
-    integer bln_dmn_id        ! [enm] Dimension ID for blend
-    integer bln_nbr_lcl       ! [nbr] Number of soil blends in file
-    integer cnt_lon_lat(2) ! [nbr] Hyperslab size
-    integer cnt_lon_lat_bln(3) ! [nbr] Hyperslab size
-    integer dst_idx           ! [idx] Counting index
-    integer idx               ! [idx] Counting index
-    integer lat_dmn_id        ! [enm] Dimension ID for lat
-    integer lat_id            ! [enm] Variable ID
-    integer lat_idx           ! [idx] Counting index
-    integer lat_nbr           ! [nbr] Dimension size
-    integer latedg_id            ! [enm] Variable ID
-    integer lnd_frc_dry_id    ! [enm] Variable ID
-    integer lon_dmn_id        ! [enm] Dimension ID for lon
-    integer lon_id            ! [enm] Variable ID
-    integer lon_idx           ! [idx] Counting index
-    integer lon_nbr           ! [nbr] Dimension size
-    integer lonedg_id            ! [enm] Variable ID
-    integer mbl_bsn_fct_id    ! [enm] Variable ID
-    integer mss_frc_CaCO3_id  ! [enm] Variable ID
-    integer mss_frc_cly_id    ! [enm] Variable ID
-    integer mss_frc_snd_id    ! [enm] Variable ID
-    integer nc_id             ! File handle
-    integer rcd               ! [rcd] Return success code
-    integer sfc_typ_id        ! [enm] Variable ID
-    integer sfc_frc_bln_id    ! [enm] Variable ID
-    integer srt_lon_lat(2) ! [idx] Starting offsets
-    integer srt_lon_lat_bln(3) ! [idx] Starting offsets
-    logical flg_err           ! [flg] Bad input data
-    
-    ! Entire lat and lon arrays are retrieved from disk
-    real(r8) lat(JPARW)     ! Entire lat and lon arrays are retrieved from disk
-    real(r8) lon(IPARW)
-    real(r8) latedg(JPARW+1)! Entire lat and lon edge arrays are retrieved from disk
-    real(r8) lonedg(IPARW+1)
-    real(r8) area(IPARW,JPARW)
-    real(r8) r2Dnative(IPARW,JPARW)
-    real(r8) r3Dnative(IPARW,JPARW,bln_nbr)
-    integer  i2Dnative(IPARW,JPARW)
-    integer  stypecount(29), stmp(29), stypefreq(29),six(idgrd,jdgrd), n1,n2,ix,jx,smax,stot
-
-#ifdef SCCM
-    integer lat_idx_sccm      ! SCCM nearest latitude index into boundary data
-    integer lon_idx_sccm      ! SCCM nearest longitude index into boundary data
-    real(r8) dst_crr              ! Current least distance from gridpoint to target
-    real(r8) dst_new              ! Distance of current gridpoint to target
-#endif /* not SCCM */ 
-    
-    ! Initialize default values
-    srt_lon_lat=(/1,1/)
-    srt_lon_lat_bln=(/1,1,1/)
-    !// CTM3: Data will be read in native resolution
-    !cnt_lon_lat=(/plon,plat/)
-    !cnt_lon_lat_bln=(/plon,plat,bln_nbr/)
-    cnt_lon_lat=(/IPARW,JPARW/)
-    cnt_lon_lat_bln=(/IPARW,JPARW,bln_nbr/)
-    
-    ! Read in land surface types from high resolution grid
-    rcd=nf90_noerr              ! nf90_noerr == 0
-    rcd=rcd+nf90_open(fl_in,nf90_nowrite,nc_id)
-    if (rcd /= nf90_noerr) then
-       print*,'Cannot read file '//trim(fl_in)
-       call nf90_err_exit(rcd,"dst_tibds_ini()")
-    endif
-    write(6,"(a29,1x,a)") "dsttibds: Opened netCDF input file",fl_in
-    
-    ! Get dimension IDs
-    rcd=nf90_wrp_inq_dimid(nc_id,"lat",lat_dmn_id)
-    rcd=nf90_wrp_inq_dimid(nc_id,"lon",lon_dmn_id)
-    rcd=nf90_wrp_inq_dimid(nc_id,"bln",bln_dmn_id)
-    ! Get dimension sizes
-    rcd=nf90_wrp(nf90_inquire_dimension(nc_id,lat_dmn_id,len=lat_nbr),"dst_tibds_ini(): inquire_dim lat")
-    if (lat_nbr /= JPARW .and. lat_nbr /= 1) stop "lat_nbr /= JPARW .and. lat_nbr /= 1"
-    rcd=nf90_wrp(nf90_inquire_dimension(nc_id,lon_dmn_id,len=lon_nbr),"dst_tibds_ini(): inquire_dim lon")
-    if (lon_nbr /= IPARW .and. lon_nbr /= 1) stop "lon_nbr /= IPARW .and. lon_nbr /= 1"
-    rcd=nf90_wrp(nf90_inquire_dimension(nc_id,bln_dmn_id,len=bln_nbr_lcl),"dst_tibds_ini(): inquire_dim bln")
-    if (bln_nbr_lcl /= bln_nbr) stop "bln_nbr_lcl /= bln_nbr"
-    ! Get variable IDs
-    rcd=nf90_wrp_inq_varid(nc_id,"lon",lon_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"lat",lat_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"area",area_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"lon_grd",lonedg_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"lat_grd",latedg_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"lnd_frc_dry",lnd_frc_dry_id)
-    rcd=nf90_wrp_inq_varid(nc_id,mbl_name,mbl_bsn_fct_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"mss_frc_CaCO3",mss_frc_CaCO3_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"mss_frc_snd",mss_frc_snd_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"mss_frc_cly",mss_frc_cly_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"sfc_frc_bln",sfc_frc_bln_id)
-    rcd=nf90_wrp_inq_varid(nc_id,"sfc_typ",sfc_typ_id)
-    !// Get area
-    rcd=rcd+nf90_get_var(nc_id,area_id,area)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_var area")
-    rcd=rcd+nf90_get_var(nc_id,latedg_id,latedg)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_var latedg")
-    rcd=rcd+nf90_get_var(nc_id,lonedg_id,lonedg)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_var lonedg")
-    ! Get data
-    rcd=rcd+nf90_get_var(nc_id,lat_id,lat)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_var lat")
-    rcd=rcd+nf90_get_var(nc_id,lon_id,lon)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_var lon")
-    ! In SCCM, find nearest lat and lon indices into boundary data
-#ifdef SCCM
-    !//CTM3
-    !//Not set up to to this when reading from native resolution.
-    stop 'SCCM in dsttidbds.F90'
-    
-    lat_idx_sccm=1
-    dst_crr=abs(datalat-lat(lat_idx_sccm))
-    do lat_idx=1,lat_nbr
-       dst_new=abs(datalat-lat(lat_idx))
-       if(dst_new < dst_crr) then 
-          lat_idx_sccm=lat_idx
-          dst_crr=dst_new
-       endif
-    end do                    ! end loop over lat
-    
-    lon_idx_sccm=1
-    dst_crr=abs(datalon-lon(lon_idx_sccm))
-    do lon_idx=1,lon_nbr
-       dst_new=abs(datalon-lon(lon_idx))
-       if(dst_new < dst_crr) then 
-          lon_idx_sccm=lon_idx
-          dst_crr=dst_new
-       endif
-    end do                    ! end loop over lon
-    
-    ! Overwrite hyperslab indices with coordinates of SCCM column
-    srt_lon_lat=(/lon_idx_sccm,1at_idx_sccm/)
-#endif /* not SCCM */ 
-    
-    !// Read 2D lnd_frc_dry
-    rcd=rcd+nf90_get_var(nc_id,lnd_frc_dry_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara lnd_frc_dry")
-    !// Use native or degrade?
-    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
-       do lat_idx=1,lat_nbr
-          do lon_idx=1,lon_nbr
-             lnd_frc_dry(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
-          end do
-       end do
-    else
-       !// Interpolate; must multiply with area
-       r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,lnd_frc_dry,XDEDG,YDEDG,PLON,PLAT,1)
-       lnd_frc_dry(:,:) = lnd_frc_dry(:,:) / areaxy(:,:)
-    end if
-
-    !// Read 2D mobilisation map: Code names this mbl_bsn_fct, but
-    !// it can be a different field defined by mbl_name above.
-    rcd=rcd+nf90_get_var(nc_id,mbl_bsn_fct_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mbl_bsn_fct")
-    !// Use native or degrade?
-    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
-       do lat_idx=1,lat_nbr
-          do lon_idx=1,lon_nbr
-             mbl_bsn_fct(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
-          end do
-       end do
-    else
-       !// Interpolate; must multiply with area
-       r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mbl_bsn_fct,XDEDG,YDEDG,PLON,PLAT,1)
-       mbl_bsn_fct(:,:) = mbl_bsn_fct(:,:) / areaxy(:,:)
-    end if
-
-
-    !// Read 2D mss_frc_CaCO3
-    rcd=rcd+nf90_get_var(nc_id,mss_frc_CaCO3_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mss_frc_CaCO3")
-    !// Use native or degrade?
-    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
-       do lat_idx=1,lat_nbr
-          do lon_idx=1,lon_nbr
-             mss_frc_CaCO3(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
-          end do
-       end do
-    else
-       !// Interpolate; must multiply with area
-       r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mss_frc_CaCO3,XDEDG,YDEDG,PLON,PLAT,1)
-       mss_frc_CaCO3(:,:) = mss_frc_CaCO3(:,:) / areaxy(:,:)
-    end if
-
-
-    !// Read 2D mss_frc_snd
-    rcd=rcd+nf90_get_var(nc_id,mss_frc_snd_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mss_frc_snd")
-    !// Use native or degrade?
-    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
-       do lat_idx=1,lat_nbr
-          do lon_idx=1,lon_nbr
-             mss_frc_snd(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
-          end do
-       end do
-    else
-       !// Interpolate; must multiply with area
-       r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mss_frc_snd,XDEDG,YDEDG,PLON,PLAT,1)
-       mss_frc_snd(:,:) = mss_frc_snd(:,:) / areaxy(:,:)
-    end if
-
-    !// Read 2D mss_frc_cly
-    rcd=rcd+nf90_get_var(nc_id,mss_frc_cly_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mss_frc_cly")
-    !// Use native or degrade?
-    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
-       do lat_idx=1,lat_nbr
-          do lon_idx=1,lon_nbr
-             mss_frc_cly(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
-          end do
-       end do
-    else
-       !// Interpolate; must multiply with area
-       r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mss_frc_cly,XDEDG,YDEDG,PLON,PLAT,1)
-       mss_frc_cly(:,:) = mss_frc_cly(:,:) / areaxy(:,:)
-    end if
-
-    !// Read 3D sfc_frc_bln
-    rcd=rcd+nf90_get_var(nc_id,sfc_frc_bln_id,r3Dnative,start=srt_lon_lat_bln,count=cnt_lon_lat_bln)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara sfc_frc_bln")
-    !// Use native or degrade?
-    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
-       do idx=1,bln_nbr
-          do lat_idx=1,lat_nbr
-             do lon_idx=1,lon_nbr
-                sfc_frc_bln(lon_idx,lat_idx,idx) = r3Dnative(lon_idx,lat_idx,idx)
-             end do
-          end do
-       end do
-    else
-       !// Interpolate; must multiply with area
-       do idx=1,bln_nbr
-          r2Dnative(:,:) = r3Dnative(:,:,idx) * area(:,:)
-          call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,sfc_frc_bln(:,:,idx),XDEDG,YDEDG,PLON,PLAT,1)
-          sfc_frc_bln(:,:,idx) = sfc_frc_bln(:,:,idx) / areaxy(:,:)
-       end do
-    end if
-
-    !// Read 2D sfc_typ (this is an integer)
-    rcd=rcd+nf90_get_var(nc_id,sfc_typ_id,i2dnative,start=srt_lon_lat,count=cnt_lon_lat)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara sfc_typ")
-    !// Use native or degrade?
-    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
-       do lat_idx=1,lat_nbr
-          do lon_idx=1,lon_nbr
-             sfc_typ(lon_idx,lat_idx) = i2Dnative(lon_idx,lat_idx)
-          end do
-       end do
-    else
-       !// Not possible to interpolate surface types; need to pick one.
-       do lat_idx = 1, PLAT
-          do lon_idx = 1, PLON
-             stypecount(:) = 0
-             six(:,:) = 0
-             do jx = 1, jdgrd
-                do ix = 1, idgrd
-                   !// Index is 0:28, so fortran needs 1:29
-                   idx = i2Dnative(imap(ix,lon_idx),jmap(jx,lat_idx))
-                   six(ix,jx) = idx ! sfc types in window
-                   stypecount(idx+1) = stypecount(idx+1) + 1 ! count #
-                end do
-             end do
-             !// sort type frequencies
-             stypefreq(:) = 0
-             stmp(:) = stypecount(:)
-             stot = 0
-             do n1 = 1, 29 !// Loop through surface types 0-28 (start on 1)
-                smax = 0
-                do n2 = 1, 29 !// Find index for type occuring most frequently
-                   !// There may be several of same freq; if so, pick the first
-                   if (stmp(n2) .gt. smax) smax = n2
-                end do
-                !// Keep track of most frequent surface type.
-                stypefreq(n1) = smax
-                !// Need to zero this type so it is not counted next time
-                if (smax .gt. 0) then
-                   stmp(smax) = 0 !// This entry is counted
-                   stot = stot + 1
-                else
-                   exit !// No more data
-                end if
-             end do
-
-             !// How many different entries
-             if (stot .eq. 1) then
-                sfc_typ(lon_idx,lat_idx) = six(1,1) !// All are the same
-             else if (stot .gt. 1) then
-                !// Pick the largest. Could consider area, but they are not that different.
-                sfc_typ(lon_idx,lat_idx) = stypefreq(1) - 1
-             else
-                print*,'STOT zero'
-                stop
-             end if
-             !print*,lon_idx,lat_idx,stot,sfc_typ(lon_idx,lat_idx)
-
-          end do !// do lon_idx=1,PLON
-       end do !// do lat_idx=1,PLAT
-    end if
-
-    rcd=rcd+nf90_close(nc_id)
-    if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"Unable to close file "//fl_in)
-    write (6,"(a25,1x,a)") "dsttibds: Ingested netCDF file",fl_in
-
-    
-    ! Sanity check (can save lots of wasted time if boundary dataset is corrupt)
-    !// These are all on CTM grid (possibly degraded)
-    flg_err=.false.           ! [flg] Bad input data
-    do lat_idx=1,plat
-       do lon_idx=1,plon
-          if (sfc_typ(lon_idx,lat_idx) < 0.or.sfc_typ(lon_idx,lat_idx) > 28) flg_err=.true. ! [idx] LSM surface type (0..28)
-          if (lnd_frc_dry(lon_idx,lat_idx) < 0.0.or.lnd_frc_dry(lon_idx,lat_idx) > 1.0_r8) flg_err=.true. ! [frc] Dry land fraction
-          if (mbl_bsn_fct(lon_idx,lat_idx) < 0.0) flg_err=.true. ! [frc] Erodibility factor
-          if (mss_frc_CaCO3(lon_idx,lat_idx) < 0.0.or.mss_frc_CaCO3(lon_idx,lat_idx) > 1.0_r8) flg_err=.true. ! [frc] Mass fraction of CaCO3
-          if (mss_frc_cly(lon_idx,lat_idx) < 0.0.or.mss_frc_cly(lon_idx,lat_idx) > 1.0_r8) flg_err=.true. ! [frc] Mass fraction of clay
-          if (mss_frc_snd(lon_idx,lat_idx) < 0.0.or.mss_frc_snd(lon_idx,lat_idx) > 1.0_r8) flg_err=.true. ! [frc] Mass fraction of sand
-          ! fxm: put this in loop up to bln_nbr
-          if (sfc_frc_bln(lon_idx,lat_idx,1) < 0.0.or.sfc_frc_bln(lon_idx,lat_idx,1) > 1.0_r8) flg_err=.true. ![frc] frac. ASS
-          if (sfc_frc_bln(lon_idx,lat_idx,2) < 0.0.or.sfc_frc_bln(lon_idx,lat_idx,2) > 1.0_r8) flg_err=.true. ![frc] frac. FS
-          if (sfc_frc_bln(lon_idx,lat_idx,3) < 0.0.or.sfc_frc_bln(lon_idx,lat_idx,3) > 1.0_r8) flg_err=.true. ![frc] frac. SS
-          if (sfc_frc_bln(lon_idx,lat_idx,4) < 0.0.or.sfc_frc_bln(lon_idx,lat_idx,4) > 1.0_r8) flg_err=.true. ![frc] frac. CS
-          if (flg_err) then
-             write(6,"(a,2(a4,i3,a4,f9.4,a2))")  &
-                  "dsttibds: ERROR dst_tibds_ini() sanity check failed at ", &
-                  "lat(",lat_idx,") = ",ydgrd(lat_idx),", ", &
-                  "lon(",lon_idx,") = ",xdgrd(lon_idx),", "
-             write(6,'(a,i3)') 'sfc_typ: ',sfc_typ(lon_idx,lat_idx)
-             write(6,'(a,f16.12)') 'lnd_frc_dry: ',lnd_frc_dry(lon_idx,lat_idx)
-             write(6,'(a,es20.12)') 'mbl_bsn_fct: ',mbl_bsn_fct(lon_idx,lat_idx)
-             write(6,'(a,es20.12)') 'mss_frc_CaCO3: ',mss_frc_CaCO3(lon_idx,lat_idx)
-             write(6,'(a,es20.12)') 'mss_frc_cly: ',mss_frc_cly(lon_idx,lat_idx)
-             write(6,'(a,es20.12)') 'mss_frc_sbd: ',mss_frc_snd(lon_idx,lat_idx)
-             write(6,'(a,es20.12)') 'sfc_frc_bln 1: ',sfc_frc_bln(lon_idx,lat_idx,1)
-             write(6,'(a,es20.12)') 'sfc_frc_bln 2: ',sfc_frc_bln(lon_idx,lat_idx,2)
-             write(6,'(a,es20.12)') 'sfc_frc_bln 3: ',sfc_frc_bln(lon_idx,lat_idx,3)
-             write(6,'(a,es20.12)') 'sfc_frc_bln 4: ',sfc_frc_bln(lon_idx,lat_idx,4)
-             stop 
-          endif               ! endif err
-       end do                 ! end loop over lon
-    end do                    ! end loop over lat
-    return
-  end subroutine dst_tibds_ini                       ! end dst_tibds_ini()
-  
-end module dsttibds
Index: OSLO/DEAD_COLUMN/dsttvbds.F90
===================================================================
--- OSLO/DEAD_COLUMN/dsttvbds.F90	(.../ctm3f90)	(revision 243)
+++ OSLO/DEAD_COLUMN/dsttvbds.F90	(.../branches/brOzoNorClim)	(revision 243)
@@ -88,11 +88,10 @@
     integer time_nbr_in       ! [nbr] Dimension size
 
     ! Entire lat and lon arrays are retrieved from disk
-    integer, parameter :: J159 = 160, I159=320
-    real(r8) latedg(J159+1)! Entire lat and lon edge arrays are retrieved from disk
-    real(r8) lonedg(I159+1)
-    real(r8) area(I159,J159)
-    real(r8) r2Dnative(I159,J159)
+    real(r8) latedg(JPARW+1)! Entire lat and lon edge arrays are retrieved from disk
+    real(r8) lonedg(IPARW+1)
+    real(r8) area(IPARW,JPARW)
+    real(r8) r2Dnative(IPARW,JPARW)
     real(r8) r2Drun(PLON,PLAT)
     integer lat_idx,lon_idx
 
@@ -109,11 +108,9 @@
 
     ! Get dimension sizes
     rcd=nf90_wrp(nf90_inquire_dimension(nc_id,lat_dmn_id,len=lat_nbr_in),"dst_tvbds_ini(): inquire_dim lat")
-    !// Allow interpolation further below
-    !if (J159 /= lat_nbr_in) stop "J159 /= lat_nbr_in"
+    if (JPARW /= lat_nbr_in) stop "IPARW /= lat_nbr_in"
     rcd=nf90_wrp(nf90_inquire_dimension(nc_id,lon_dmn_id,len=lon_nbr_in),"dst_tvbds_ini(): inquire_dim lon")
-    !// Allow interpolation further below
-    !if (I159 /= lon_nbr_in) stop "IPAR /= lon_nbr_in"
+    if (IPARW /= lon_nbr_in) stop "lon_nbr /= lon_nbr_in"
     rcd=nf90_wrp(nf90_inquire_dimension(nc_id,time_dmn_id,len=time_nbr_in),"dst_tvbds_ini(): inquire_dim time")
     if (time_nbr /= time_nbr_in) stop "time_nbr /= time_nbr_in"
     ! Get variable IDs
@@ -136,7 +133,7 @@
     srt_lon_lat_time=(/1,1,1/)
     !// CTM3: Data will be read in native resolution
     !cnt_lon_lat_time=(/lon_nbr,lat_nbr,1/)
-    cnt_lon_lat_time=(/I159,J159,1/)
+    cnt_lon_lat_time=(/IPARW,JPARW,1/)
     
     ! Initialize hyperslab indices for variables in RAM
     idx_glb_ram=1
@@ -159,7 +156,7 @@
 #endif /* !TOMS */
 
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              vai_dst_bnd(lon_idx,lat_idx,idx_glb_ram) = r2Dnative(lon_idx,lat_idx)
@@ -168,7 +165,7 @@
     else
        !// Interpolate; must multiply with area
        r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,I159,J159,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
+       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
        vai_dst_bnd(:,:,idx_glb_ram) = r2drun(:,:) / areaxy(:,:)
     end if
 
@@ -183,7 +180,7 @@
 #endif /* !TOMS */
 
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              vai_dst_bnd(lon_idx,lat_idx,idx_lub_ram) = r2Dnative(lon_idx,lat_idx)
@@ -192,7 +189,7 @@
     else
        !// Interpolate; must multiply with area
        r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,I159,J159,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
+       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
        vai_dst_bnd(:,:,idx_lub_ram) = r2drun(:,:) / areaxy(:,:)
     end if
 
@@ -235,11 +232,10 @@
     real(r8) time_dlt_1st     ! [day] Time interval between glb and current time
 
     ! Entire lat and lon arrays are retrieved from disk
-    integer, parameter :: J159 = 160, I159=320
-    real(r8) latedg(J159+1)! Entire lat and lon edge arrays are retrieved from disk
-    real(r8) lonedg(I159+1)
-    real(r8) area(I159,J159)
-    real(r8) r2Dnative(I159,J159)
+    real(r8) latedg(JPARW+1)! Entire lat and lon edge arrays are retrieved from disk
+    real(r8) lonedg(IPARW+1)
+    real(r8) area(IPARW,JPARW)
+    real(r8) r2Dnative(IPARW,JPARW)
     real(r8) r2Drun(PLON,PLAT)
     integer lat_idx,lon_idx
 
@@ -280,7 +276,7 @@
           rcd=nf90_wrp(nf90_get_var(nc_id,vai_dst_id,r2Dnative(:,:), &
                start=srt_lon_lat_time,count=cnt_lon_lat_time),"get_var vai_dst")
           !// Use native or degrade?
-          if (PLON.eq.I159 .and. PLAT.eq.J159) then
+          if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
              do lat_idx=1,lat_nbr
                 do lon_idx=1,lon_nbr
                    vai_dst_bnd(lon_idx,lat_idx,idx_lub_ram) = r2Dnative(lon_idx,lat_idx)
@@ -297,7 +293,7 @@
 
              !// Interpolate; must multiply with area
              r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-             call E_GRID(r2Dnative,lonedg,latedg,I159,J159,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
+             call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
              vai_dst_bnd(:,:,idx_lub_ram) = r2drun(:,:) / areaxy(:,:)
           end if
 
@@ -315,7 +311,7 @@
              rcd=nf90_wrp(nf90_get_var(nc_id,vai_dst_id,r2Dnative(:,:), &
                   start=srt_lon_lat_time,count=cnt_lon_lat_time),"get_var vai_dst")
              !// Use native or degrade?
-             if (PLON.eq.I159 .and. PLAT.eq.J159) then
+             if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
                 do lat_idx=1,lat_nbr
                    do lon_idx=1,lon_nbr
                       vai_dst_bnd(lon_idx,lat_idx,idx_glb_ram) = r2Dnative(lon_idx,lat_idx)
@@ -324,7 +320,7 @@
              else
                 !// Interpolate; must multiply with area
                 r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-                call E_GRID(r2Dnative,lonedg,latedg,I159,J159,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
+                call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,r2drun,XDEDG,YDEDG,PLON,PLAT,1)
                 vai_dst_bnd(:,:,idx_glb_ram) = r2drun(:,:) / areaxy(:,:)
              end if
 
Index: OSLO/DEAD_COLUMN/dsttibds.F90
===================================================================
--- OSLO/DEAD_COLUMN/dsttibds.F90	(.../ctm3f90)	(revision 243)
+++ OSLO/DEAD_COLUMN/dsttibds.F90	(.../branches/brOzoNorClim)	(revision 243)
@@ -86,17 +86,15 @@
     logical flg_err           ! [flg] Bad input data
     
     ! Entire lat and lon arrays are retrieved from disk
-    integer, parameter :: J159 = 160, I159=320
-    real(r8) lat(J159)     ! Entire lat and lon arrays are retrieved from disk
-    real(r8) lon(I159)
-    real(r8) latedg(J159+1)! Entire lat and lon edge arrays are retrieved from disk
-    real(r8) lonedg(I159+1)
-    real(r8) area(I159,J159)
-    real(r8) r2Dnative(I159,J159)
-    real(r8) r3Dnative(I159,J159,bln_nbr)
-    integer  i2Dnative(I159,J159), I, J
+    real(r8) lat(JPARW)     ! Entire lat and lon arrays are retrieved from disk
+    real(r8) lon(IPARW)
+    real(r8) latedg(JPARW+1)! Entire lat and lon edge arrays are retrieved from disk
+    real(r8) lonedg(IPARW+1)
+    real(r8) area(IPARW,JPARW)
+    real(r8) r2Dnative(IPARW,JPARW)
+    real(r8) r3Dnative(IPARW,JPARW,bln_nbr)
+    integer  i2Dnative(IPARW,JPARW)
     integer  stypecount(29), stmp(29), stypefreq(29),six(idgrd,jdgrd), n1,n2,ix,jx,smax,stot
-    real(r8) regridded_sfc_typ(PLON,PLAT,29), tmp2d(PLON,PLAT)
 
 #ifdef SCCM
     integer lat_idx_sccm      ! SCCM nearest latitude index into boundary data
@@ -111,8 +109,8 @@
     !// CTM3: Data will be read in native resolution
     !cnt_lon_lat=(/plon,plat/)
     !cnt_lon_lat_bln=(/plon,plat,bln_nbr/)
-    cnt_lon_lat=(/I159,J159/)
-    cnt_lon_lat_bln=(/I159,J159,bln_nbr/)
+    cnt_lon_lat=(/IPARW,JPARW/)
+    cnt_lon_lat_bln=(/IPARW,JPARW,bln_nbr/)
     
     ! Read in land surface types from high resolution grid
     rcd=nf90_noerr              ! nf90_noerr == 0
@@ -129,11 +127,9 @@
     rcd=nf90_wrp_inq_dimid(nc_id,"bln",bln_dmn_id)
     ! Get dimension sizes
     rcd=nf90_wrp(nf90_inquire_dimension(nc_id,lat_dmn_id,len=lat_nbr),"dst_tibds_ini(): inquire_dim lat")
-    !// Allow interpolation further below
-    !if (lat_nbr /= J159 .and. lat_nbr /= 1) stop "lat_nbr /= J159 .and. lat_nbr /= 1"
+    if (lat_nbr /= JPARW .and. lat_nbr /= 1) stop "lat_nbr /= JPARW .and. lat_nbr /= 1"
     rcd=nf90_wrp(nf90_inquire_dimension(nc_id,lon_dmn_id,len=lon_nbr),"dst_tibds_ini(): inquire_dim lon")
-    !// Allow interpolation further below
-    !if (lon_nbr /= I159 .and. lon_nbr /= 1) stop "lon_nbr /= I159 .and. lon_nbr /= 1"
+    if (lon_nbr /= IPARW .and. lon_nbr /= 1) stop "lon_nbr /= IPARW .and. lon_nbr /= 1"
     rcd=nf90_wrp(nf90_inquire_dimension(nc_id,bln_dmn_id,len=bln_nbr_lcl),"dst_tibds_ini(): inquire_dim bln")
     if (bln_nbr_lcl /= bln_nbr) stop "bln_nbr_lcl /= bln_nbr"
     ! Get variable IDs
@@ -195,7 +191,7 @@
     rcd=rcd+nf90_get_var(nc_id,lnd_frc_dry_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
     if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara lnd_frc_dry")
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              lnd_frc_dry(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
@@ -204,23 +200,16 @@
     else
        !// Interpolate; must multiply with area
        r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,I159,J159,lnd_frc_dry,XDEDG,YDEDG,PLON,PLAT,1)
+       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,lnd_frc_dry,XDEDG,YDEDG,PLON,PLAT,1)
        lnd_frc_dry(:,:) = lnd_frc_dry(:,:) / areaxy(:,:)
     end if
-    print*,minval(lnd_frc_dry),maxval(lnd_frc_dry),I159,J159,PLON,PLAT
-       if (minval(lnd_frc_dry).lt. 0.) then
-          print*,'neg. lnd_frc_dry'
-          print*,lonedg
-          print*,xdedg
-          stop
-       end if
 
     !// Read 2D mobilisation map: Code names this mbl_bsn_fct, but
     !// it can be a different field defined by mbl_name above.
     rcd=rcd+nf90_get_var(nc_id,mbl_bsn_fct_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
     if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mbl_bsn_fct")
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              mbl_bsn_fct(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
@@ -229,7 +218,7 @@
     else
        !// Interpolate; must multiply with area
        r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,I159,J159,mbl_bsn_fct,XDEDG,YDEDG,PLON,PLAT,1)
+       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mbl_bsn_fct,XDEDG,YDEDG,PLON,PLAT,1)
        mbl_bsn_fct(:,:) = mbl_bsn_fct(:,:) / areaxy(:,:)
     end if
 
@@ -238,7 +227,7 @@
     rcd=rcd+nf90_get_var(nc_id,mss_frc_CaCO3_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
     if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mss_frc_CaCO3")
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              mss_frc_CaCO3(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
@@ -247,7 +236,7 @@
     else
        !// Interpolate; must multiply with area
        r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,I159,J159,mss_frc_CaCO3,XDEDG,YDEDG,PLON,PLAT,1)
+       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mss_frc_CaCO3,XDEDG,YDEDG,PLON,PLAT,1)
        mss_frc_CaCO3(:,:) = mss_frc_CaCO3(:,:) / areaxy(:,:)
     end if
 
@@ -256,7 +245,7 @@
     rcd=rcd+nf90_get_var(nc_id,mss_frc_snd_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
     if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mss_frc_snd")
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              mss_frc_snd(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
@@ -265,7 +254,7 @@
     else
        !// Interpolate; must multiply with area
        r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,I159,J159,mss_frc_snd,XDEDG,YDEDG,PLON,PLAT,1)
+       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mss_frc_snd,XDEDG,YDEDG,PLON,PLAT,1)
        mss_frc_snd(:,:) = mss_frc_snd(:,:) / areaxy(:,:)
     end if
 
@@ -273,7 +262,7 @@
     rcd=rcd+nf90_get_var(nc_id,mss_frc_cly_id,r2Dnative,start=srt_lon_lat,count=cnt_lon_lat)
     if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara mss_frc_cly")
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              mss_frc_cly(lon_idx,lat_idx) = r2Dnative(lon_idx,lat_idx)
@@ -282,7 +271,7 @@
     else
        !// Interpolate; must multiply with area
        r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-       call E_GRID(r2Dnative,lonedg,latedg,I159,J159,mss_frc_cly,XDEDG,YDEDG,PLON,PLAT,1)
+       call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,mss_frc_cly,XDEDG,YDEDG,PLON,PLAT,1)
        mss_frc_cly(:,:) = mss_frc_cly(:,:) / areaxy(:,:)
     end if
 
@@ -290,7 +279,7 @@
     rcd=rcd+nf90_get_var(nc_id,sfc_frc_bln_id,r3Dnative,start=srt_lon_lat_bln,count=cnt_lon_lat_bln)
     if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara sfc_frc_bln")
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do idx=1,bln_nbr
           do lat_idx=1,lat_nbr
              do lon_idx=1,lon_nbr
@@ -302,7 +291,7 @@
        !// Interpolate; must multiply with area
        do idx=1,bln_nbr
           r2Dnative(:,:) = r3Dnative(:,:,idx) * area(:,:)
-          call E_GRID(r2Dnative,lonedg,latedg,I159,J159,sfc_frc_bln(:,:,idx),XDEDG,YDEDG,PLON,PLAT,1)
+          call E_GRID(r2Dnative,lonedg,latedg,IPARW,JPARW,sfc_frc_bln(:,:,idx),XDEDG,YDEDG,PLON,PLAT,1)
           sfc_frc_bln(:,:,idx) = sfc_frc_bln(:,:,idx) / areaxy(:,:)
        end do
     end if
@@ -311,7 +300,7 @@
     rcd=rcd+nf90_get_var(nc_id,sfc_typ_id,i2dnative,start=srt_lon_lat,count=cnt_lon_lat)
     if (rcd /= nf90_noerr) call nf90_err_exit(rcd,"dst_tibds_ini():get_vara sfc_typ")
     !// Use native or degrade?
-    if (PLON.eq.I159 .and. PLAT.eq.J159) then
+    if (PLON.eq.IPARW .and. PLAT.eq.JPARW) then
        do lat_idx=1,lat_nbr
           do lon_idx=1,lon_nbr
              sfc_typ(lon_idx,lat_idx) = i2Dnative(lon_idx,lat_idx)
@@ -319,38 +308,51 @@
        end do
     else
        !// Not possible to interpolate surface types; need to pick one.
-       !// Should interpolate the map of each type, then pick the largest.
-       !// Index is 0:28, so fortran needs 1:29
-       do n1 = 1, 29 !// Loop through surface types 0-28 (start on 1)
-          r2Dnative(:,:) = 0.
-          do J = 1, J159
-             do I = 1, I159
-                if (i2Dnative(i,j) .eq. n1-1) r2Dnative(i,j) = 1._r8
-             end do
-          end do
-          !// Interpolate
-          r2Dnative(:,:) = r2Dnative(:,:) * area(:,:)
-          call E_GRID(r2Dnative,lonedg,latedg,I159,J159, &
-               tmp2d(:,:),XDEDG,YDEDG,PLON,PLAT,1)
-          regridded_sfc_typ(:,:,n1) = tmp2d(:,:) / areaxy(:,:)
-       end do
-
        do lat_idx = 1, PLAT
           do lon_idx = 1, PLON
-             n2 = 0
-             smax = 0._r8
-             do n1 = 1, 29
-                if (regridded_sfc_typ(lon_idx,lat_idx,n1) .gt. smax) then
-                   smax = regridded_sfc_typ(lon_idx,lat_idx,n1)
-                   n2 = n1
+             stypecount(:) = 0
+             six(:,:) = 0
+             do jx = 1, jdgrd
+                do ix = 1, idgrd
+                   !// Index is 0:28, so fortran needs 1:29
+                   idx = i2Dnative(imap(ix,lon_idx),jmap(jx,lat_idx))
+                   six(ix,jx) = idx ! sfc types in window
+                   stypecount(idx+1) = stypecount(idx+1) + 1 ! count #
+                end do
+             end do
+             !// sort type frequencies
+             stypefreq(:) = 0
+             stmp(:) = stypecount(:)
+             stot = 0
+             do n1 = 1, 29 !// Loop through surface types 0-28 (start on 1)
+                smax = 0
+                do n2 = 1, 29 !// Find index for type occuring most frequently
+                   !// There may be several of same freq; if so, pick the first
+                   if (stmp(n2) .gt. smax) smax = n2
+                end do
+                !// Keep track of most frequent surface type.
+                stypefreq(n1) = smax
+                !// Need to zero this type so it is not counted next time
+                if (smax .gt. 0) then
+                   stmp(smax) = 0 !// This entry is counted
+                   stot = stot + 1
+                else
+                   exit !// No more data
                 end if
              end do
-             if (n2 .eq. 0._r8) then
-                print*,'Wrong n2',n2,n1,smax,lon_idx,lat_idx
-                print*,regridded_sfc_typ(lon_idx,lat_idx,:)
+
+             !// How many different entries
+             if (stot .eq. 1) then
+                sfc_typ(lon_idx,lat_idx) = six(1,1) !// All are the same
+             else if (stot .gt. 1) then
+                !// Pick the largest. Could consider area, but they are not that different.
+                sfc_typ(lon_idx,lat_idx) = stypefreq(1) - 1
+             else
+                print*,'STOT zero'
                 stop
              end if
-             sfc_typ(lon_idx,lat_idx) = n2 - 1
+             !print*,lon_idx,lat_idx,stot,sfc_typ(lon_idx,lat_idx)
+
           end do !// do lon_idx=1,PLON
        end do !// do lat_idx=1,PLAT
     end if
Index: OSLO/DEAD_COLUMN/dead_inirun.f90
===================================================================
--- OSLO/DEAD_COLUMN/dead_inirun.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/DEAD_COLUMN/dead_inirun.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -120,17 +120,15 @@
 
     !// Initialize time-invariant boundary data from netCDF file
     !// (checked ok for CTM3)
-!    if (IPARW .eq. 128) then
-!       dstfile = 'dst_T42.nc'
-!    else if (IPARW .eq. 320) then
-!       dstfile = 'dst_T159.nc'
-!    else if (IPARW .eq. 144) then
+    if (IPARW .eq. 128) then
+       dstfile = 'dst_T42.nc'
+    else if (IPARW .eq. 320) then
        dstfile = 'dst_T159.nc'
-!    else
-!       write(6,'(a)') f90file//':'//subr// &
-!            ': Not defined dst_Txxx.nc file for this resolution! - Stopping'
-!       stop
-!    end if
+    else
+       write(6,'(a)') f90file//':'//subr// &
+            ': Not defined dst_Txxx.nc file for this resolution! - Stopping'
+       stop
+    end if
 
     !// Adjusted to read mobilisation name from input file
     call dst_tibds_ini(trim(dstfile),mbl_name)
Index: OSLO/emissions_ocean.f90
===================================================================
--- OSLO/emissions_ocean.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/emissions_ocean.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -161,7 +161,6 @@
     !// --------------------------------------------------------------------
     use cmn_size, only: LSALT, NPAR_SALT, NPAR
     use cmn_chem, only: TNAME
-    use cmn_sfc, only: LANDUSE_IDX
     use seasalt, only: get_rsalt80um, get_seasaltscheme
     !// --------------------------------------------------------------------
     implicit none
@@ -236,9 +235,6 @@
 
     !// Set scaleEPOA. Should be calculated from climatological averages.
     !// Note that scaling will depend slightly on resolution.
-    !// The scaling will also possibly differ slightly between
-    !// different land surface type datasets, if the ocean coverage
-    !// changes.
     if (SeaSaltScheme .eq. 1) then
        scaleEPOA = 0.35_r8  !// First guess
     else if (SeaSaltScheme .eq. 2) then
@@ -246,19 +242,11 @@
     else if (SeaSaltScheme .eq. 3) then
        scaleEPOA = 0.5_r8 !// About right
     else if (SeaSaltScheme .eq. 4) then
-       !// Using CLM4-PFTs, a factor 0.57 gives 6.3Tg as
-       !// mean of 2000 and 2016. MODIS land cover seemed to
-       !// give the same using scaling factor 0.5.
-       scaleEPOA = 0.57_r8
+       scaleEPOA = 0.57_r8 !// 6.3Tg for mean of 2000 and 2016
     else
-       write(6,'(a,i5)') f90file//':'//subr// &
-            ': No scaleEPOA set for SeaSaltScheme ',SeaSaltScheme
-       stop
+       scaleEPOA = 1._r8  !// Not known yet; assume 1.
     end if
 
-    write(6,'(a,i5)') f90file//':'//subr//': Sea salt acheme ',SeaSaltScheme
-    write(6,'(a,i5)') f90file//':'//subr//': scaleEPOA ',scaleEPOA
-
     !// --------------------------------------------------------------------
   end subroutine emissions_ocean_organiccarbon_init
   !// ----------------------------------------------------------------------
@@ -305,7 +293,7 @@
 
     !// Filename to read
     if (YEAR_CHLA .eq. 9999) then
-       if (MYEAR .lt. 2003 .or. MYEAR .gt. 2017) then
+       if (MYEAR .lt. 2003 .or. MYEAR .gt. 2014) then
           !// Use a climatology
           write(CMON(1:2),'(i2.2)') JMON
           infile = trim(chlaPATH)//'chlorophyllA/modis_chlorophyll_a_'// &
Index: OSLO/emissions_megan.f90
===================================================================
--- OSLO/emissions_megan.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/emissions_megan.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -694,6 +694,7 @@
     use cmn_sfc, only: LAI, ZOI, landSurfTypeFrac, LANDUSE_IDX, StomRes
     use utilities, only: LOCSZA
     use cmn_oslo, only: DINM, trsp_idx
+    use utilities_oslo, only: GROWSEASON
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -3241,6 +3242,8 @@
     !// Amund Sovde Haslerud, October 2017
     !//   Based on MEGANv2.10 code, modified for Oslo CTM3
     !// --------------------------------------------------------------------
+    use utilities_oslo, only: GROWSEASON
+    !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
     integer, intent(in) :: JDAY
@@ -3274,120 +3277,7 @@
   !// ----------------------------------------------------------------------
 
 
-
   !// ----------------------------------------------------------------------
-  subroutine GROWSEASON ( JDAY, LAT, GDAY, GLEN )
-    !// --------------------------------------------------------------------
-    !  DESCRIPTION
-    !    This internal function computes the day of the growing season
-    !    corresponding to the given day of year.
-    !
-    !  HISTORY:
-    !    07/21/11 : Imported from SMOKE-BEIS v3.14 and modified  (Tan)
-    !               Variation of growing season depends on latitude
-    !               (Guenther)
-    !//
-    !// Amund Sovde Haslerud, October 2017
-    !//   Based on MEGANv2.10 code, modified for Oslo CTM3
-    !// --------------------------------------------------------------------
-    use cmn_ctm, only: LYEAR
-    !// --------------------------------------------------------------------
-    implicit none
-    !// --------------------------------------------------------------------
-    integer, intent(in) :: JDAY
-    real(r8), intent(in) :: LAT
-    integer, intent(out) :: GDAY, GLEN
-
-    !// Locals
-    integer  :: &
-         GSEASON_START, GSEASON_END, &
-         MAY31,NOV1,DEC31
-    !// --------------------------------------------------------------------
-    character(len=*), parameter :: subr = 'GROWSEASON'
-    !// --------------------------------------------------------------------
-
-    !// Days of year for important dates, taking leap year into account
-    if (LYEAR) then
-       MAY31 = 152
-       NOV1  = 306
-       DEC31 = 366
-    else
-       MAY31 = 151
-       NOV1  = 305
-       DEC31 = 365
-    end if
-
-    if ( LAT .le. 23.0_r8 .and. LAT .ge. -23.0_r8 ) then
-       ! tropical regions, year round
-       GSEASON_START = 1
-       GSEASON_END = DEC31
-
-       GDAY = JDAY - GSEASON_START + 1
-       GLEN = GSEASON_END - GSEASON_START + 1
-
-    else if ( LAT .lt. -23.0_r8 ) then
-       ! southern hemisphere
-       if ( LAT .lt. -60.0_r8 ) then
-          ! antarctic start = 0 end = 0, no growing
-          GDAY = 0
-          GLEN = 0
-       else
-          ! southern hemisphere temperate, NOV, DEC, JAN-MAY
-          if (JDAY .ge. NOV1 .AND. JDAY .le. DEC31 ) THEN
-             GSEASON_START = NOV1
-             GSEASON_END   = DEC31
-
-             GDAY = JDAY - GSEASON_START + 1
-             !// Total lenght of growing season (Nov-May)
-             GLEN = DEC31-NOV1 + 1 + MAY31
-          else if (JDAY .ge. 1 .and. JDAY .le. MAY31) then
-             GSEASON_START = 1
-             GSEASON_END   = MAY31
-             !// Add Nov+Dec
-             GDAY = JDAY - GSEASON_START + 1 + 61
-             GLEN = 61 + GSEASON_END - GSEASON_START + 1
-             !// Total lenght of growing season (Nov-May)
-             GLEN = DEC31-NOV1 + 1 + MAY31
-          else
-             GDAY = 0
-             GLEN = 0
-          end if
-
-       end if
-
-    else if ( LAT .gt. 23._r8 ) then
-
-       ! northern hemisphere
-       if ( LAT .gt. 65.0_r8 ) then
-          ! arctic start = 0 end = 0, no growing season
-          GDAY = 0
-          GLEN = 0
-       else
-          ! northern hemisphere temperate
-          ! start= (lat-23)*4.5            189
-          ! end = 365 -((lat-23)*3.3)      226
-
-          GSEASON_START = INT( (LAT - 23.0_r8) * 4.5_r8 )
-          GSEASON_END   = DEC31 - INT( (LAT - 23.0_r8) * 3.3_r8 )
-
-          if (JDAY .ge. GSEASON_START .and. JDAY .le. GSEASON_END) then
-             GDAY = JDAY - GSEASON_START + 1
-          else
-             GDAY = 0
-          end if
-          GLEN = GSEASON_END - GSEASON_START + 1
-       end if
-    else
-       write(6,'(a,es16.6)') f90file//':'//subr//': Invalid LAT ',LAT
-       stop
-    end if
-
-    !// --------------------------------------------------------------------
-  end subroutine GROWSEASON
-  !// ----------------------------------------------------------------------
-
-
-  !// ----------------------------------------------------------------------
   real(r8) function prec_adj(I,J,accRain24)
     !// --------------------------------------------------------------------
     !// --------------------------------------------------------------------
Index: OSLO/drydeposition_oslo.f90
===================================================================
--- OSLO/drydeposition_oslo.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/drydeposition_oslo.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -25,9 +25,11 @@
   !//   - subroutine get_vdep2
   !//   - subroutine get_STC
   !//   - subroutine get_PARMEAN
+  !//   - subroutine get_PPFD
   !//   - subroutine get_asn24h
   !//   - subroutine aer_vdep2
   !//
+  !// Stefanie Falk, Februar 2018 - July 2018
   !// Amund Sovde, December 2013 - January 2014
   !// ----------------------------------------------------------------------
   use cmn_precision, only: r8
@@ -42,6 +44,8 @@
        VNOXDDEP, VSO2DDEP, VSO4DDEP, VMSADDEP, VNH3DDEP
   !// Stomatal conductance and mean photolytic active radiation
   real(r8), dimension(IPAR,JPAR,12) :: STC, PARMEAN
+  ! Parameters and land use type from EMEP
+  real(r8), dimension(28,16) :: EMEP_PAR
   !// Defines which VDEP to scale according to stability (i.e. only
   !// old CTM2 calculations)
   integer :: SCALESTABILITY(NPAR)
@@ -53,8 +57,7 @@
   !// Monthly averaged Asn to be used if NH3 and SO2 are not included
   !real(r8) :: ASNCLIM(IPAR,JPAR,12) !// Not currently included
 
-  logical, parameter :: LDEPEMEP2012 = .false.
-  !// ----------------------------------------------------------------------
+    !// ----------------------------------------------------------------------
   character(len=*), parameter, private :: f90file = 'drydeposition_oslo.f90'
   !// ----------------------------------------------------------------------
 
@@ -73,7 +76,7 @@
     !//
     !// Amund Sovde, October 2008
     !// --------------------------------------------------------------------
-    use cmn_sfc, only: VDEP
+    use cmn_sfc, only: VDEP, VGSTO3
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -83,11 +86,16 @@
     !// --------------------------------------------------------------------
     character(len=*), parameter :: subr = 'drydepinit'
     !// --------------------------------------------------------------------
-
+    !// Temporare ascii array
+    character(len=8), dimension(29,16) :: temp
+    !// --------------------------------------------------------------------
     !// Initialize dry deposition
     write(6,'(a)') f90file//':'//subr//': initializing VDEP' 
     VDEP(:,:,:) = 0._r8
-
+    !// Initialize stomata deposition
+    write(6,'(a)') f90file//':'//subr//': initializing VGSTO3' 
+    VGSTO3(:,:) = 0._r8
+    
     !// read in Deposition velocities
     FILE_NAME='./Indata_CTM3/drydep.ctm'
     open(1,file=FILE_NAME,Status='OLD',Form='FORMATTED',IOSTAT=IOS)
@@ -171,9 +179,12 @@
     !// Also reads stomatal conductance and photsynthetic active radiation
     !// for EMEP-based dry deposition of species.
     !//
+    !// Stefanie Falk, July 2018
     !// Amund Sovde, March 2013 - January 2014
     !// --------------------------------------------------------------------
-    use cmn_ctm, only: JMON, JDATE
+    use cmn_ctm, only: JMON, JDATE, NRMETD
+    use cmn_sfc, only: LDEPEMEP2012
+    use cmn_oslo, only: TEMPAVG
     use ch4routines, only: updateSOILUPTAKEbousquet
     !// --------------------------------------------------------------------
     implicit none
@@ -182,25 +193,22 @@
     logical, intent(in) :: LNEW_MONTH
     integer, intent(in) :: NDAYI, NDAY, NMET, NOPS
     !// --------------------------------------------------------------------
+    !//---time steps -TAU- (hr) and DT-- (s)
+    real(r8) :: DTMET, DTAUMT
+    !// Time steps
+    DTAUMT = 24._r8 / real(NRMETD, r8)  ! in hours
+    DTMET  = 3600._r8 *DTAUMT  ! in seconds
 
     !// CH4 soil uptake, stores values in CH4SOILUPTAKE
     call updateSOILUPTAKEbousquet(LNEW_MONTH)
 
     !// DRYDEP2
     if (LDEPEMEP2012) then
-       !// Monthly input for dry deposition scheme, currently read
-       !// at 1Jan and at model start.
-       if ( (nday.eq.ndayi .or. (jmon.eq.1.and.jdate.eq.1)) &
-            .and. (nmet.eq.1 .and. nops.eq.1) ) then
-          !// Read 1 year of monthly stomatal conductance
-          call get_STC()
-          !// Read 1 year of monthly photsynthetic active radiation
-          call get_PARMEAN()
-       end if
-
        !// Find SO2/NH3 fraction for each hour
-       call get_asn24h(NDAYI,NDAY,NMET,NOPS)
-
+       call get_asn24h(NDAYI, NDAY, NMET, NOPS)
+       !// Update photon flux density
+       call get_PPFD(NMET, DTMET)
+       
     end if !// if (LDEPEMEP2012) then
 
     !// --------------------------------------------------------------------
@@ -225,7 +233,7 @@
     use cmn_fjx, only: SZAMAX
     use cmn_met, only: CI, SD, PBL_KEDDY, ZOFLE, SFT
     use cmn_parameters, only: M_AIR, AVOGNR, R_AIR, G0, LDEBUG
-    use cmn_sfc, only: landSurfTypeFrac, LANDUSE_IDX, VDEP
+    use cmn_sfc, only: landSurfTypeFrac, LANDUSE_IDX, VDEP, VGSTO3, LDEPEMEP2012
     use cmn_oslo, only: chem_idx, trsp_idx
     use bcoc_oslo, only: bcoc_setdrydep, bcoc_vdep2
     use soa_oslo, only: soa_setdrydep
@@ -247,7 +255,8 @@
     real(r8),dimension(IDBLK,JDBLK) :: DZ, &
          VNO2, VO3, VHNO3, VPAN, VCO, VH2O2, &
          VSO2, VSO4, VMSA, VNH3, &
-         VNO,  VHCHO, VCH3CHO
+         VNO,  VHCHO, VCH3CHO, &
+         VSto
 
     integer :: MDAY(IDBLK,JDBLK)    !// 1=day, 2=night
     integer :: MSEASON(IDBLK,JDBLK) !// 0=summer, 3=winter
@@ -463,13 +472,13 @@
 
        if (LDEPEMEP2012) then
           !// New dry deposition scheme (ala EMEP2012)
-
+          
           !// Not to be standard yet...
           !// When it is, remember dtmax=300 in oc_tropchem
 
           !// Get new dry deposition values [m/s]
           call get_vdep2(UTTAU, BTT, AIRB, BTEM, MP, &
-               VO3,VHNO3,VPAN,VH2O2,VNO2, VSO2,VNH3, VNO,VHCHO,VCH3CHO)
+               VO3,VHNO3,VPAN,VH2O2,VNO2, VSO2,VNH3, VNO,VHCHO,VCH3CHO, VSto)
 
           !// CTM2 drydep is crude and needs to be adjusted to stability
           !// parameters. This is not the case for VDEP2 treatment, which
@@ -505,6 +514,7 @@
           VNO(:,:)     = 0._r8
           VHCHO(:,:)   = 0._r8
           VCH3CHO(:,:) = 0._r8
+          VSto(:,:)    = 0._r8
 
           !// All are scaled by stability
           SCALESTABILITY(:) = 1
@@ -523,20 +533,21 @@
        VNO(:,:)     = 0._r8
        VHCHO(:,:)   = 0._r8
        VCH3CHO(:,:) = 0._r8
+       VSto(:,:)    = 0._r8
 
     end if !// if (LOSLOCTROP) then
 
     !// --------------------------------------------------------------------
     !// UCI deposition override [m/s]
     !// --------------------------------------------------------------------
-
+   
     !// Loop over latitude (J is global, JJ is block)
     do J = MPBLKJB(MP),MPBLKJE(MP)
       JJ    = J - MPBLKJB(MP) + 1
       !// Loop over longitude (I is global, II is block)
       do I = MPBLKIB(MP),MPBLKIE(MP)
         II    = I - MPBLKIB(MP) + 1
-
+        VGSTO3(I,J) = VStO(II, JJ)                   !// Stomata deposition
         do N = 1,NTM
 
           if (chem_idx(N) .eq. 1) then               !// Standard tropchem ---v
@@ -576,8 +587,7 @@
         end do !// do N=1,NTM
       end do !// do I = MPBLKIB(MP),MPBLKIE(MP)
     end do !// do J = MPBLKJB(MP),MPBLKJE(MP)
-
-
+    
     if (LDEPEMEP2012) then
        !//EMEP2012
        !// Set dry deposition for BCOC (m/s)
@@ -756,7 +766,7 @@
 
   !// ----------------------------------------------------------------------
   subroutine get_vdep2(UTTAU,BTT,AIRB,BTEM, MP, &
-         VO3,VHNO3,VPAN,VH2O2,VNO2, VSO2,VNH3, VNO,VHCHO,VCH3CHO)
+         VO3,VHNO3,VPAN,VH2O2,VNO2, VSO2,VNH3, VNO,VHCHO,VCH3CHO, VSto)
     !// --------------------------------------------------------------------
     !// Calculate drydep of gases as in EMEP model, Simpson etal (2012),
     !// ACP, doi:10.5194/acp-12-7825-2012, refered to as EMEP2012 in
@@ -782,11 +792,13 @@
     use cmn_ctm, only: XGRD, YGRD, XDGRD, YDGRD, MPBLKJB, MPBLKJE, &
          MPBLKIB, MPBLKIE, IDAY, JMON, JDAY, PLAND, NRMETD, NROPSM
     use cmn_met, only: PRANDTLL1, P, SD, CI, USTR, ZOFLE, PRECLS, PRECCNV, &
-         CLDFR, PhotActRad, UMS, VMS, SFT
-    use cmn_parameters, only: R_AIR
-    use cmn_sfc, only: LAI, ZOI, landSurfTypeFrac, LANDUSE_IDX, StomRes, NVGPAR
+         CLDFR, PPFD, UMS, VMS, SFT, SWVL1
+    use cmn_parameters, only: R_AIR, R_UNIV
+    use cmn_sfc, only: LAI, ZOI, landSurfTypeFrac, LANDUSE_IDX, StomRes, NVGPAR, &
+         EMEP_PAR, LGSMAP
     use cmn_oslo, only: trsp_idx
-    use utilities_oslo, only: landfrac2emep
+    use utilities_oslo, only: landfrac2emep, set_vegetation_height, &
+         GROWSEASON, MAPPED_GROWSEASON
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -797,18 +809,23 @@
     integer, intent(in) :: MP
     !// Output
     real(r8),dimension(IDBLK,JDBLK), intent(out) :: &
-         VO3,VHNO3,VPAN,VH2O2,VNO2, VSO2,VNH3, VNO,VHCHO,VCH3CHO
+         VO3,VHNO3,VPAN,VH2O2,VNO2, VSO2,VNH3, VNO,VHCHO,VCH3CHO, VSto
 
     !// Locals
     integer :: I,J,II,JJ, NN, KK, NTOTAL
-    real(r8) :: LAI_IJ, RTOTAL, PAR_IJ
+    real(r8) :: LAI_IJ, RTOTAL, PAR_IJ, SWVL1_IJ
+    real(r8) :: tempVEGH
+    integer :: GDAY, GLEN                   !// Growing season from megan
 
-
     !// Variables to be set for each EMEP category (10 is treated separately)
     integer, parameter :: NLCAT=10
-    real(r8),dimension(NLCAT) :: RgsO3, RgsSO2, SAI, SAI0, VEGH, FL, &
-         Rinc, GO3, GSO2, fsnowC
-
+    real(r8), dimension(NLCAT) :: SAI, SAI0,  FL, gsto, &
+          Rinc, GO3, GSO2, fLight, fsnowC, fstcT2, fphen, fD, fSW
+    !// Parameters from EMEP.par
+    real(r8), dimension(NLCAT) :: gmax, fmin, Dmin, Dmax,   &
+         phia, phib, phic, phid, phie, phif, phiAS, phiAE,  &
+         RgsO3, RgsSO2, VEGH, topt, tmin, tmax, dSGS, dEGS, &
+         fLightAlpha, ddSGS, ddEGS
     !// Resistances and deposition velocities
     integer, parameter :: NDDEP = 14
     real(r8)                   :: Ra, Tot_res
@@ -821,11 +838,11 @@
     real(r8) :: d_i, RbL, RbO
     !// To calculate Rc
     real(r8) :: RsnowO3, RsnowSO2, GnsO3, GcO3, GstO3, d, gext, &
-         Rgs, FT, fstcT2, topt, tmin, tmax, &
+         Rgs, FT, VPD, &
          T2Mcel, ee, RH, M_SO2, M_NH3, Asn, Asn24, &
          GnsSO2, GSO2_dry, GSO2_wet, &
-         stc_avg
-
+         Gstc_avg 
+    
     !// Uptake parameters taken from Wesley (Atm.Env., 1989,
     !// doi:10.1016/0004-6981(89)90153-4)
     !// D_H2O/D_x in Table 2
@@ -875,7 +892,7 @@
     !// SAI0:   To calculate surface area index SAI = LAI+SAI0
     !// VEG_H:  Vegetation height
 
-    !// EMEP categories
+    !// Reduced EMEP categories
     !//  1. Forests, Mediterranean scrub
     !//  2. Crops
     !//  3. Moorland (savanna++)
@@ -886,84 +903,303 @@
     !//  8. Water
     !//  9. Urban
     !// 10. Ice+snow (strictly, EMEP has this as category 9 and urban as 10)
+    !// Maximal stomatal conductance
+    !// gmax = EMEP_PAR(1,:) !// mmmole O3 m-2 s-1
+    !// fmin = EMEP_PAR(2,:)
+    !// Phenomenology fphen (Table S17)
+    !// phia = EMEP_PAR(3,:)
+    !// phib = EMEP_PAR(4,:)
+    !// phic = EMEP_PAR(5,:)
+    !// phid = EMEP_PAR(6,:)
+    !// phie = EMEP_PAR(7,:)
+    !// phif = EMEP_PAR(8,:)
+    !// phiAS = EMEP_PAR(9,:)
+    !// phiAE = EMEP_PAR(10,:)
+    !// Light dependent scaling
+    !// flightalpha = EMEP_PAR(11,:)
+    !// Temperature scaling fT (Supplement Eq. (17))
+    !// tmin = EMEP_PAR(12,:)
+    !// topt = EMEP_PAR(13,:)
+    !// tmax = EMEP_PAR(14,:)
+    !// Humidity dependent scaling fD (Supplement Eq. (18))
+    !// Dmax = EMEP_PAR(15,:)
+    !// Dmin = EMEP_PAR(16,:)
+    !// Surface resistance
+    !// RgsSO2 = EMEP_PAR(18,:)
+    !// RgsO3  = EMEP_PAR(19,:)
+    !// Vegetation height
+    !// VEGH   = EMEP_PAR(20,:)
+    !// Growing season
+    !// dSGS = EMEP_PAR(21,:)   !// Start
+    !// dEGS = EMEP_PAR(22,:)   !// End
+    !// ddSGS = EMEP_PAR(23,:)  !// Latitude dependent change of start (rate)
+    !// ddEGS = EMEP_PAR(24,:)  !// Latitude dependent change of end (rate)
 
     !//  1. Forests, Mediterranean scrub
-    RgsO3(1)  = 200._r8
-    RgsSO2(1) = 0._r8 !// Will be modified below (in-canopy ok, needs EMEP2012)
-    SAI0(1)   = 1._r8
-    VEGH(1)   = 20._r8 !// Will be modified below 
+    gmax(1)        = (sum(EMEP_PAR(1,1:4))+EMEP_PAR(1,10))/5._r8 
+    fmin(1)        = (sum(EMEP_PAR(2,1:4))+EMEP_PAR(2,10))/5._r8
+    phia(1)        = (sum(EMEP_PAR(3,1:4))+EMEP_PAR(3,10))/5._r8
+    phib(1)        = (sum(EMEP_PAR(4,1:4))+EMEP_PAR(4,10))/5._r8
+    phic(1)        = (sum(EMEP_PAR(5,1:4))+EMEP_PAR(5,10))/5._r8
+    phid(1)        = (sum(EMEP_PAR(6,1:4))+EMEP_PAR(6,10))/5._r8
+    phie(1)        = (sum(EMEP_PAR(7,1:4))+EMEP_PAR(7,10))/5._r8
+    phif(1)        = (sum(EMEP_PAR(8,1:4))+EMEP_PAR(8,10))/5._r8
+    phiAS(1)       = (sum(EMEP_PAR(9,1:4))+EMEP_PAR(9,10))/5._r8
+    phiAE(1)       = (sum(EMEP_PAR(10,1:4))+EMEP_PAR(10,10))/5._r8
+    flightalpha(1) = (sum(EMEP_PAR(11,1:4))+EMEP_PAR(11,10))/5._r8
+    tmin(1)        = (sum(EMEP_PAR(12,1:4))+EMEP_PAR(12,10))/5._r8
+    topt(1)        = (sum(EMEP_PAR(13,1:4))+EMEP_PAR(13,10))/5._r8
+    tmax(1)        = (sum(EMEP_PAR(14,1:4))+EMEP_PAR(14,10))/5._r8
+    Dmax(1)        = (sum(EMEP_PAR(15,1:4))+EMEP_PAR(15,10))/5._r8
+    Dmin(1)        = (sum(EMEP_PAR(16,1:4))+EMEP_PAR(16,10))/5._r8
+    RgsSO2(1)      = (sum(EMEP_PAR(18,1:4))+EMEP_PAR(18,10))/5._r8 
+    RgsO3(1)       = (sum(EMEP_PAR(19,1:4))+EMEP_PAR(19,10))/5._r8
+    VEGH(1)        = 0._r8 !// Will be modified
+    tempVEGH       = (sum(EMEP_PAR(20,1:4))+EMEP_PAR(20,10))/5._r8 
+    dSGS(1)        = (sum(EMEP_PAR(21,1:4))+EMEP_PAR(21,10))/5._r8  !// Start
+    dEGS(1)        = (sum(EMEP_PAR(22,1:4))+EMEP_PAR(22,10))/5._r8  !// End
+    ddSGS(1)       = (sum(EMEP_PAR(23,1:4))+EMEP_PAR(23,10))/5._r8  !// Latitude dependent change of start (rate)
+    ddEGS(1)       = (sum(EMEP_PAR(24,1:4))+EMEP_PAR(24,10))/5._r8
     !//  2. Crops
-    RgsO3(2)  = 200._r8
-    RgsSO2(2) = 0._r8 !// Will be modified below (in-canopy ok, needs EMEP2012)
-    SAI0(2)   = 0._r8 !// Will be modified below (ok)
-    VEGH(2)   = 0.4_r8
+    gmax(2)        = sum(EMEP_PAR(1,5:7))/3._r8
+    fmin(2)        = sum(EMEP_PAR(2,5:7))/3._r8
+    phia(2)        = sum(EMEP_PAR(3,5:7))/3._r8
+    phib(2)        = sum(EMEP_PAR(4,5:7))/3._r8
+    phic(2)        = sum(EMEP_PAR(5,5:7))/3._r8
+    phid(2)        = sum(EMEP_PAR(6,5:7))/3._r8
+    phie(2)        = sum(EMEP_PAR(7,5:7))/3._r8
+    phif(2)        = sum(EMEP_PAR(8,5:7))/3._r8
+    phiAS(2)       = sum(EMEP_PAR(9,5:7))/3._r8
+    phiAE(2)       = sum(EMEP_PAR(10,5:7))/3._r8
+    flightalpha(2) = sum(EMEP_PAR(11,5:7))/3._r8
+    tmin(2)        = sum(EMEP_PAR(12,5:7))/3._r8
+    topt(2)        = sum(EMEP_PAR(13,5:7))/3._r8
+    tmax(2)        = sum(EMEP_PAR(14,5:7))/3._r8
+    Dmax(2)        = sum(EMEP_PAR(15,5:7))/3._r8
+    Dmin(2)        = sum(EMEP_PAR(16,5:7))/3._r8
+    RgsSO2(2)      = sum(EMEP_PAR(18,5:7))/3._r8  !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(2)       = sum(EMEP_PAR(19,5:7))/3._r8
+    VEGH(2)        = sum(EMEP_PAR(20,5:7))/3._r8
+    dSGS(2)        = sum(EMEP_PAR(21,5:7))/3._r8  !// Start
+    dEGS(2)        = sum(EMEP_PAR(22,5:7))/3._r8  !// End
+    ddSGS(2)       = sum(EMEP_PAR(23,5:7))/3._r8  !// Latitude dependent change of start (rate)
+    ddEGS(2)       = sum(EMEP_PAR(24,5:7))/3._r8 
     !//  3. Moorland (savanna++)
-    RgsO3(3)  = 400._r8
-    RgsSO2(3) = 0._r8 !// Will be modified below (in-canopy ok, needs EMEP2012)
-    SAI0(3)   = 0._r8
-    VEGH(3)   = 0.7_r8
+    gmax(3)        = EMEP_PAR(1,8)
+    fmin(3)        = EMEP_PAR(2,8)
+    phia(3)        = EMEP_PAR(3,8)
+    phib(3)        = EMEP_PAR(4,8)
+    phic(3)        = EMEP_PAR(5,8)
+    phid(3)        = EMEP_PAR(6,8)
+    phie(3)        = EMEP_PAR(7,8)
+    phif(3)        = EMEP_PAR(8,8)
+    phiAS(3)       = EMEP_PAR(9,8)
+    phiAE(3)       = EMEP_PAR(10,8)
+    flightalpha(3) = EMEP_PAR(11,8)
+    tmin(3)        = EMEP_PAR(12,8)
+    topt(3)        = EMEP_PAR(13,8)
+    tmax(3)        = EMEP_PAR(14,8)
+    Dmax(3)        = EMEP_PAR(15,8)
+    Dmin(3)        = EMEP_PAR(16,8)
+    RgsSO2(3)      = EMEP_PAR(18,8) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(3)       = EMEP_PAR(19,8)
+    VEGH(3)        = EMEP_PAR(20,8)
+    dSGS(3)        = EMEP_PAR(21,8)  !// Start
+    dEGS(3)        = EMEP_PAR(22,8)  !// End
+    ddSGS(3)       = EMEP_PAR(23,8)  !// Latitude dependent change of start (rate)
+    ddEGS(3)       = EMEP_PAR(24,8) 
     !//  4. Grassland
-    RgsO3(4)  = 1000._r8
-    RgsSO2(4) = 0._r8 !// Will be modified below (in-canopy ok, needs EMEP2012)
-    SAI0(4)   = 0._r8
-    VEGH(4)   = 0.4_r8
+    gmax(4)        = EMEP_PAR(1,9)
+    fmin(4)        = EMEP_PAR(2,9)
+    phia(4)        = EMEP_PAR(3,9)
+    phib(4)        = EMEP_PAR(4,9)
+    phic(4)        = EMEP_PAR(5,9)
+    phid(4)        = EMEP_PAR(6,9)
+    phie(4)        = EMEP_PAR(7,9)
+    phif(4)        = EMEP_PAR(8,9)
+    phiAS(4)       = EMEP_PAR(9,9)
+    phiAE(4)       = EMEP_PAR(10,9)
+    flightalpha(4) = EMEP_PAR(11,9)
+    tmin(4)        = EMEP_PAR(12,9)
+    topt(4)        = EMEP_PAR(13,9)
+    tmax(4)        = EMEP_PAR(14,9)
+    Dmax(4)        = EMEP_PAR(15,9)
+    Dmin(4)        = EMEP_PAR(16,9)
+    RgsSO2(4)      = EMEP_PAR(18,9) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(4)       = EMEP_PAR(19,9)
+    VEGH(4)        = EMEP_PAR(20,9)
+    dSGS(4)        = EMEP_PAR(21,9)  !// Start
+    dEGS(4)        = EMEP_PAR(22,9)  !// End
+    ddSGS(4)       = EMEP_PAR(23,9)  !// Latitude dependent change of start (rate)
+    ddEGS(4)       = EMEP_PAR(24,9) 
     !//  5. Wetlands
-    RgsO3(5)  = 400._r8
-    RgsSO2(5) = 50._r8
-    SAI0(5)   = 1._r8
-    VEGH(5)   = 0.5_r8
+    gmax(5)        = EMEP_PAR(1,11)
+    fmin(5)        = EMEP_PAR(2,11)
+    phia(5)        = EMEP_PAR(3,11)
+    phib(5)        = EMEP_PAR(4,11)
+    phic(5)        = EMEP_PAR(5,11)
+    phid(5)        = EMEP_PAR(6,11)
+    phie(5)        = EMEP_PAR(7,11)
+    phif(5)        = EMEP_PAR(8,11)
+    phiAS(5)       = EMEP_PAR(9,11)
+    phiAE(5)       = EMEP_PAR(10,11)
+    flightalpha(5) = EMEP_PAR(11,11)
+    tmin(5)        = EMEP_PAR(12,11)
+    topt(5)        = EMEP_PAR(13,11)
+    tmax(5)        = EMEP_PAR(14,11)
+    Dmax(5)        = EMEP_PAR(15,11)
+    Dmin(5)        = EMEP_PAR(16,11)
+    RgsSO2(5)      = EMEP_PAR(18,11) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(5)       = EMEP_PAR(19,11)
+    VEGH(5)        = EMEP_PAR(20,11)
+    dSGS(5)        = EMEP_PAR(21,11)  !// Start
+    dEGS(5)        = EMEP_PAR(22,11)  !// End
+    ddSGS(5)       = EMEP_PAR(23,11)  !// Latitude dependent change of start (rate)
+    ddEGS(5)       = EMEP_PAR(24,11) 
     !//  6. Tundra
-    RgsO3(6)  = 400._r8
-    RgsSO2(6) = 500._r8
-    SAI0(6)   = 0._r8
-    VEGH(6)   = 0._r8
+    gmax(6)        = EMEP_PAR(1,12)
+    fmin(6)        = EMEP_PAR(2,12)
+    phia(6)        = EMEP_PAR(3,12)
+    phib(6)        = EMEP_PAR(4,12)
+    phic(6)        = EMEP_PAR(5,12)
+    phid(6)        = EMEP_PAR(6,12)
+    phie(6)        = EMEP_PAR(7,12)
+    phif(6)        = EMEP_PAR(8,12)
+    phiAS(6)       = EMEP_PAR(9,12)
+    phiAE(6)       = EMEP_PAR(10,12)
+    flightalpha(6) = EMEP_PAR(11,12)
+    tmin(6)        = EMEP_PAR(12,12)
+    topt(6)        = EMEP_PAR(13,12)
+    tmax(6)        = EMEP_PAR(14,12)
+    Dmax(6)        = EMEP_PAR(15,12)
+    Dmin(6)        = EMEP_PAR(16,12)
+    RgsSO2(6)      = EMEP_PAR(18,12) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(6)       = EMEP_PAR(19,12)
+    VEGH(6)        = EMEP_PAR(20,12)
+    dSGS(6)        = EMEP_PAR(21,12)  !// Start
+    dEGS(6)        = EMEP_PAR(22,12)  !// End
+    ddSGS(6)       = EMEP_PAR(23,12)  !// Latitude dependent change of start (rate)
+    ddEGS(6)       = EMEP_PAR(24,12) 
     !//  7. Desert
-    RgsO3(7)  = 2000._r8
-    RgsSO2(7) = 1000._r8
-    SAI0(7)   = 0._r8
-    VEGH(7)   = 0._r8
+    gmax(7)        = EMEP_PAR(1,13)
+    fmin(7)        = EMEP_PAR(2,13)
+    phia(7)        = EMEP_PAR(3,13)
+    phib(7)        = EMEP_PAR(4,13)
+    phic(7)        = EMEP_PAR(5,13)
+    phid(7)        = EMEP_PAR(6,13)
+    phie(7)        = EMEP_PAR(7,13)
+    phif(7)        = EMEP_PAR(8,13)
+    phiAS(7)       = EMEP_PAR(9,13)
+    phiAE(7)       = EMEP_PAR(10,13)
+    flightalpha(7) = EMEP_PAR(11,13)
+    tmin(7)        = EMEP_PAR(12,13)
+    topt(7)        = EMEP_PAR(13,13)
+    tmax(7)        = EMEP_PAR(14,13)
+    Dmax(7)        = EMEP_PAR(15,13)
+    Dmin(7)        = EMEP_PAR(16,13)
+    RgsSO2(7)      = EMEP_PAR(18,13) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(7)       = EMEP_PAR(19,13)
+    VEGH(7)        = EMEP_PAR(20,13)
+    dSGS(7)        = EMEP_PAR(21,13)  !// Start
+    dEGS(7)        = EMEP_PAR(22,13)  !// End
+    ddSGS(7)       = EMEP_PAR(23,13)  !// Latitude dependent change of start (rate)
+    ddEGS(7)       = EMEP_PAR(24,13) 
     !//  8. Water
-    RgsO3(8)  = 2000._r8
-    RgsSO2(8) = 1._r8
-    SAI0(8)   = 0._r8
-    VEGH(8)   = 0._r8
+    gmax(8)        = EMEP_PAR(1,14)
+    fmin(8)        = EMEP_PAR(2,14)
+    phia(8)        = EMEP_PAR(3,14)
+    phib(8)        = EMEP_PAR(4,14)
+    phic(8)        = EMEP_PAR(5,14)
+    phid(8)        = EMEP_PAR(6,14)
+    phie(8)        = EMEP_PAR(7,14)
+    phif(8)        = EMEP_PAR(8,14)
+    phiAS(8)       = EMEP_PAR(9,14)
+    phiAE(8)       = EMEP_PAR(10,14)
+    flightalpha(8) = EMEP_PAR(11,14)
+    tmin(8)        = EMEP_PAR(12,14)
+    topt(8)        = EMEP_PAR(13,14)
+    tmax(8)        = EMEP_PAR(14,14)
+    Dmax(8)        = EMEP_PAR(15,14)
+    Dmin(8)        = EMEP_PAR(16,14)
+    RgsSO2(8)      = EMEP_PAR(18,14) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(8)       = EMEP_PAR(19,14)
+    VEGH(8)        = EMEP_PAR(20,14)
+    dSGS(8)        = EMEP_PAR(21,14)  !// Start
+    dEGS(8)        = EMEP_PAR(22,14)  !// End
+    ddSGS(8)       = EMEP_PAR(23,14)  !// Latitude dependent change of start (rate)
+    ddEGS(8)       = EMEP_PAR(24,14)
     !//  9. Urban
-    RgsO3(9)  = 400._r8
-    RgsSO2(9) = 400._r8
-    SAI0(9)   = 0._r8
-    VEGH(9)   = 0.05_r8 !// Assumption for grass
+    gmax(9)        = EMEP_PAR(1,16)
+    fmin(9)        = EMEP_PAR(2,16)
+    phia(9)        = EMEP_PAR(3,16)
+    phib(9)        = EMEP_PAR(4,16)
+    phic(9)        = EMEP_PAR(5,16)
+    phid(9)        = EMEP_PAR(6,16)
+    phie(9)        = EMEP_PAR(7,16)
+    phif(9)        = EMEP_PAR(8,16)
+    phiAS(9)       = EMEP_PAR(9,16)
+    phiAE(9)       = EMEP_PAR(10,16)
+    flightalpha(9) = EMEP_PAR(11,16)
+    tmin(9)        = EMEP_PAR(12,16)
+    topt(9)        = EMEP_PAR(13,16)
+    tmax(9)        = EMEP_PAR(14,16)
+    Dmax(9)        = EMEP_PAR(15,16)
+    Dmin(9)        = EMEP_PAR(16,16)
+    RgsSO2(9)      = EMEP_PAR(18,16) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(9)       = EMEP_PAR(19,16)
+    VEGH(9)        = EMEP_PAR(20,16)
+    dSGS(9)        = EMEP_PAR(21,16)  !// Start
+    dEGS(9)        = EMEP_PAR(22,16)  !// End
+    ddSGS(9)       = EMEP_PAR(23,16)  !// Latitude dependent change of start (rate)
+    ddEGS(9)       = EMEP_PAR(24,16)
+    !// 10. Ice+snow treated separately; not used)
+    gmax(10)        = EMEP_PAR(1,15)
+    fmin(10)        = EMEP_PAR(2,15)
+    phia(10)        = EMEP_PAR(3,15)
+    phib(10)        = EMEP_PAR(4,15)
+    phic(10)        = EMEP_PAR(5,15)
+    phid(10)        = EMEP_PAR(6,15)
+    phie(10)        = EMEP_PAR(7,15)
+    phif(10)        = EMEP_PAR(8,15)
+    phiAS(10)       = EMEP_PAR(9,15)
+    phiAE(10)       = EMEP_PAR(10,15)
+    flightalpha(10) = EMEP_PAR(11,15)
+    tmin(10)        = EMEP_PAR(12,15)
+    topt(10)        = EMEP_PAR(13,15)
+    tmax(10)        = EMEP_PAR(14,15)
+    Dmax(10)        = EMEP_PAR(15,15)
+    Dmin(10)        = EMEP_PAR(16,15)
+    RgsSO2(10)      = EMEP_PAR(18,15) !// Will be modified below (in-canopy ok, needs EMEP2012)
+    RgsO3(10)       = EMEP_PAR(19,15)
+    VEGH(10)        = EMEP_PAR(20,15)
+    dSGS(10)        = EMEP_PAR(21,15)  !// Start
+    dEGS(10)        = EMEP_PAR(22,15)  !// End
+    ddSGS(10)       = EMEP_PAR(23,15)  !// Latitude dependent change of start (rate)
+    ddEGS(10)       = EMEP_PAR(24,15)
+    
+    !// Initialize SAI0 for all categories
+    !// Surface area index is zero for non-vegetated surfaces
+    !// Spezial treatment for crops below
+    SAI0    = 0._r8
+    !// Forests and scrubs
+    SAI0(1) = 1._r8
+    !// Wetlands
+    SAI0(5) = 1._r8
 
-    !// 10. Ice+snow treated separately (set values to zero; not used)
-    RgsO3(10)  = 0._r8 !// Not to be used
-    RgsSO2(10) = 0._r8 !// Not to be used
-    SAI0(10)   = 0._r8 !// Not to be used
-    VEGH(10)   = 0._r8 !// Not to be used
-
-
     !// Total NOPS steps used for ASN24H average
     NTOTAL = NRMETD * NROPSM
     RTOTAL = real(NTOTAL, r8)
-
+    
     !// Loop over latitude (J is global, JJ is block)
     !// ------------------------------------------------------------------
     do J = MPBLKJB(MP),MPBLKJE(MP)
       JJ    = J - MPBLKJB(MP) + 1
-
-      !// MODIFY forest vegetation height poleward of 60 latitude
-      if (YDGRD(J).ge.-60._r8 .and. YDGRD(J).le.60._r8) then
-         !// Forest vegetation height
-         VEGH(1) = 20._r8
-      else if (abs(YDGRD(J)).gt.60._r8 .and. abs(YDGRD(J)).lt.75._r8) then
-         !// From 60-75 latitude, interpolate linearly from 20m to 6m
-         VEGH(1) = (75._r8 - abs(YDGRD(J)))/15._r8 * 20._r8 &
-                   + (abs(YDGRD(J)) - 60._r8)/15._r8 * 6._r8
-      else
-         !// High-latitude forest
-         VEGH(1) = 6._r8
-      end if
-
-
-
+      
+      !// Set latitude dependent vegetation height for forests
+      !// The function is based on the latitude based modification 
+      !// north of 60deg in Simpson et al. 
+      call set_vegetation_height(tempVEGH,YDGRD(J),VEGH(1))
+      
       !// Loop over longitude (I is global, II is block)
       !// ------------------------------------------------------------------
       do I = MPBLKIB(MP),MPBLKIE(MP)
@@ -978,7 +1214,7 @@
         do NN = 1, NLCAT-1
            SAI(NN) = LAI_IJ + SAI0(NN)
         end do
-
+        
         !// MODIFY SAI for crops growth season (Eq.(61) in EMEP2012)
         !// Will have to distinguish between NH and SH
         if (YDGRD(J).gt.0._r8) then
@@ -1007,9 +1243,6 @@
            end if
         end if
 
-
-
-
         !// Meteorolgical variables (from metdata or pbl-routine)
         PrL    = PRANDTLL1(II,JJ,MP) !// Prandtl number
         !//MOL    = MO_LENGTH(II,JJ,MP) !// Obukhov lenght
@@ -1018,36 +1251,85 @@
         T2M    = SFT(I,J)            !// Surface temperature (2m) [K]
         T2Mcel = T2M - 273.15_r8     !// Surface temperature (2m) [Celcius]
         PSFC   = P(I,J)              !// Surface pressure [hPa]
-        PAR_IJ = PhotActRad(I,J)     !// Photosynthetic active radiation [W/m2]
+        PAR_IJ = PPFD(I,J)           !// Photosynthetic active radiation [W/m2]
+        SWVL1_IJ = SWVL1(I,J)        !// Soil water content in level 1 [0-1]
 
         !// Wind at L1 center
         WINDL1  = sqrt(UMS(1,I,J)*UMS(1,I,J) + VMS(1,I,J)*VMS(1,I,J))
 
         !// Temperature scaling factor for STC
-        !// Topt, Tmin and Tmax are averages of values listed in EMEP2012.
-        topt = 22._r8
-        tmin = 2._r8
-        tmax = 37._r8
-        ! or perhaps a larger range should be used (to cover more tropical temps)
-        !topt = 23._r8
-        !tmin = 2._r8
-        !tmax = 45._r8
-        if (T2Mcel .le. tmin .or. T2Mcel .ge. tmax) then
+        where (T2Mcel .le. tmin .or. T2Mcel .ge. tmax)
            !// When outside range, the equation may yield NaN, so
            !// a test is necessary. Use lower limit value.
            fstcT2 = 0.01_r8
-        else
+        elsewhere
            fstcT2 = (T2Mcel - tmin)/(topt - tmin) * &
                ((tmax - T2Mcel)/(tmax - topt))**((tmax-topt)/(topt-tmin))
-        end if
+        end where
         !// Apply lower limit value if needed
-        fstcT2 = max(0.01_r8,fstcT2)
- 
+        where (fstcT2 .lt. 0.01_r8)
+           fstcT2 = 0.01_r8
+        end where
+       
         !// Saturation partial pressure of water, Rogers and Yau, page 16
         ee = 6.112_r8*exp(17.67_r8 * T2Mcel / (T2Mcel + 243.5_r8))
         !// Use formulas in Rogers and Yau page 17
         RH = max( ee / PSFC * 100._r8, 100._r8)
+        !// Compute the vapour pressure deficit
+        VPD = ee * (1-RH/100._r8)
+        !// fD from Eq. (18) in Simpson et al. Supplement
+        fD = fmin + (1-fmin)*(Dmin-VPD)/(Dmin-Dmax)
+        !// TODO: Accumulation of water vapor deficit:
+        !// desiged to prevent afternoon gsto increasing after a period of morn-
+        !// ing water stress, as suggested by Uddling et al. (2004) and LRTAP (2009)
+        
+        fLight = 1._r8-exp(-flightalpha*PAR_IJ)
+        !fLight = 1._r8
+        !// Phenomenology from Table S17
+        !// Simpson et al. only defined it for northern hemisphere
+        !// Therefore we shall skip it for the time being
+        if (LGSMAP) then
+           call MAPPED_GROWSEASON(JDAY, I, J, GDAY, GLEN)
+        else
+           call GROWSEASON(JDAY, YDGRD(J), GDAY, GLEN)
+        end if
+        if (GDAY .eq. 0) then
+           fphen = 0._r8
+        elseif (GLEN .ge. 365) then
+           ! Exclude tropics!
+           fPhen = 1._r8
+        else
+           !fPhen = max(phia, phic)
+           where (GDAY .le. phiAS)
+              fPhen = phia
+           elsewhere (GDAY .le. phiAS+phie)
+              fPhen = phib+(phic-phib)*(GDAY-phiAS)/phie
+           elsewhere (GDAY .le. GLEN-phiAE-phif)
+              fPhen = phic
+           elsewhere (GDAY .le. GLEN-phiAE)
+              fPhen = phid+(phic-phid)*(GLEN-phiAE-GDAY)/phif
+           elsewhere
+              fPhen = phid
+           end where
+        end if
+        !// fSW based on soil moisture in the top soil layer (0-7 cm)
+        if (SWVL1_IJ .ge. 0.5) then
+           fSW = 1._r8
+        else
+           fSW = 2*SWVL1_IJ
+        end if
 
+        !// Stomatal conductance
+             
+        !// Unit conversion of [mmol s-1 m-2] to [m s-1]:
+        !// Ideal gas law Vm = V/n = R * T/P
+        !// Factor 1.d-5 derived from unit conversation:
+        !// mmol => 1.d-3 mol and 1/hPa => 1.d-2/Pa
+        !// Simpson et al. has gmax = gmaxm/41000
+        !// This can be off by +/-25%
+        gsto = gmax*fPhen*fLight*max(fmin, fstcT2*fD*fSW)
+        gsto = gsto*1.d-5*R_UNIV*T2M/PSFC
+        
         !// Fraction of water/ocean in gridbox
         !// Not used, will be set below.
         !focean = max(0._r8, 1._r8 - PLAND(I,J))
@@ -1093,7 +1375,7 @@
         !// Set land fractions
         call landfrac2emep(FL,NLCAT,landSurfTypeFrac(:,I,J), &
              NVGPAR, YDGRD(J), LANDUSE_IDX)
-
+        
         !// LAI:    Leaf area index (monthly means)
         !// STC:    Stomatal conductance (monthly means)
         !// Rinc:   In-canopy resistance
@@ -1103,30 +1385,11 @@
         !// VEG_H:  Vegetation height (needed to get Rinc)
 
 
-        !// Sum up conductances from MEGAN
-        stc_avg = 0._r8
-        !// Skip barren land.
-        do NN = 1, NVGPAR - 1
-           if (StomRes(NN,I,J) .gt. 0._r8) &
-                stc_avg = stc_avg &
-                        + landSurfTypeFrac(NN,I,J) / StomRes(NN,I,J)
-        end do
-
-
-        !// Use monthly STC weighted by vegetated fraction?
-        !stc_avg = 0._r8
-        !do NN = 1, NVGPAR-1
-        !   stc_avg = stc_avg + STC(I,J,JMON) * landSurfTypeFrac(NN,I,J)
-        !end do
-
-        !// Set up total/averag parameters based on landSurfTypeFrac
-        !// ----------------------------------------------------------------
-        !// Average SAI is not needed, but can be calculated as
-        !SAIavg = SAI(NN) * FL(1)
-        !do NN = 2, NLCAT-1
-        !   SAIavg = SAIavg + SAI(NN) * FL(NN)
-        !end do
-
+        !// Compute the grid-cell-average stomatal conductance
+        !// Devide by sum(FL) to be sure that it is normalized!
+        !// Skip barren land (same as gmax=0 in EMEP.par)
+        Gstc_avg = sum(FL*gsto)/sum(FL)
+                        
         !// Rinc = In-canopy resistance = (SAI * VEGH) *  14/Ustar
         do NN = 1, NLCAT-1
            Rinc(NN) = SAI(NN) * VEGH(NN) * 14._r8 / USR
@@ -1187,8 +1450,6 @@
 
         !// No need to make a gridbox average fsnow
 
-
-
         !// Aerodynamic resistance (Ra)
         !// ----------------------------------------------------------------
         !// Ra can be defined for heat or moisture.
@@ -1294,9 +1555,6 @@
 
         end do !// do N = 1, nddep
 
-
-
-
         !// Surface (or canopy) resistance (Rc)
         !// ----------------------------------------------------------------
         !// Rc is in general calculated as in EMEP2012.
@@ -1351,7 +1609,7 @@
         !// SO2 has a smaller resistance which is temperature dependent.
         !// Both are according to EMEP2012.
         !// Rsnow will only be used if snow cover fsnowC(NN)>0
-        RsnowO3 = 2000._r8
+        RsnowO3 = RgsO3(10)
         if (T2Mcel .ge. 1._r8) then
            RsnowSO2 = 70._r8
         else if (T2Mcel .ge. -1._r8) then
@@ -1422,9 +1680,6 @@
         !// it could be the vegetated surfaces or total gridbox. I think
         !// our RgsO3 are large enough in any case, so we skip this.
 
-
-
-
         !// Stomatal part of canopy conductance - Ozone
         !// -------------------------------------------
         !// As defined above, this is given by LAI * gsto.
@@ -1433,49 +1688,14 @@
         !// conductance from leaf stomatal contuctance, where gsto is the
         !// latter.
 
-        !// gsto is estimated in MEGAN, for each vegetation type, and
-        !// above the average conductance stc_avg was calculated.
+        !// gsto is estimated in EMEP parameterization, for each vegetation type, and
+        !// above the average conductance Gstc_avg was calculated from this.
         !// The estimated canopy stomatal conductance is then:
-        GstO3 = LAI_IJ * stc_avg
+        !//GstO3 = LAI_IJ * Gstc_avg
         !// where the vegetation fractions are taken into account.
         !//
-        !// For instantaneous stc_avg (from MEGAN), it is possible that the
-        !// a temperature scaling should be added.
-        !// The temperature scaling should be different for different canopy,
-        !// but I have only included one so far:
-        GstO3 = GstO3 * fstcT2
-
-        !// What I proposed earlier is
-        !// GstO3 = LAI_IJ * STC(I,J,JMON)
-        !// but the values of STC indicates that it is already a canopy conductance,
-        !// so it should perhaps not be scaled by LAI. Also, it should probably
-        !// be scaled by the vegetation fraction of the grid box (calculate
-        !// this above):
-        !GstO3 = stc_avg
+        GstO3 = LAI_IJ*Gstc_avg
         !//
-        !// To include a diurnal and daily variation on the prescribed
-        !// monthly mean STC, we use sunlight using photsynthetic active
-        !// radiation (PAR) and 2m temperature from metdata.
-        !//
-        !// In my first version, I scaled PAR with the monthly average PAR,
-        !// because I thouht STC at daytime should be higher than the monthly
-        !// average. This gives too much deposition. Perhaps removing LAI from
-        !// the GstO3 could help, but I would rather suggest another approach:
-        !//
-        !// A monthly value should be limited to a certain value:
-        !GstO3 = GstO3 * min(1._r8, PAR_IJ / 500._r8) * fstcT2
-        !// rather than my old approach:
-        !if (PAR_IJ .gt. 30._r8) then
-        !   if (PARMEAN(I,J,JMON) .gt. 0._r8) then
-        !      GstO3 = GstO3 * PAR_IJ*fstcT2 / PARMEAN(I,J,JMON)
-        !   else
-        !      GstO3 = 0._r8 !// No sunlight (e.g. polar night)
-        !   end if
-        !else
-        !   GstO3 = 0._r8
-        !end if
-
-
         !// Total canopy conductance for O3
         GcO3 = GstO3 + GnsO3
         !// Total canopy resistance for O3
@@ -1491,11 +1711,11 @@
            end do
            stop
         end if
+        
 
 
 
 
-
         !// Non-stomatal conductance Gns - SO2
         !// ----------------------------------
 
@@ -1679,7 +1899,7 @@
            Tot_res = Ra + Rb(KK) + Rc(KK)
            if (Tot_res .ne. Tot_res) then
               write(6,'(a,i3,3es9.3)') f90file//':'//subr// &
-                   ': Tota resistance is NAN!', KK,Ra,Rb(KK),Rc(KK)
+                   ': Total resistance is NAN!', KK,Ra,Rb(KK),Rc(KK)
               stop
            end if
  
@@ -1707,8 +1927,13 @@
         VPAN(II,JJ)    = VD(8)
         VNO2(II,JJ)    = VD(9)
         VNH3(II,JJ)    = VD(14)
-
-      end do !// do I = MPBLKIB(MP),MPBLKIE(MP)
+        !//Leaf level stomatal conductance
+        !//It is, however, not clear whether canopy conductance (GstO3) 
+        !//should be used here (Emberson et al. 2000).
+        !//Multiply with ozone concentration yields stomatal flux.
+        !//unit [mmol m-2s-1]
+        VSto(II,JJ)    = Gstc_avg/(1.d-5*R_UNIV*T2M/PSFC)
+     end do !// do I = MPBLKIB(MP),MPBLKIE(MP)
     end do !// do J = MPBLKJB(MP),MPBLKJE(MP)
 
     !// --------------------------------------------------------------------
@@ -1853,8 +2078,99 @@
   end subroutine get_STC
   !// ----------------------------------------------------------------------
 
+  !// ----------------------------------------------------------------------
+  subroutine get_PPFD(NMET, DTMET)
+    !// --------------------------------------------------------------------
+    !// Read photsynthetic photon flux density (PPFD) from file.
+    !// PPFD is deaccumulated PAR from OpenIFS data.
+    !// Called from update_drydepvariables.
+    !//
+    !// Stefanie Falk, July 2018
+    !// --------------------------------------------------------------------
+    use cmn_precision, only: r8, r4
+    use cmn_ctm, only: JYEAR, JMON, JDAY, JDATE, NRMETD, &
+         ZDEGI, ZDEGJ, IMAP, JMAP
+    use cmn_size, only: IPARW, JPARW, &
+         IPAR, JPAR, IDGRD, JDGRD
+    use cmn_met, only: PPFD, PPFDPATH, PPFDFILE, MYEAR, metTYPE
+    use regridding, only: TRUNG8
+    use ncutils, only: get_netcdf_var_2d, get_netcdf_var_3d
+    !//---------------------------------------------------------------------
+    implicit none
+    !//---------------------------------------------------------------------
+    !// Input
+    integer, intent(in) :: NMET       ! the meteorological timestep
+    real(r8), intent(in) :: DTMET     ! meteorological time step [s]
+    !//---------------------------------------------------------------------
+    logical, parameter :: VERBOSE = .false.
+    !// Local parameters
+    real(r8) :: ZDT
+    !// To be read from file
+    logical :: fex
+    !// Filename for metdata
+    character(len=160) :: FNAME, FNAME_NEXT
+    character(len=2) :: CMON, CDATE, CUTC
+    character(len=4) :: MPATH2
+    integer :: NMET_NEXT
 
+    !//---------------------------------------------------------------------
+    !// Allocatable arrays - double precision
+    real(r8), dimension(:,:), allocatable :: W2D, R8XY
+        
+    !// --------------------------------------------------------------------
+    character(len=*), parameter :: subr = 'get_PPFD'
+    !//---------------------------------------------------------------------
+ 
+    !// Allocate 2D arrays - native resolution
+    allocate( W2D(IPARW,JPARW) )
+    !// Allocate 2D arrays - window resolution (IPAR/JPAR)
+    allocate( R8XY(IPAR,JPAR) )
+
+    !// File name for this DAY/NMET
+    write(CUTC(1:2),'(i2.2)') (NMET - 1) * 24/NRMETD  ! Time UTC
+    write(CDATE(1:2),'(i2.2)') JDATE                  ! Date
+    write(CMON(1:2),'(i2.2)') JMON                    ! Month
+    write(MPATH2(1:4),'(i4.4)') MYEAR                 ! Year
+
+    if (trim(metTYPE) .eq. 'ECMWF_oIFSnc4') then
+       !// ECMWF Open IFS netcdf4 file
+       !// Date yYYYYmMMdDDhHH
+       !// Filename: ECopenIFSc38r1_yYYYYmMMdDDhHH_T159N80L60.nc
+       write(PPFDFILE(16:29),'(a1,i4.4,a1,i2.2,a1,a2,a1,a2)') &
+            'y',MYEAR,'m',JMON,'d',CDATE,'h',CUTC
+
+       FNAME  = trim(PPFDPATH)//trim(MPATH2)//'/'//CMON//'/'// &
+            trim(PPFDFILE)//'.nc'
+    else
+       write(6,'(a)') f90file//':'//subr// &
+            ': Not set up for metTYPE: '//trim(metTYPE)
+       if (trim(metTYPE) .eq. 'ECMWF_oIFS') then
+          write(6,'(a)') '* If you do not want netcdf4 files, you '// &
+               'should use metdata_ecmwf_uioformat.f90 instead'
+       end if
+       stop
+    end if
+
+    !// Check if files exist
+    inquire(FILE=trim(FNAME), exist=fex)
+    if (.not. fex) then
+       write(6,'(a)') f90file//':'//subr// &
+            ': No such file: '//trim(FNAME)
+       stop
+    end if
+    !// Photosynthetically active radiation @ sfc (PhotActRad) (accumulated)
+    !// --------------------------------------------------------------------
+    !// Unit: (W/m2)*s, accumulated. Divide by ZDT to get W/m2.
+    call get_netcdf_var_2d(FNAME, 'PPFD',W2D, IPARW, JPARW)
+    call TRUNG8(W2D, R8XY, ZDEGI, ZDEGJ, IMAP, JMAP, IDGRD, &
+         JDGRD, IPARW, JPARW, IPAR, JPAR, 1, 1)
+    PPFD(:,:) = max(0._r8, R8XY(:,:))  !// Limit to positive values (* ZDT)
+    if (verbose) call gotData('2da','Photosyn. Photon flux dens. (PPFD)')
+    !// --------------------------------------------------------------------
+  end subroutine get_PPFD
   !// ----------------------------------------------------------------------
+
+  !// ----------------------------------------------------------------------
   subroutine get_PARMEAN()
     !// --------------------------------------------------------------------
     !// Read monthly averaged photsynthetic active radiation (PAR) from file.
@@ -2078,7 +2394,7 @@
     use cmn_sfc, only: landSurfTypeFrac, LANDUSE_IDX, NVGPAR, LAI
     use cmn_oslo, only: trsp_idx
     use soa_oslo, only: ndep_soa, soa_deps
-    use utilities_oslo, only: landfrac2emep
+    use utilities_oslo, only: landfrac2emep, set_vegetation_height
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -2092,7 +2408,7 @@
     integer :: I,II,J,JJ,N, K, NN
     real(r8) :: SAI1, MOL, USR, RAIN, T2M, &
          a1L, a1W, a1I, a1Lfor, amol, amolN, Vtot, WETFRAC, fice, snowD
-
+    real(r8) :: tempVEGH
     integer, parameter :: NLCAT=10
     real(r8),dimension(NLCAT) :: FL, VD, VEGH, fsnowC
 
@@ -2118,35 +2434,25 @@
     !//  9. Urban
     !// 10. Ice+snow (strictly, EMEP has this as category 9 and urban as 10)
     !// Vegetation heights
-    VEGH(1)   = 20._r8
-    VEGH(2)   = 0.4_r8
-    VEGH(3)   = 0.7_r8
-    VEGH(4)   = 0.4_r8
-    VEGH(5)   = 0.5_r8
-    VEGH(6)   = 0._r8
-    VEGH(7)   = 0._r8
-    VEGH(8)   = 0._r8
-    VEGH(9)   = 0.05_r8
-    VEGH(10)  = 0._r8
+    VEGH(1)  = 0._r8  !// Will be modified below 
+    tempVEGH = (sum(EMEP_PAR(20,1:4))+EMEP_PAR(20,10))/5._r8 
+    VEGH(2)  = sum(EMEP_PAR(20,5:7))/3._r8
+    VEGH(3)  = EMEP_PAR(20,8)
+    VEGH(4)  = EMEP_PAR(20,9)
+    VEGH(5)  = EMEP_PAR(20,11)
+    VEGH(6)  = EMEP_PAR(20,12)
+    VEGH(7)  = EMEP_PAR(20,13)
+    VEGH(8)  = EMEP_PAR(20,14)
+    VEGH(9)  = EMEP_PAR(20,16)
+    VEGH(10) = 0._r8
 
-
     !// Loop over latitude (J is global, JJ is block)
     do J = MPBLKJB(MP),MPBLKJE(MP)
       JJ    = J - MPBLKJB(MP) + 1
-
-      !// MODIFY forest vegetation height poleward of 60 latitude
-      if (YDGRD(J).ge.-60._r8 .and. YDGRD(J).le.60._r8) then
-         !// Forest vegetation height
-         VEGH(1) = 20._r8
-      else if (abs(YDGRD(J)).gt.60._r8 .and. abs(YDGRD(J)).lt.75._r8) then
-         !// From 60-75 latitude, interpolate linearly from 20m to 6m
-         VEGH(1) = (75._r8 - abs(YDGRD(J)))/15._r8 * 20._r8 &
-                   + (abs(YDGRD(J)) - 60._r8)/15._r8 * 6._r8
-      else
-         !// High-latitude forest
-         VEGH(1) = 6._r8
-      end if
-
+      
+      !// Set latitude dependent vegetation height for forests
+      call set_vegetation_height(tempVEGH,YDGRD(J),VEGH(1))
+      
       !// Loop over longitude (I is global, II is block)
       do I = MPBLKIB(MP),MPBLKIE(MP)
         II    = I - MPBLKIB(MP) + 1
Index: OSLO/gmdump3hrs.f90
===================================================================
--- OSLO/gmdump3hrs.f90	(.../ctm3f90)	(revision 243)
+++ OSLO/gmdump3hrs.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -14,21 +14,19 @@
   !// Ole Amund Sovde, June 2012
   !// ----------------------------------------------------------------------
   use cmn_size, only: NPAR
+  use cmn_ctm, only: LDUMP3HRS
   !// ----------------------------------------------------------------------
   implicit none
   !// ----------------------------------------------------------------------
 
-  !// Switch for dumping every 3 hours or not
-  logical, parameter :: LDUMP3HRS = .false.
-
   !// List of tracers to put out
-  integer, parameter :: trp_nr = 1, sul_nr = 2, slt_nr = 8, min_nr = 8, &
+  integer, parameter :: trp_nr = 7, sul_nr = 3, slt_nr = 8, min_nr = 8, &
        nit_nr = 5, bio_nr = 4, moa_nr=2, ffc_nr = 4, bfc_nr = 4, &
        soa_ant_nr = 17, soa_nat_nr = 4
   integer, parameter,dimension(trp_nr) :: &
-       trp_list = (/ 1 /)
+       trp_list = (/ 1, 6, 46, 41, 42, 43, 44 /)
   integer, parameter,dimension(sul_nr) :: &
-       sul_list = (/ 71, 72 /)
+       sul_list = (/ 71, 72, 73 /)
   integer, parameter,dimension(slt_nr) :: &
        slt_list = (/ 201, 202, 203, 204, 205, 206, 207, 208 /)
   integer, parameter,dimension(min_nr) :: &
@@ -71,7 +69,7 @@
     use cmn_precision, only: r8
     use cmn_size, only: IPAR,JPAR, LPAR, LOSLOCTROP, LSULPHUR, LSALT, &
          LDUST, LNITRATE, LBCOC, LSOA, TRACER_ID_MAX
-    use cmn_ctm, only: STT, AIR, JYEAR
+    use cmn_ctm, only: STT, AIR, JYEAR, JMON, JDATE
     use cmn_chem, only: TNAME
     use cmn_oslo, only: trsp_idx
     !// --------------------------------------------------------------------
@@ -83,9 +81,10 @@
 
     !// Locals
     real(r8) :: TMPFIELD(IPAR,JPAR,LPAR,2)
-    character(len=3) :: cday
-    character(len=4) :: cyear
-    character(len=14) :: ncfilename
+    character(len=3)  :: cday                            !Char of day of year
+    character(len=4)  :: cyear                           !Char of year
+    character(len=14) :: ncfilename                      !Output filename
+    character(len=80) :: time_label                      !Time label or unit
     character(len=10) :: tmpname
     integer :: N,sl
 
@@ -94,7 +93,7 @@
     !// --------------------------------------------------------------------
 
     !// Check whether to do dump or not
-    if (.not.LDUMP3HRS) return
+    if (.not.LDUMP3HRS(1)) return
 
     !// Initialize
     If ((NDAY.eq.NDAYI).AND.(NMET.eq.1)) Then
@@ -141,73 +140,84 @@
     write(cyear,'(i4.4)') JYEAR
     write(cday,'(i3.3)') NDAY
 
+    !// String for time label
+    time_label='hours since yyyy-mm-dd 00:00:00'
+       write(time_label(13:23),'(i4.4,a1,i2.2,a1,i2.2)') &
+            JYEAR,'-',JMON,'-',JDATE
 
     !// Output of air density
     !// All variables will be divided by volume in gm_dump_nc, so we
     !// send in air mass (AIR).
-    ncfilename = 'air'//cyear//'_'//cday//'.nc'
-    TMPFIELD(:,:,:,1) = AIR(:,:,:)
-    call gm_dump_nc(1, 'AIRdnsty  ', TMPFIELD(:,:,:,1), 1, (/1/), &
-         NMET, 1, (/1/), ncfilename)
+    if(LDUMP3HRS(2)) then
+       ncfilename = 'air'//cyear//'_'//cday//'.nc'
+       TMPFIELD(:,:,:,1) = AIR(:,:,:)
+       call gm_dump_nc(1, 'AIRdnsty  ', TMPFIELD(:,:,:,1), 1, (/1/), &
+            NMET, 1, (/1/), time_label, ncfilename)
+    end if
 
-    if (LOSLOCTROP) then
+    if (LOSLOCTROP .and. LDUMP3HRS(3)) then
        !// Output of selected tropospheric tracers + air (netCDF)
        ncfilename = 'trp'//cyear//'_'//cday//'.nc'
        call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, trp_nr, TRP_LIST, ncfilename)
+            NMET, trp_nr, TRP_LIST, time_label, ncfilename)
     end if
 
-    if (LSULPHUR) then
+    if (LSULPHUR .and. LDUMP3HRS(4)) then
        !// Output of sulphur
        ncfilename = 'sul'//cyear//'_'//cday//'.nc'
        call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, sul_nr, SUL_LIST, ncfilename)
+            NMET, sul_nr, SUL_LIST, time_label, ncfilename)
     end if
 
-    if (LSALT) then
+    if (LSALT .and. LDUMP3HRS(5)) then
        !// Output of salt
        ncfilename = 'slt'//cyear//'_'//cday//'.nc'
        call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, slt_nr, SLT_LIST, ncfilename)
+            NMET, slt_nr, SLT_LIST, time_label, ncfilename)
     end if
 
-    if (LDUST) then
+    if (LDUST .and. LDUMP3HRS(6)) then
        !// Output of dust
        ncfilename = 'min'//cyear//'_'//cday//'.nc'
        call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, min_nr, MIN_LIST, ncfilename)
+            NMET, min_nr, MIN_LIST, time_label, ncfilename)
     end if
 
-    if (LNITRATE) then
+    if (LNITRATE .and. LDUMP3HRS(7)) then
        !// Output of nitrate
        ncfilename = 'snn'//cyear//'_'//cday//'.nc'
        call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, nit_nr, SNN_LIST, ncfilename)
+            NMET, nit_nr, SNN_LIST, time_label, ncfilename)
     end if
 
     if (LBCOC) then
        !// Output of bio BC/OC
-       ncfilename = 'bio'//cyear//'_'//cday//'.nc'
-       call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, bio_nr, BIO_LIST, ncfilename)
-
-       ncfilename = 'moa'//cyear//'_'//cday//'.nc'
-       call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, moa_nr, MOA_LIST, ncfilename)
-
+       if (LDUMP3HRS(8)) then
+          ncfilename = 'bio'//cyear//'_'//cday//'.nc'
+          call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
+               NMET, bio_nr, BIO_LIST, time_label, ncfilename)
+       end if
+       if (LDUMP3HRS(9)) then
+          ncfilename = 'moa'//cyear//'_'//cday//'.nc'
+          call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
+               NMET, moa_nr, MOA_LIST, time_label, ncfilename)
+       end if
        !// Output of fossil fuel BC/OC
-       ncfilename = 'ffc'//cyear//'_'//cday//'.nc'
-       call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, ffc_nr, FFC_LIST, ncfilename)
-
+       if (LDUMP3HRS(10)) then
+          ncfilename = 'ffc'//cyear//'_'//cday//'.nc'
+          call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
+               NMET, ffc_nr, FFC_LIST, time_label, ncfilename)
+       end if
        !// Output of fossil fuel BC/OC
-       ncfilename = 'bfc'//cyear//'_'//cday//'.nc'
-       call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
-            NMET, bfc_nr, BFC_LIST, ncfilename)
+       if (LDUMP3HRS(11)) then
+          ncfilename = 'bfc'//cyear//'_'//cday//'.nc'
+          call gm_dump_nc(NPAR, GMNAME, STT, TRACER_ID_MAX, trsp_idx, &
+               NMET, bfc_nr, BFC_LIST, time_label, ncfilename)
+       end if
     end if
 
     !// Output of SOA (only total)
-    if (LSOA) then
+    if (LSOA .and. LDUMP3HRS(12)) then
        !// SOA - ANT
        TMPFIELD(:,:,:,1) = STT(:,:,:,trsp_idx(soa_ant_list(1)))
        do N = 2, soa_ant_nr
@@ -224,9 +234,10 @@
 
        ncfilename = 'soa'//cyear//'_'//cday//'.nc'
        call gm_dump_nc(2, (/'SOAANT    ','SOANAT    '/), TMPFIELD, 2, (/1,2/), &
-            NMET, 2, (/1,2/), ncfilename)
+            NMET, 2, (/1,2/), time_label, ncfilename)
 
     end if
+
     !// --------------------------------------------------------------------
   end subroutine dump3hrs
   !// ----------------------------------------------------------------------
@@ -243,6 +254,7 @@
        nbr_steps,   & !I Counter for netCDF timestep (i.e. NMET)
        NCOMP,       & !I Number of compenents to put out (size of ICOMP_LIST)
        ICOMP_LIST,  & !I Array with component names to dump
+       time_label,  & !I Correct time label (hours since yyyy-mm-dd 00:00:00)
        filename)      !I Name of file (minYYYY_DDD.nc)
     !// --------------------------------------------------------------------
     !// Purpose: Write data to netcdf output file.
@@ -266,16 +278,16 @@
     !// MTC_IN may differ from MTC
     !// STT_IN may differ from STT
     !// 
-    integer, intent(in)          :: NPAR_IN    !Number of components
-    character(len=10),intent(in) :: TNAME_IN(NPAR_IN) !Tracer names
-    real(r8), intent(in) :: STT_IN(IPAR,JPAR,LPAR,NPAR_IN)  !4-D fields
-    integer, intent(in)  :: NCOMP              !Number of components in list
-    integer, intent(in)  :: ICOMP_LIST(NCOMP)  !Numbers of comps to put out
-    integer, intent(in)  :: IREPMX             !Number of species in MTC_IN
-    integer,intent(in)   :: MTC_IN(IREPMX)     !Comp.order (not necessarily MTC)
-    character(len=*),intent(in) :: filename    !Name of file (minYYYY_DDD.nc)
-    integer, intent(in)  :: nbr_steps          !Step number
-
+    integer, intent(in)           :: NPAR_IN                         !Number of components
+    character(len=10),intent(in)  :: TNAME_IN(NPAR_IN)               !Tracer names
+    real(r8), intent(in)          :: STT_IN(IPAR,JPAR,LPAR,NPAR_IN)  !4-D fields
+    integer, intent(in)           :: NCOMP                           !Number of components in list
+    integer, intent(in)           :: ICOMP_LIST(NCOMP)               !Numbers of comps to put out
+    integer, intent(in)           :: IREPMX                          !Number of species in MTC_IN
+    integer,intent(in)            :: MTC_IN(IREPMX)                  !Comp.order (not necessarily MTC)
+    character(len=*),intent(in)   :: filename                        !Name of file (minYYYY_DDD.nc)
+    integer, intent(in)           :: nbr_steps                       !Step number
+    character(len=80), intent(in) :: time_label                      !Time label or unit
     !// Output
     !// No output from this file
   
@@ -299,7 +311,6 @@
     real(r8)                :: rtcdmp(IPAR,JPAR,LPAR)          !3D field to dump to file
     character(len=10)       :: TCNAME_AVG(NPAR_IN)             !Tracer name in the order not following MTC
     real(r8)                :: time                            !Time steps
-    character(len=80)       :: time_label                      !Time label or unit
     integer                 :: time_dim_id                     !Dimension id for time
     integer                 :: time_id                         !Variable id for time
     integer                 :: TCINFO(NPAR_IN,2)               !Tracer info (compno,dim_id,comp_id)
@@ -394,11 +405,10 @@
        status = nf90_put_att(ncid,lev_id,'units','mb')
        if (status/=nf90_noerr) call handle_error(status,'attribute units lev')
 
-       time_label='hours since 00:00:00'
-       !write(6,*)'time_label: ',trim(time_label)
-
+       !// Putting attributes to time variable
        status = nf90_put_att(ncid,time_id,'units',time_label)
-       if (status/=nf90_noerr) call handle_error(status,'attribute units time')
+       if (status/=nf90_noerr) call handle_error(status,&
+            f90file//':'//subr//':attribute units time')
        
        !// Define the tracer field variables
        DO N = 1, NCOMP
Index: cmn_ctm.f90
===================================================================
--- cmn_ctm.f90	(.../ctm3f90)	(revision 243)
+++ cmn_ctm.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -164,14 +164,21 @@
   logical :: LYEAR   ! Actual flag for when a year is leap year
   logical :: LFIXMET ! Recycle meteorological year
   logical :: LCONT   ! Continue from restart file
+  logical :: LNCR    ! Switch between old (.sav) and new (.nc) restart files
   integer :: START_AVG  !// For init when LCONT=F (0:zero, 1: avgsav file)
 
   integer :: IDTLN   ! dateline index
   integer :: NSCX    ! Scavenging scheme
   integer :: NDPX    ! Deposition scheme
   integer :: NBLX    ! Boundary layer mixing scheme
-
-
+  
+  !// Diagnostic output
+  !//-----------------------------------------------------------------------
+  logical, dimension(12) :: LDUMP3HRS ! Switch on 3 hourly output of defined tracers
+  logical :: LSTOM1HRS ! Switch on 1 hourly output of GstO3 and FstO3
+  ! Switch on daily total/2d scavening output channels (burden, large-scale,...)
+  logical, dimension(7) :: LDLYSCAV  
+  
   !// OpenMP Blocks  (MPBLK: total number of OpenMP blocks)
   !//-----------------------------------------------------------------------
   integer, dimension(MPBLK) :: &
Index: Makefile
===================================================================
--- Makefile	(.../ctm3f90)	(revision 243)
+++ Makefile	(.../branches/brOzoNorClim)	(revision 243)
@@ -158,16 +158,16 @@
 FREEFLAGS  = -free
 #
 # intel version 10-15
-#STDOPTS= -auto -fpp -mcmodel=large -shared-intel -mp1 -module $(MY_MOD_DIR)
-#FCOPT  = -inline-forceinline -ip -O2 -openmp -ftz -fno-alias -fomit-frame-pointer
-#FCAGR  = -inline-forceinline -ip -O3 -openmp -ftz -fno-alias -fomit-frame-pointer
-#DEBUG  = -check bounds -check uninit -traceback -openmp -g
+STDOPTS= -auto -fpp -mcmodel=large -shared-intel -mp1 -module $(MY_MOD_DIR)
+FCOPT  = -inline-forceinline -ip -O2 -openmp -ftz -fno-alias -fomit-frame-pointer
+FCAGR  = -inline-forceinline -ip -O3 -openmp -ftz -fno-alias -fomit-frame-pointer
+DEBUG  = -check bounds -check uninit -traceback -openmp -g
 #
 # intel version >= 17
-STDOPTS= -auto -fpp -mcmodel=large -shared-intel -mp1 -module $(MY_MOD_DIR)
-FCOPT  = -inline-forceinline -ip -O2 -qopenmp -ftz -fno-alias -fomit-frame-pointer
-FCAGR  = -inline-forceinline -ip -O3 -qopenmp -ftz -fno-alias -fomit-frame-pointer
-DEBUG  = -check bounds -check uninit -traceback -qopenmp -g
+#STDOPTS= -auto -fpp -mcmodel=large -shared-intel -mp1 -module $(MY_MOD_DIR)
+#FCOPT  = -inline-forceinline -ip -O2 -qopenmp -ftz -fno-alias -fomit-frame-pointer
+#FCAGR  = -inline-forceinline -ip -O3 -qopenmp -ftz -fno-alias -fomit-frame-pointer
+#DEBUG  = -check bounds -check uninit -traceback -qopenmp -g
 #
 #Special x86_64 options:
 ifneq ($(null),$(findstring _64,$(UNAMEM)))
Index: lightning.f90
===================================================================
--- lightning.f90	(.../ctm3f90)	(revision 243)
+++ lightning.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -10,7 +10,7 @@
   !// MODULE: lightning
   !// DESCRIPTION: Module conatining routines to calculate lightning NOx
   !//              emissions. Several options are available; from the first
-  !//              CTM3 version (GMD2012) as described by Sovde et al. (2012,
+  !//              CTM3 version (GMD2012) as described by Svde et al. (2012,
   !//              GMD, doi:10.5194/gmd-7-175-2014) to the UCI2015 version
   !//              (not documented yet).
   !//
@@ -31,11 +31,6 @@
   !//   - subroutine LIGHTNING_ALLEN2002
   !//   - subroutine LIGHTDIST
   !//
-  !// Amund Sovde Haslerud, February 2018
-  !//   Slight update; Using CLM vegetation, instead of MODIS, the
-  !//   scaling factors must be updated: MODIS water also covers
-  !//   fresh water, and should probably not be included for
-  !//   lightning considerations.
   !// Ole Amund Sovde, March 2015, November 2014, August 2011
   !// ----------------------------------------------------------------------
   use cmn_precision, only: r8, r4
@@ -71,8 +66,8 @@
 
   !// Seconds in a year
   real(r8), parameter :: dtyear = secYear
-  !// Flag to turn on flashrate file production (lightning_YYYYMMDD.nc)
-  logical, parameter :: getFlashFiles = .true.
+  !// Flag to turn on flashrate.dta production
+  logical, parameter :: getFlashFiles = .false.
   !// ----------------------------------------------------------------------
   character(len=*), parameter, private :: f90file = 'lightning.f90'
   !// ----------------------------------------------------------------------
@@ -102,7 +97,6 @@
     !// --------------------------------------------------------------------
     use cmn_size, only: IPARW, IDGRD
     use cmn_met, only: metTYPE, metCYCLE, metREVNR
-    use cmn_sfc, only: LANDUSE_IDX
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
@@ -117,13 +111,9 @@
     real(r8), parameter :: Lecmwf_ifs_c36r1_T159 = 7.061138e-17_r8
 
     !// ECMWF oIFS cy38r1
-    real(r8) :: Oecmwf_oifs_c38r1_T159, Lecmwf_oifs_c38r1_T159
-    !// T159L60: 1995 - 2005 (MODIS vegetation)
-    real(r8), parameter :: Oecmwf_oifs_c38r1_T159_MODPFT = 4.012695e-14_r8
-    real(r8), parameter :: Lecmwf_oifs_c38r1_T159_MODPFT = 9.542578e-17_r8
-    !// Using CLM PFTs to calculate PLAND (1995-2005)
-    real(r8), parameter :: Oecmwf_oifs_c38r1_T159_CLMPFT = 4.328769e-14_r8
-    real(r8), parameter :: Lecmwf_oifs_c38r1_T159_CLMPFT = 7.910481e-17_r8
+    !// T159L60: 1995 - 2005
+    real(r8), parameter :: Oecmwf_oifs_c38r1_T159 = 4.012695e-14_r8
+    real(r8), parameter :: Lecmwf_oifs_c38r1_T159 = 9.542578e-17_r8
     !// --------------------------------------------------------------------
     character(len=*), parameter :: subr = 'getScaleFactors'
     !// --------------------------------------------------------------------
@@ -198,27 +188,12 @@
        !// ECMWF OpenIFS
        if (metCYCLE .eq. 38 .and. metREVNR .eq. 1) then
           !// Cycle 38r1
-          if (LANDUSE_IDX .eq. 2) then
-             Oecmwf_oifs_c38r1_T159 = Oecmwf_oifs_c38r1_T159_MODPFT
-             Lecmwf_oifs_c38r1_T159 = Lecmwf_oifs_c38r1_T159_MODPFT
-          else if(LANDUSE_IDX .eq. 3) then
-             Oecmwf_oifs_c38r1_T159 = Oecmwf_oifs_c38r1_T159_CLMPFT
-             Lecmwf_oifs_c38r1_T159 = Lecmwf_oifs_c38r1_T159_CLMPFT
-          else
-             write(6,'(a,2i7)') f90file//':'//subr// &
-                  ': LANDUSE_IDS is unknown: ',LANDUSE_IDX
-             stop 'STOP in '//subr
-          end if
-
           if (IPARW .eq. 320) then
              if (IDGRD .eq. 1) then
                 scaleOcean = Oecmwf_oifs_c38r1_T159
                 scaleLand  = Lecmwf_oifs_c38r1_T159
              else if (IDGRD .eq. 2) then
                 !// Scaling factors based on cy38r1 2005 meteorology
-                !// With CLM4-PFT, it is close to MODIS PFT,
-                !// 2.335421/2.028930 vs 2.319733/2.041230, so we
-                !// keep MODIS-factors.
                 scaleOcean = Oecmwf_oifs_c38r1_T159 * 2.319733_r8
                 scaleLand  = Lecmwf_oifs_c38r1_T159 * 2.041230_r8
              else if (IDGRD .eq. 4) then
@@ -290,7 +265,7 @@
 
 
   !// ----------------------------------------------------------------------
-  subroutine LIGHTNING_OAS2015(NDAY,NDAYI,dt_met,LNEW_MONTH,NMET)
+  subroutine LIGHTNING_OAS2015(NDAY,NDAYI,dt_met,LNEW_MONTH)
     !// --------------------------------------------------------------------
     !// Lightning NOx
     !//
@@ -301,19 +276,17 @@
     !//
     !// Ole Amund Sovde, March 2015
     !// --------------------------------------------------------------------
-    use cmn_size, only: IPARW,IPAR,JPAR,LPAR,LPARW, LWEPAR, IDGRD,NRMETD
+    use cmn_size, only: IPARW,IPAR,JPAR,LPAR,LPARW, LWEPAR, IDGRD
     use cmn_ctm, only: ETAA, ETAB, XDGRD, YDGRD, XDEDG, YDEDG, &
-         AREAXY, PLAND, JMON,JDATE,JYEAR
+         AREAXY, PLAND
     use cmn_chem, only: NEMLIT, LITSRC, LITFAC
     use cmn_met, only: CWETE, CENTU, ZOFLE, T, PRECCNV, P
     use utilities, only: get_free_fileid
-    use netcdf
-    use ncutils, only: handle_error
     !// --------------------------------------------------------------------
     implicit none
     !// --------------------------------------------------------------------
     !// Input / Output
-    integer, intent(in) :: NDAY, NDAYI, NMET
+    integer, intent(in) :: NDAY, NDAYI
     logical, intent(in) :: LNEW_MONTH
     real(r8),  intent(in) :: dt_met
 
@@ -380,20 +353,7 @@
     real(r8), parameter :: obsFocean=9.1_r8, obsFland=36.9_r8
     real(r8), parameter :: obsFall = obsFocean + obsFland
 
-    integer, parameter :: nc4deflate = 6
-    integer, parameter :: nc4shuffle = 1
 
-
-    !// NetCDF
-    character(len=8) :: datestamp
-    character(len=80) :: ncfile
-    integer :: &
-         lat_dim_id, lon_dim_id, nrmetd_dim_id, &
-         lat_id, lon_id, areaxy_id, &
-         flashL_id, flashO_id, &
-         status, ncid
-
-
     !// Scaling parameters depending on meteorological data.
     !//
     !// Price etal equations have units 1/minutes, while observations
@@ -529,11 +489,10 @@
 
     end if !// if ( LNEW_MONTH .and. NDAY.eq.NDAYI ) then
 
-    !// Locate layer with top edge about 1200m above surface, which is
+    !// Locate layer of approximately 1500m above surface, which is
     !// about layer 12 in native vertical L60. If collapsing this
     !// will be layer 9 (as in UCI standard code).
-    !// Moved into the loop below, calculated from ZOFLE.
-    !LFREE = 12 - (LPARW-LPAR)
+    LFREE = 12 - (LPARW-LPAR)
 
 
     !=================================================================
@@ -544,11 +503,11 @@
 !$omp          private (CTH,PBOT) &
 !$omp          private (fPR,finc,FACT1,FACT2,minT,maxT,MFLX,MENT) &
 !$omp          private (LNCWET,LNCENTU, ZL,TEMP) &
-!$omp          private (vertprof, LFREE) &
+!$omp          private (vertprof) &
 !$omp          shared (CWETE,CENTU,T,ZOFLE,PRECCNV) &
 !$omp          shared (P,ETAA,ETAB) &
 !$omp          shared (LITFAC,LITSRC,normFrate,NO_SUM) &
-!$omp          shared (LentuExist, JPS, JPN, PLAND) &
+!$omp          shared (LentuExist, LFREE, JPS, JPN, PLAND) &
 !$omp          shared (scaleLand, scaleOcean) &
 !$omp          shared (flashO, flashL) &
 !$omp          default(NONE)
@@ -556,29 +515,6 @@
     do J = 1,JPAR
        do I = 1,IPAR
 
-          !// Find layer bottom height above ground [km]
-          !// ------------------------------------------------------------
-          do L = 1, LWEPAR+1
-             ZL(L) = 1.e-3_r8 * (ZOFLE(L,I,J) - ZOFLE(1,I,J))
-          end do
-          !// Find first layer with reaching above 1200m (free troposphere),
-          !// to avoid problems considering mass fluxes. In the lowermost
-          !// model levels the mass flux can be very large, or it could
-          !// be shallow convection, which should be disregarded in
-          !// lightning considerations. We limit the convection considerations
-          !// to the region between ~1200m and up to mass flux top.
-          !// (Earlier we used LFREE=12, ~1200m on average in ECMWF L60 data)
-          LFREE = -1
-          do LFREE = 1, LWEPAR
-             if (ZL(LFREE+1) .gt. 1.2_r8) exit
-          end do
-          if (LFREE .lt. 0 .or. LFREE .ge. LWEPAR) then
-             write(*,'(a,es23.17)') f90file//':'//subr//': LFREE not found'
-             do L = 1, LWEPAR+1
-                print*,L,ZL(L)
-             end do
-             stop
-          end if
 
           !// Store updraft convection.
           !// I do not know the reason behind this parameterisation yet.
@@ -797,9 +733,9 @@
 
           !// Find layer bottom height above ground [km]
           !// ------------------------------------------------------------
-          !do L = 1, LWEPAR+1
-          !   ZL(L) = 1.e-3_r8 * (ZOFLE(L,I,J) - ZOFLE(1,I,J))
-          !end do
+          do L = 1, LWEPAR+1
+             ZL(L) = 1.e-3_r8 * (ZOFLE(L,I,J) - ZOFLE(1,I,J))
+          end do
 
           !// Now use Price et al. equations
           !// ------------------------------------------------------------
@@ -857,141 +793,10 @@
 
     !// Flash files
     if (getFlashFiles) then
-
-       write(datestamp(1:8),'(i4.4,2i2.2)') JYEAR,JMON,JDATE
-       ncfile = 'lightning_'//datestamp//'.nc'
-
-       ! Make file for NMET=1
-       if (NMET .eq. 1) then
-          !// Write netCDF4 file
-          write(6,'(a)') f90file//':'//subr//': creating file: '//trim(ncfile)
-          status=nf90_create(path=ncfile,cmode=nf90_netcdf4,ncid=ncid)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': in creating file')
-
-          !//File headers
-          status=nf90_put_att(ncid,nf90_global,'title', &
-               'Lightning flashes in Oslo CTM3')
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': file header')
-          !//---------------------------------------------------------------
-
-          !// Define spatial dimensions (lat, lon, lev)
-          status = nf90_def_dim(ncid,"lat",JPAR,lat_dim_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define lat dim')
-          status = nf90_def_dim(ncid,"lon",IPAR,lon_dim_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define lon dim')
-          status = nf90_def_dim(ncid,"nrmetd",NRMETD,nrmetd_dim_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define nrmetd dim')
-
-
-          !// Define the lon/lat/lev
-          status = nf90_def_var(ncid,"lon",nf90_double,lon_dim_id,lon_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define lon variable')
-          status = nf90_def_var(ncid,"lat",nf90_double,lat_dim_id,lat_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define lat variable')
-
-          !// Grid area (r8), deflate netcdf4
-          status = nf90_def_var(ncid,"gridarea", nf90_double, &
-               (/lon_dim_id, lat_dim_id/), areaxy_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define gridarea variable')
-          status = nf90_def_var_deflate(ncid,areaxy_id,nc4shuffle,1,nc4deflate)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define deflate gridarea variable')
-          status = nf90_put_att(ncid,areaxy_id,'unit','m2')
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': attribute unit gridarea')
-
-          !// Flashes
-          status = nf90_def_var(ncid,"flashL", nf90_float, &
-               (/lon_dim_id, lat_dim_id, nrmetd_dim_id/), flashL_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define flashL variable')
-          status = nf90_def_var_deflate(ncid,flashL_id,nc4shuffle,1,nc4deflate)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define deflate flashL variable')
-
-          status = nf90_def_var(ncid,"flashO", nf90_float, &
-               (/lon_dim_id, lat_dim_id, nrmetd_dim_id/), flashO_id)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define flashO variable')
-          status = nf90_def_var_deflate(ncid,flashO_id,nc4shuffle,1,nc4deflate)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': define deflate flashO variable')
-
-          !//---------------------------------------------------------------
-          !// End definition mode
-          status = nf90_enddef(ncid)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': end defmode')
-          !//---------------------------------------------------------------
-
-          !// Putting the lon/lat/lev variables
-          status = nf90_put_var(ncid,lon_id,XDGRD)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': putting lon')
-          status = nf90_put_var(ncid,lat_id,YDGRD)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': putting lat')
-
-          !// Grid area
-          status = nf90_put_var(ncid, areaxy_id, AREAXY)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': putting gridarea')
-
-          !// -------------------------------------------------------------
-          !// close netcdf file
-          status = nf90_close(ncid)
-          if (status .ne. nf90_noerr) call handle_error(status, &
-               f90file//':'//subr//': close file')
-          !// -------------------------------------------------------------
-
-       end if
-
-       !// Open the existing file
-       status = nf90_open(ncfile, nf90_write, ncid)
-       if (status .ne. nf90_noerr) call handle_error(status,'open existing file')
-     
-       !// Inquire dimension ids
-       status = nf90_inq_dimid(ncid,"lat",lat_dim_id)
-       if (status .ne. nf90_noerr) call handle_error(status,'getting lat')
-       status = nf90_inq_dimid(ncid,"lon",lon_dim_id)
-       if (status .ne. nf90_noerr) call handle_error(status,'getting lon')
-       status = nf90_inq_dimid(ncid,"nrmetd",nrmetd_dim_id)
-       if (status .ne. nf90_noerr) call handle_error(status,'getting lev')
-
-       status = nf90_inq_varid(ncid,'flashL',flashL_id)
-       if (status .ne. nf90_noerr) call handle_error(status,'inq flashL')
-       status = nf90_inq_varid(ncid,'flashO',flashO_id)
-       if (status .ne. nf90_noerr) call handle_error(status,'inq flashO')
-
-       !// Put flashL and flashO
-       status = nf90_put_var(ncid, flashL_id, flashL, &
-            start = (/1,1,NMET/), count = (/IPAR,JPAR,1/))
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': putting flashL')
-
-       status = nf90_put_var(ncid, flashO_id, flashO, &
-            start = (/1,1,NMET/), count = (/IPAR,JPAR,1/))
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': putting flashO')
-       !// -----------------------------------------------------------------
-       !// close netcdf file
-       status = nf90_close(ncid)
-       if (status .ne. nf90_noerr) call handle_error(status, &
-            f90file//':'//subr//': close file')
-       !// -----------------------------------------------------------------
-
-!       IFNR = get_free_fileid()
-!       open(IFNR,file='flashrate.dta',form='unformatted', position='append')
-!       write(IFNR) real(flashL, r4), real(flashO, r4)
-!       close(IFNR)
+       IFNR = get_free_fileid()
+       open(IFNR,file='flashrate.dta',form='unformatted', position='append')
+       write(IFNR) real(flashL, r4), real(flashO, r4)
+       close(IFNR)
     end if
 
     !// How many grid boxes experienced lightning?
Index: averages.f90
===================================================================
--- averages.f90	(.../ctm3f90)	(revision 243)
+++ averages.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -14,7 +14,7 @@
   !//
   !// Important
   !//   The main work on making averages is done in oc_diagnostics.f90.
-  !//   Here are some the basic routines for making simple averages,
+  !//   Here are some of the basic routines for making simple averages,
   !//   and also some print-to-screen routines.
   !//
   !// Contains
Index: README
===================================================================
--- README	(.../ctm3f90)	(revision 243)
+++ README	(.../branches/brOzoNorClim)	(revision 243)
@@ -7,5 +7,57 @@
 User manual
 The user manual is located in the file manual_osloctm3.pdf.
 
++++++++++++
+Quick start
++++Before compiling+++
+If you are running on abel, you should do
 
+> module purge
+
+to unload all automatically load modules and do
+
+> module load netcdf.intel/4.3.3.1
+
+This will load all necessery dependencies.
+
+Export the path of the working copy of <YOUR> OsloCTM3:
+
+> export CTM3_DIR=$HOME/<OsloCTM3>
+or
+> export CTM3_DIR=$HOME/<brOzoNorClim>
+
+and your work directory:
+
+> export WORK=/work/users/<YOUR_USER_NAME>
+
++++Compile+++
+> cd $CTM3_DIR
+> make -j
+
++++Before running+++
+Make sure you are member of the group cic-hpc
+and have the right to access
+
+> ls /work/projects/cicero/ctm_input/
+
+Export the path to forcing etc. input directory:
+
+> export INPUT_OCTM3=/work/projects/cicero/ctm_input/Indata_CTM3
+
+If you want to run the current branch make sure to get access to 
+
+> /projects/researchers/researchers01/sfalk/ctm_input/
+
++++To run+++
+There is a working example in branch/c3run: c3run_emeppar_example.job
+> cd $WORK
+> mkdir C3RUN_emep
+> cd C3RUN_emep
+
+Open c3run_emeppar_example.job in an editor and change the project number at the top <nn***>.
+> sbatch $CTM3_DIR/c3run_emeppar_example.job
+
+Wait for about 15-30 min.
+Look at the results.
+
 Have fun!
Index: initialize.f90
===================================================================
--- initialize.f90	(.../ctm3f90)	(revision 243)
+++ initialize.f90	(.../branches/brOzoNorClim)	(revision 243)
@@ -46,8 +46,10 @@
          JDAY_NEXT, JDATE_NEXT, JMON_NEXT, JYEAR_NEXT, &
          LMTSOM, CFLLIM, NBLX, NSCX, NDPX, NROPSM, NRCHEM, &
          LLPYR, LYEAR, LFIXMET, LCONT, START_AVG, XDEDG, YDEDG, &
-         ETAAW, ETABW, ETAA, ETAB, LMMAP, IMEPZ, &
-         SOLDEC, SOLDIS, IDTLN, modelTimeIntegrated
+         ETAAW, ETABW, ETAA, ETAB, LMMAP, IMEPZ, LNCR, LDUMP3HRS, &
+         SOLDEC, SOLDIS, IDTLN, modelTimeIntegrated, LSTOM1HRS, &
+         LDLYSCAV
+         !LDLYTOT, LDLY2D, Lbrd, Lls, Lc,n Ldry, Lsto 
     use cmn_diag, only: RUNTITLE, LFLXDG, JDO_C, JDO_T, JDO_A, JDO_X, &
          JDO_S, NTND, TLDIAG, &
          NTND_SOURCE, NTND_BNDLYR, NTND_DRYDEP, NTND_CHEM, &
@@ -62,15 +64,17 @@
          LBGT1, LBGT2, LBGTS, ISTA, JSTA, GM0_LT, &
          metTypeInfo, resolutionInfo
     use cmn_met, only: MPATH1, MPATH2, MFILE3, metTYPE, metCYCLE, metREVNR, &
-         MET_ROOT, MYEAR, PMEANW, HnativeRES, VRES, VRESW
+         MET_ROOT, MYEAR, PMEANW, HnativeRES, VRES, VRESW, PPFDPATH, PPFDFILE
     use cmn_sfc, only: LANDUSE_IDX, LANDUSE_YEAR, fileLandSurfTypeFrac, &
-         LAI_YEAR, fileLAI, ZOI_YEAR, fileZOI
+         LAI_YEAR, fileLAI, ZOI_YEAR, fileZOI, LDEPEMEP2012, EMEP_PAR, &
+         LGSMAP, fileGSMAP
     use cloudjx, only: CLDFLAG, NRANDO, RANSEED, &
          LCLDQMD, LCLDQMN, LCLDRANA, LCLDRANQ, LCLDAVG
     use grid, only: SET_GRID, SET_GRID_VERT, SET_MEAN_PSFC, &
          DIAG_LTSTN, SURF_IN, DIAGBLK, DIAG_LTGL, &
-         read_landSurfTypeFrac, read_LAI, read_ZOI, read_ZOI_LAI
-    use utilities, only: calendar, get_soldecdis
+         read_landSurfTypeFrac, read_LAI, read_ZOI, read_ZOI_LAI, &
+         read_growing_season
+    use utilities, only: calendar, get_soldecdis, get_free_fileid
     use cmn_oslo, only: LJCCYC
     use chem_oslo_rates, only: inSAD
     use input_oslo, only: clear_oslo_variables, read_tracer_list
@@ -83,14 +87,17 @@
     !// Locals
     character(len=80) :: INFILE1,INFILE2,INFILE3, TITLE
     real(r8) :: XLNG(2), YLAT(2), GM00Z
-    integer :: I,J,L,M,N, IMX,JMX,LMX, NOPSTL, K, I1,I2,J1,J2
+    integer :: I,J,L,M,N, IMX,JMX,LMX, NOPSTL, K, I1,I2,J1,J2,IFNR,IOS
     integer :: POLAVG(25)
     integer :: II, JMPOLR
     logical :: LISLSCP2, LCLDFLAG
-
+    character(len=160) :: fileEMEP, fileGS
     character(len=70) :: TITCLD(8)
     character(len=4) :: CCNR,CRNR,NRES
     !// --------------------------------------------------------------------
+    !// Temporare ascii array
+    character(len=8), dimension(29,16) :: temp
+    !// --------------------------------------------------------------------
     character(len=*), parameter :: subr = 'input'
     !//---------------------------------------------------------------------
 
@@ -151,8 +158,6 @@
        HnativeRES = 'T21'
     else if (IPARW .eq. 128) then
        HnativeRES = 'T42'
-    else if (IPARW .eq. 144) then
-       HnativeRES = 'NESM'
     else if (IPARW .eq. 196) then
        HnativeRES = 'T63'
     else if (IPARW .eq. 320) then
@@ -450,7 +455,6 @@
     read(5,'(I5)')  LAI_YEAR ! year to get (9999 for metdata, 0000 for climatology)
     read(5,*)  fileLAI       ! leaf area index
 
-
     !// Get surface data (vegetation map, etc.)
     !call SURF_IN(INFILE1,INFILE2,INFILE3,LANDUSE_IDX.eq.2)
 
@@ -461,44 +465,115 @@
 
     !call read_ZOI_LAI(INFILE2,INFILE3)
 
+    !// EMEP based dry deposition scheme and parameter list
+    read (5,*)
+    read(5,'(l5)') LDEPEMEP2012 ! Switch between new and old dry deposition scheme
+    if (LDEPEMEP2012) then
+       write(6,'(a)') f90file//':'//subr// ': DRYDEP: Using EMEP scheme.'
+    else
+       write(6,'(a)') f90file//':'//subr// ': DRYDEP: Using old scheme.'
+    end if
+    !// Read the location of the EMEP parameter list
+    read(5,*)  fileEMEP
+    !// Read the location of the PPFD files
+    read(5,*)
+    read(5,*)  PPFDPATH
+    read(5,*)  PPFDFILE
+    !// Initialize EMEP parameters
+    if (LDEPEMEP2012) then
+       IFNR = get_free_fileid()
+       open(IFNR,file=fileEMEP,Status='OLD',action='read',IOSTAT=IOS)
+       if (IOS .eq. 0) then
+          write(6,'(a)') '** Reading EMEP parameters from '//trim(fileEMEP)
+       else
+          write(6,'(a)') f90file//':'//subr//': File not found: '//trim(fileEMEP)
+          stop
+       end if
+       ! Read the table header
+       read(IFNR, *) 
+       ! Read the whole table as ascii (none floating point value in column one)
+       read(IFNR, *) temp
+       ! Split the temporary table and save the data
+       read(temp(2:,:),'(f10.0)') EMEP_PAR
+       write(6,*) temp
+       close(unit=ifnr)
+    end if
+    !// Growing season
+    read(5,*)
+    read(5,'(l5)') LGSMAP ! Switch between preprocessed GDAY/GLEN and fixed latitude based callculation
+    read(5,*) fileGSMAP   ! Growing season related maps
+    if (LGSMAP) then
+       write(6,'(a)') f90file//':'//subr// ': GROWING_SEASON: Using preprocessed data.'
+       write(6,'(a)') f90file//':'//subr// ': GROWING_SEASON WARNING: Only called during initialization. For runs exceeding one year a restart and change of file in *.inp is currently needed!'
+       call read_growing_season()
+    else
+       write(6,'(a)') f90file//':'//subr// ': GROWING_SEASON: Using fixed scheme.'
+    end if
+    
+
     !// CTM3: Tracer specific input - previously in Ltracer.inp
     read(5, '(a)') TITLE
       write(6,'(a)') TITLE
     read(5,'(l2,1x,I2)')  LCONT, START_AVG
-      write(6,'(a,l1)') 'Continuation run: ', LCONT
-      if (LCONT) then
-         write(6,'(a,l1)') '  Initializing tracers with restart file'
-      else
-         if (START_AVG .eq. 0) then
-            write(6,'(a)') '  Initializing tracers with zero'
-         else if (START_AVG .eq. 1) then
-            write(6,'(a)') '  Initializing tracerswith CTM3 month average'
-         else
-            write(6,'(a,i5)') '  Unknown START_AVG; ',START_AVG
-         end if
-      end if
+    write(6,'(a,l1)') 'Continuation run: ', LCONT
+    if (LCONT) then
+       write(6,'(a,l1)') '  Initializing tracers with restart file'
+    else
+       if (START_AVG .eq. 0) then
+          write(6,'(a)') '  Initializing tracers with zero'
+       else if (START_AVG .eq. 1) then
+          write(6,'(a)') '  Initializing tracerswith CTM3 month average'
+       else
+          write(6,'(a,i5)') '  Unknown START_AVG; ',START_AVG
+       end if
+    end if
 
+    ! Switch between old (.sav) and new (.nc) restart files
+    read(5,'(l5)') LNCR 
+
     read (5,*)
     read(5,*)  INFILE_T  ! tracer list
-      write(6,'(a)') 'tracer list: '//trim(INFILE_T)
+    write(6,'(a)') 'tracer list: '//trim(INFILE_T)
 
     !// Will read tracer list now
     call read_tracer_list(infile_T)
-      write(6,'(a)') '-- Resume reading input file'
+    write(6,'(a)') '-- Resume reading input file'
 
     read (5,*)
     read(5,*)  INFILE_WET  ! wet scav list
-      write(6,'(a)') 'wet scaveinging list: '//trim(INFILE_WET)
+    write(6,'(a)') 'wet scaveinging list: '//trim(INFILE_WET)
     read (5,*)
     read(5,*)  INFILE_DRY  ! dry scav list
-      write(6,'(a)') 'UCI dry scaveinging list: '//trim(INFILE_DRY)
+    write(6,'(a)') 'UCI dry scaveinging list: '//trim(INFILE_DRY)
     read (5,*)
     read(5,*)  INFILE_EMIS  ! tracer emission list
-      write(6,'(a)') 'tracer emission list: '//trim(INFILE_EMIS)
-
-
+    write(6,'(a)') 'tracer emission list: '//trim(INFILE_EMIS)
+    
+    read (5,*)
     !// DIAGNOSTICS
     !//---------------------------------------------------------------------
+    read (5,*)
+    read (5,*)
+    read (5,*)
+    !// Switch on 3 hourly output  
+    read(5,*) LDUMP3HRS
+    if (LDUMP3HRS(1)) then
+       write(6,*) f90file//':'//subr//': Diagnostic output: Dump3hrs (all/trp/sul/slt/min/nit/bio/moa/ffc/bfc)', LDUMP3HRS
+    end if
+    read (5,*)
+    ! Switch on 1 hourly output of GstO3 and FstO3
+    read(5,'(l5)') LSTOM1HRS 
+    if (LSTOM1HRS) then
+       write(6,'(a)') f90file//':'//subr//': Diagnostic output: Stom1hrs'
+    end if
+    read (5,*)
+    read (5,*)
+    !// Switch to scavenging daily output (tot/2d-brd/ls/cn/dry/sto)
+    read(5,*) LDLYSCAV
+    if (LDLYSCAV(1) .or. LDLYSCAV(2)) then
+       write(6,*) f90file//':'//subr//': Diagnostic output: DlyScav (tot/2d-brd/ls/cn/dry/sto) ', LDLYSCAV
+    end if
+
     !// CTM3 override; calculate when stratospheric chemistry is on
     !// and when E90-tracer is used (need LPAUZ)
     LFLXDG = LOSLOCSTRAT .and. LE90
@@ -801,7 +876,8 @@
          LSULPHUR, LBCOC, Le90
     use cmn_ctm, only: START_AVG, LCONT, IYEAR, LLPYR, LYEAR, LFIXMET, &
          JYEAR, JDAY, JMON, TMON, JDATE, TMET, SOLDEC, SOLDIS, &
-         JDAY_NEXT, JDATE_NEXT, JMON_NEXT, JYEAR_NEXT, STT, AIR
+         JDAY_NEXT, JDATE_NEXT, JMON_NEXT, JYEAR_NEXT, STT, AIR, &
+         LNCR
     use cmn_diag, only: RUNTITLE
     use cmn_met, only: MYEAR
     use utilities, only: calendar, get_soldecdis
@@ -830,24 +906,23 @@
     if (LCONT) then
 
        !// Reload a continuation/restart run
+       if (LNCR) then
+          FN_CON = 'restart.nc'
+          call load_restart_file(FN_CON, 0)
 
-       FN_CON = 'restart.nc'
-       call load_restart_file(FN_CON, 0)
+          !// You can add read-in of several files:
+          !// call load_restart_file('additional_file.nc', 1)
+       else
+          !// Old read-ins
+          FN_CON = 'restart.sav'
+          !// Start from the same resolution as current run:
+          !call OSLO_CON_RUN(FN_CON, 0)
+          !// Start from different hor.res. (sav-file version > 2):
+          !call OSLO_CON_RUNxx(FN_CON, 0)
+          !// Start from T42 horizontal resolution (sav-file version 1):
+          call OSLO_CON_RUN42(FN_CON, 0)
+       end if
 
-       !// You can add read-in of several files:
-       !// call load_restart_file('additional_file.nc', 1)
-
-
-       !// Old read-ins
-       !FN_CON = 'restart.sav'
-       !// Start from the same resolution as current run:
-       !call OSLO_CON_RUN(FN_CON, 0)
-       !// Start from different hor.res. (sav-file version > 2):
-       !call OSLO_CON_RUNxx(FN_CON, 0)
-       !// Start from T42 horizontal resolution (sav-file version 1):
-       !call OSLO_CON_RUN42(FN_CON, 0)
-
-
        !// Restart fields for BCsnow
        if (LBCOC) call bcsnow_init(NDAYI)
 
